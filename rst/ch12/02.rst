2 自动群发邮件
--------------

Python自动群发邮件

.. code:: python

    import smtplib
    from email import (header)
    from email.mime import (text, application, multipart)
    import time

    def sender_mail():
        smt_p = smtplib.SMTP()
        smt_p.connect(host='smtp.qq.com', port=25)
        sender, password = '113097485@qq.com', "**************"
        smt_p.login(sender, password)
        receiver_addresses, count_num = [
            'guozhennianhua@163.com', 'xiaoxiazi99@163.com'], 1
        for email_address in receiver_addresses:
            try:
                msg = multipart.MIMEMultipart()
                msg['From'] = "zhenguo"
                msg['To'] = email_address
                msg['subject'] = header.Header('这是邮件主题通知', 'utf-8')
                msg.attach(text.MIMEText(
                    '这是一封测试邮件，请勿回复本邮件~', 'plain', 'utf-8'))
                smt_p.sendmail(sender, email_address, msg.as_string())
                time.sleep(10)
                print('第%d次发送给%s' % (count_num, email_address))
                count_num = count_num + 1
            except Exception as e:
                print('第%d次给%s发送邮件异常' % (count_num, email_address))
                continue
        smt_p.quit()

    sender_mail()

| 注意：
| 发送邮箱是qq邮箱，所以要在qq邮箱中设置开启SMTP服务，设置完成时会生成一个授权码，将这个授权码赋值给文中的\ ``password``\ 变量。

发送后的截图：

.. figure:: ../../img/1578811858798.png
   :alt: 

