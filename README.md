<div align="center">
<img src="https://img.shields.io/badge/-Python-brightgreen">
<img src="https://img.shields.io/badge/-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-yellowgreen">
<img src="https://img.shields.io/badge/-%E7%AE%97%E6%B3%95-yellow">
<img src="https://img.shields.io/badge/-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-lightgrey">
<a href="https://static01.imgkr.com/temp/c6e10a16c4764dcdb32587760f6769ec.png" width="28%"><img src="https://img.shields.io/badge/%E5%85%AC%E4%BC%97%E5%8F%B7-Python%E5%B0%8F%E4%BE%8B%E5%AD%90-orange"></a>
</div>
<br>

<div align="center">
<img src="https://static01.imgkr.com/temp/9785963f175849d7bbc8a49ea02a54ea.png" width="20%" />
</div>

## ğŸ“š ä»‹ç»

å‘Šåˆ«æ¯ç‡¥ï¼Œå‘Šåˆ«æ¯ç‡¥ï¼Œè‡´åŠ›äºæ‰“é€  Python ç»å…¸å°ä¾‹å­ã€å°æ¡ˆä¾‹ã€‚ å½“å‰åº“å·²æœ‰ **300** å¤šä¸ªå®ç”¨çš„å°ä¾‹å­ã€å°æ¡ˆä¾‹ ã€‚



<div align="center">
<img src="https://static01.imgkr.com/temp/f379139a2c5d463799c35c1aa68911d7.png" width="23%"/>
</div>

<br>

<br>

å¦‚æœè½¬è½½æœ¬åº“å°ä¾‹å­ã€å°æ¡ˆä¾‹ï¼Œè¯·å¤‡æ³¨ä¸‹æ–¹é“¾æ¥ï¼š

Pythonå°ä¾‹å­ https://github.com/jackzhenguo/python-small-examples



## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®å°ä¾‹å­ï¼Œä¿®æ”¹å·²æœ‰ bugï¼Œå‚è€ƒ  [è´¡çŒ®æ–¹æ³•](./contributing.md) 



## âœ… License

å…è®¸æŒ‰ç…§è¦æ±‚è½¬è½½ï¼Œä½†ç¦æ­¢ç”¨äºä»»ä½•å•†ç”¨ç›®çš„ï¼



## ğŸ”¨ è¿­ä»£ç¬¬äºŒç‰ˆ

ç°åœ¨æ­£åœ¨æŒ‰ç…§å¦‚ä¸‹æ–½å·¥è®¡åˆ’ï¼Œè¿­ä»£æ­¤åº“ï¼Œæ¬¢è¿æŒç»­å…³æ³¨ã€‚

![image-20200624093723980](./img/image-20200624093723980.png)

ä¸»è¦ç« èŠ‚å’Œå°èŠ‚é‡æ–°æŒ‰ç…§å¦‚ä¸‹é€»è¾‘åˆ’åˆ†ï¼š

- ä¸€ã€PythonåŸºç¡€

- - 1 æ•°å­—
  - 2 å­—ç¬¦ä¸²
  - 3 åˆ—è¡¨
  - 4 æµç¨‹æ§åˆ¶
  - 5 ç¼–ç¨‹é£æ ¼
  - 6 å‡½æ•°
  - 7 è¾“å…¥å’Œè¾“å‡º
  - 8 æ•°æ®ç»“æ„
  - 9 æ¨¡å—
  - 10 é”™è¯¯å’Œå¼‚å¸¸
  - 11 ç±»å’Œå¯¹è±¡

![image-20200624093951499](./img/image-20200624093951499.png)

è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ¨é€`Python åŸºç¡€` ä¾‹å­ï¼Œæ•´ç†æˆä»¥ä¸Š`11`ä¸ªå°çš„æ¨¡å—ã€‚ç›®å‰è¿™ä¸ªç« èŠ‚ä¾‹å­å……è¶³ï¼Œç›¸ä¿¡åœ¨æ¥ä¸‹æ¥çš„ä¸€ä¸ªæœˆä¼šæ•´ç†å®Œæˆã€‚

- äºŒã€Pythonæ¨¡å—

- - 1 æ—¶é—´æ¨¡å—
  - 2 æ–‡ä»¶æ“ä½œ
  - 3 å¸¸è§è¿­ä»£å™¨
  - 4 yield ç”¨æ³•
  - 5 è£…é¥°å™¨ç”¨æ³•
  - 6 æšä¸¾ ç”¨æ³•
  - 7 åˆ—è¡¨ç”Ÿæˆå¼
  - 8 å­—å…¸ç”Ÿæˆå¼
  - 9 lambda è¡¨è¾¾å¼
  - 10 æ­£åˆ™ å¸¸ç”¨

![image-20200624094023575](./img/image-20200624094023575.png)

è¿™ä¸€ç« èŠ‚ä¸»è¦åŒ…æ‹¬å¦‚ä¸Š`10`ä¸ªå°èŠ‚ï¼Œä¸»è¦åŒ…æ‹¬`Python`å¸¸è§çš„å°æ¨¡å—ï¼Œå½“ç„¶è¿˜æœ‰`collections`ï¼Œ`itertools` ç­‰æ¨¡å—ä¼šæ‰“ä¹±åˆ°ä»¥ä¸Šæ¨¡å—ä¸­ï¼Œä¸å†å•ç‹¬æ‹¿å‡ºæ¥åˆ†æã€‚è¿˜æœ‰ä¸€äº›å’Œ httpï¼Œtcp ç­‰å…·ä½“çš„å‰åç«¯å®ç”¨æ¨¡å—ï¼Œæš‚ä¸”ä¸åŒ…æ‹¬åœ¨è¿™ä¸€ç« èŠ‚ä¸­ã€‚

- ä¸‰ã€Pythonç»˜å›¾

- - matplotlib å¸¸ç”¨
  - seaborn å¸¸ç”¨
  - plotly å¸¸ç”¨
  - pyecharts å¸¸ç”¨
  - turtle å¸¸ç”¨
  - ä¸‰ç»´ç»˜å›¾

![image-20200624094100474](./img/image-20200624094100474.png)

è¿™ä¸€ç« èŠ‚æ˜¯æœ€æœ‰æ„æ€çš„ï¼Œå‰æœŸæˆ‘ä»¬å·²ç»æ²‰æ·€ä¸‹å¤§é‡çš„ç»˜å›¾ç´ æï¼Œç°åœ¨æŒ‰ç…§ä»¥ä¸Šç»´åº¦æ•´ç†æ˜¯å†è‡ªç„¶ä¸è¿‡çš„ã€‚è¿™æ¬¡æ•´ç†æ³¨æ„å›Šæ‹¬å¸¸ç”¨çš„APIå’Œå±æ€§ï¼Œä¸æ˜¯åšæˆå¤§è€Œå…¨çš„é‚£ç§ã€‚

- å››ã€Python æ•°æ®åˆ†æ

![image-20200624094138680](./img/image-20200624094138680.png)

è¿™ä¸€ç« èŠ‚ä¹Ÿå¾ˆæœ‰æ„æ€ï¼Œä¸»è¦åŒ…æ‹¬Pandas æ•°æ®åˆ†æçš„å®ç”¨æŠ€å·§ï¼Œè™½ç„¶åªåˆ—å‡º8ä¸ªï¼Œä½†æ˜¯å®é™…ä¸Šåº”è¯¥æœ‰`40`å¤šä¸ªï¼Œåˆ°æ—¶å€™ä¸€å¹¶æ•´ç†åˆ°è¿™ä¸ªå°ä¾‹å­åº“é‡Œã€‚

- äº”ã€Python åŸºç¡€ç®—æ³•

- - æ•°ç»„
  - é“¾è¡¨
  - é€’å½’
  - æ’åºå’Œæœç´¢
  - åŠ¨æ€è§„åˆ’
  - å›¾
  - æ ‘
  - å­—ç¬¦ä¸²
  - å…¶ä»–

![image-20200624094502807](./img/image-20200624094502807.png)

ç®—æ³•å’Œæ•°æ®ç»“æ„çš„é‡è¦æ€§ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ã€‚æ ¸å¿ƒçš„å¸¸ç”¨çš„éƒ½ä¼šåŒ…æ‹¬åœ¨è¿™ä¸ªåº“é‡Œï¼Œå¹¶ä¸”ä¸æ˜¯èœ»èœ“ç‚¹æ°´çš„é£˜è¿‡ï¼Œè€Œæ˜¯ä¸€é’ˆè§è¡€çš„å‡»ä¸­è¦å®³ã€‚æ¯”å¦‚ä¸Šå‘¨å’Œæ˜Ÿå‹ä»¬ä¸€èµ·å†åˆ·é€’å½’éƒ¨åˆ†ï¼Œè¯´é“é€’å½’å¿…ç„¶ä¼šæåˆ° base caseï¼Œé€’å½’çŠ¶æ€æ–¹ç¨‹ï¼Œè®°å¿†åŒ–å­˜å‚¨ï¼Œå°¾é€’å½’ç­‰ã€‚

å¦‚æœé¢è¯•å®˜é—®ä½ é€’å½’çš„çŸ¥è¯†ï¼Œä½ å°±è¯´ä¸€å¥ï¼Œé€’å½’å°±æ˜¯è°ƒç”¨è‡ªå·±ï¼Œåˆ«çš„ç­”ä¸ä¸Šï¼Œé‚£ä¹ˆå‡åˆ†æ˜¯å¿…ç„¶çš„ã€‚æ›´æœ‰ç”šè€…ï¼Œé¢è¯•CVç®—æ³•å·¥ç¨‹å¸ˆï¼Œè¯´æ˜¯ç†Ÿç»ƒä½¿ç”¨TFå’ŒPYTORCHï¼Œé—®DPä¸€èˆ¬æ€ä¹ˆç”¨ï¼Œç«Ÿç„¶ä¸çŸ¥é“DPæ˜¯å•¥çš„ä¼°è®¡å¤šåŠè¦è¢«æŒ‚èµ°ã€‚

- å…­ã€æœºå™¨å­¦ä¹ 

- - æœºå™¨å­¦ä¹ æœ¬è´¨
  - boosting ç³»åˆ—
  - ç¥ç»ç½‘ç»œç³»åˆ—
  - å¼ºåŒ–å­¦ä¹ ç³»åˆ—
  - æ¨èç³»ç»Ÿ
  - CV è·¯çº¿
  - NLP ç³»åˆ—

è¿™ä¸€ç« èŠ‚è¦è®²å¥½æ˜¯æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå¦‚ä½•å…·ä½“åŒ–è¡¨è¾ƒå…¸å‹çš„å°ä¾‹å­æ˜¯è¦ä»”ç»†æ–Ÿé…Œçš„ã€‚å¦å¤–ï¼Œåªè®²æ ¸å¿ƒå’Œæœ€æœ¬è´¨çš„ä¸œè¥¿ï¼Œå®æˆ˜å°é¡¹ç›®ï¼Œä¼šæ˜¯è¿™ä¸ªç« èŠ‚çš„å‡ å¤§ç‰¹è‰²ã€‚

![image-20200624094538105](./img/image-20200624094538105.png)

ä»¥ä¸Šå°±æ˜¯ã€ŠPython-small-examplesã€‹github åº“çš„æ–½å·¥å’Œæ•´ç†è®¡åˆ’ï¼Œç´ æéƒ½æœ‰ä¸€å®šç§¯ç´¯ï¼Œéœ€è¦çš„æ˜¯ä¸æ–­æ‰“ç£¨ï¼Œè€å¿ƒæ•´ç†ï¼Œäº‰å–ä»Šå¹´å…¨éƒ¨æ–½å·¥å®Œæˆã€‚å¦‚æœä½ æœ‰å¥½çš„ä¾‹å­æ¬¢è¿ç›´æ¥æäº¤åˆ°æ­¤åº“ï¼š

https://github.com/jackzhenguo/python-small-examples



## ğŸ–¥ å®Œæˆç¬¬ä¸€ç‰ˆ

### ä¸€ã€PythonåŸºç¡€

`PythonåŸºç¡€`ä¸»è¦æ€»ç»“Pythonå¸¸ç”¨å†…ç½®å‡½æ•°ï¼›Pythonç‹¬æœ‰çš„è¯­æ³•ç‰¹æ€§ã€å…³é”®è¯`nonlocal`, ` global`ç­‰ï¼›å†…ç½®æ•°æ®ç»“æ„åŒ…æ‹¬ï¼šåˆ—è¡¨(list),  å­—å…¸(dict),  é›†åˆ(set),  å…ƒç»„(tuple) ä»¥åŠç›¸å…³çš„é«˜çº§æ¨¡å—`collections`ä¸­çš„`Counter`,  `namedtuple`, `defaultdict`ï¼Œ`heapq`æ¨¡å—ã€‚ç›®å‰å…±æœ‰`90`ä¸ªå°ä¾‹å­ã€‚

#### 1 æ±‚ç»å¯¹å€¼

ç»å¯¹å€¼æˆ–å¤æ•°çš„æ¨¡

```python
>>> abs(-6)
6
```

#### 2 å…ƒç´ éƒ½ä¸ºçœŸ

æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚æœå¯è¿­ä»£å¯¹è±¡çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸï¼Œé‚£ä¹ˆè¿”å› `True`ï¼Œå¦åˆ™è¿”å›`False`

æœ‰0ï¼Œæ‰€ä»¥ä¸æ˜¯æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸ
```python
>>> all([1,0,3,6])
False
```

æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸ
```python
>>> all([1,2,3])
True
```

#### 3 å…ƒç´ è‡³å°‘ä¸€ä¸ªä¸ºçœŸã€€

æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚æœå¯è¿­ä»£å¯¹è±¡é‡Œè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºçœŸï¼Œé‚£ä¹ˆè¿”å›`True`ï¼Œå¦åˆ™è¿”å›`False`

æ²¡æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºçœŸ
```python
>>> any([0,0,0,[]])
False
```
è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸ºçœŸï¼š
```python
>>> any([0,0,1])
True
```

#### 4 asciiå±•ç¤ºå¯¹è±¡ã€€ã€€

è°ƒç”¨å¯¹è±¡çš„ `__repr__` æ–¹æ³•ï¼Œè·å¾—è¯¥æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦‚ä¸‹ä¾‹å­è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²

```python
>>> class Student():
    def __init__(self,id,name):
        self.id = id
        self.name = name
    def __repr__(self):
        return 'id = '+self.id +', name = '+self.name
```
è°ƒç”¨ï¼š
```python
>>> xiaoming = Student(id='1',name='xiaoming')
>>> xiaoming
id = 1, name = xiaoming
>>> ascii(xiaoming)
'id = 1, name = xiaoming'
```

#### 5  åè½¬äºŒ

å°†åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼š

```python
>>> bin(10)
'0b1010'
```

#### 6 åè½¬å…«

åè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶ï¼š

```python
>>> oct(9)
'0o11'
```

#### 7 åè½¬åå…­

åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼š

```python
>>> hex(15)
'0xf'
```

#### 8 åˆ¤æ–­æ˜¯çœŸæ˜¯å‡ã€€ã€€

æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯True, è¿˜æ˜¯False.

```python
>>> bool([0,0,0])
True
>>> bool([])
False
>>> bool([1,0,1])
True
```

#### 9  å­—ç¬¦ä¸²è½¬å­—èŠ‚ã€€ã€€

å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ç±»å‹

```python
>>> s = "apple"
>>> bytes(s,encoding='utf-8')
b'apple'
```

#### 10 è½¬ä¸ºå­—ç¬¦ä¸²ã€€ã€€

æ•°å€¼å‹ç­‰è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹

```python
>>> i = 100
>>> str(i)
'100'
```

#### 11 æ˜¯å¦å¯è°ƒç”¨ã€€ã€€

åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯è¢«è°ƒç”¨

```python
In [1]: callable(str)
Out[1]: True

In [2]: callable(int)
Out[2]: True

In [3]: xiaoming
Out[3]: id = 001, name = xiaoming

In [4]: callable(xiaoming)
Out[4]: False
```
å¦‚æœæƒ³è®©`xiaoming`èƒ½è¢«è°ƒç”¨ xiaoming(), éœ€è¦é‡å†™`Student`ç±»çš„`__call__`æ–¹æ³•ï¼š

```python
In [1]: class Student():
    ...:     def __init__(self,id,name):
    ...:         self.id = id
    ...:         self.name = name
    ...:     def __repr__(self):
    ...:         return 'id = '+self.id +', name = '+self.name
    ...:     def __call__(self):
    ...:         print('I can be called')
    ...:         print(f'my name is {self.name}')
    ...: 
    ...: 

In [2]: t = Student('001','xiaoming')

In [3]: t()
I can be called
my name is xiaoming

```

#### 12 åè½¬ASCII

æŸ¥çœ‹åè¿›åˆ¶æ•´æ•°å¯¹åº”çš„`ASCIIå­—ç¬¦`

```python
In [1]: chr(65)
Out[1]: 'A'
```

#### 13 ASCIIè½¬å

æŸ¥çœ‹æŸä¸ª`ASCIIå­—ç¬¦`å¯¹åº”çš„åè¿›åˆ¶æ•°

```python
In [1]: ord('A')
Out[1]: 65
```

#### 14 ç±»æ–¹æ³•ã€€

`classmethod` è£…é¥°å™¨å¯¹åº”çš„å‡½æ•°ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œä¸éœ€è¦ `self `å‚æ•°ï¼Œä½†ç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦æ˜¯è¡¨ç¤ºè‡ªèº«ç±»çš„ cls å‚æ•°ï¼Œå¯ä»¥æ¥è°ƒç”¨ç±»çš„å±æ€§ï¼Œç±»çš„æ–¹æ³•ï¼Œå®ä¾‹åŒ–å¯¹è±¡ç­‰ã€‚

```python
In [1]: class Student():
    ...:     def __init__(self,id,name):
    ...:         self.id = id
    ...:         self.name = name
    ...:     def __repr__(self):
    ...:         return 'id = '+self.id +', name = '+self.name
    ...:     @classmethod
    ...:     def f(cls):
    ...:         print(cls)
```

#### 15 æ‰§è¡Œå­—ç¬¦ä¸²è¡¨ç¤ºçš„ä»£ç 

å°†å­—ç¬¦ä¸²ç¼–è¯‘æˆpythonèƒ½è¯†åˆ«æˆ–å¯æ‰§è¡Œçš„ä»£ç ï¼Œä¹Ÿå¯ä»¥å°†æ–‡å­—è¯»æˆå­—ç¬¦ä¸²å†ç¼–è¯‘ã€‚

```python
In [1]: s  = "print('helloworld')"
    
In [2]: r = compile(s,"<string>", "exec")
    
In [3]: r
Out[3]: <code object <module> at 0x0000000005DE75D0, file "<string>", line 1>
    
In [4]: exec(r)
helloworld
```

#### 16  åˆ›å»ºå¤æ•°

åˆ›å»ºä¸€ä¸ªå¤æ•°

```python
In [1]: complex(1,2)
Out[1]: (1+2j)
```

#### 17 åŠ¨æ€åˆ é™¤å±æ€§ã€€ã€€

åˆ é™¤å¯¹è±¡çš„å±æ€§

```python
In [1]: delattr(xiaoming,'id')

In [2]: hasattr(xiaoming,'id')
Out[2]: False
```

#### 18 è½¬ä¸ºå­—å…¸ã€€ã€€

åˆ›å»ºæ•°æ®å­—å…¸

```python
In [1]: dict()
Out[1]: {}

In [2]: dict(a='a',b='b')
Out[2]: {'a': 'a', 'b': 'b'}

In [3]: dict(zip(['a','b'],[1,2]))
Out[3]: {'a': 1, 'b': 2}

In [4]: dict([('a',1),('b',2)])
Out[4]: {'a': 1, 'b': 2}
```

#### 19 ä¸€é”®æŸ¥çœ‹å¯¹è±¡æ‰€æœ‰æ–¹æ³•ã€€

ä¸å¸¦å‚æ•°æ—¶è¿”å›`å½“å‰èŒƒå›´`å†…çš„å˜é‡ã€æ–¹æ³•å’Œå®šä¹‰çš„ç±»å‹åˆ—è¡¨ï¼›å¸¦å‚æ•°æ—¶è¿”å›`å‚æ•°`çš„å±æ€§ï¼Œæ–¹æ³•åˆ—è¡¨ã€‚

```python
In [96]: dir(xiaoming)
Out[96]:
['__class__',
 '__delattr__',
 '__dict__',
 '__dir__',
 '__doc__',
 '__eq__',
 '__format__',
 '__ge__',
 '__getattribute__',
 '__gt__',
 '__hash__',
 '__init__',
 '__init_subclass__',
 '__le__',
 '__lt__',
 '__module__',
 '__ne__',
 '__new__',
 '__reduce__',
 '__reduce_ex__',
 '__repr__',
 '__setattr__',
 '__sizeof__',
 '__str__',
 '__subclasshook__',
 '__weakref__',
 
 'name']
```

#### 20 å–å•†å’Œä½™æ•°ã€€ã€€

åˆ†åˆ«å–å•†å’Œä½™æ•°

```python
In [1]: divmod(10,3)
Out[1]: (3, 1)
```

#### 21 æšä¸¾å¯¹è±¡ã€€ã€€

è¿”å›ä¸€ä¸ªå¯ä»¥æšä¸¾çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„next()æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå…ƒç»„ã€‚

```python
In [1]: s = ["a","b","c"]
    ...: for i ,v in enumerate(s,1):
    ...:     print(i,v)
    ...:
1 a
2 b
3 c
```

#### 22 è®¡ç®—è¡¨è¾¾å¼

å°†å­—ç¬¦ä¸²str å½“æˆæœ‰æ•ˆçš„è¡¨è¾¾å¼æ¥æ±‚å€¼å¹¶è¿”å›è®¡ç®—ç»“æœå–å‡ºå­—ç¬¦ä¸²ä¸­å†…å®¹

```python
In [1]: s = "1 + 3 +5"
    ...: eval(s)
    ...:
Out[1]: 9
```

#### 23 æŸ¥çœ‹å˜é‡æ‰€å å­—èŠ‚æ•°

```python
In [1]: import sys

In [2]: a = {'a':1,'b':2.0}

In [3]: sys.getsizeof(a) # å ç”¨240ä¸ªå­—èŠ‚
Out[3]: 240
```

#### 24 è¿‡æ»¤å™¨ã€€ã€€

åœ¨å‡½æ•°ä¸­è®¾å®šè¿‡æ»¤æ¡ä»¶ï¼Œè¿­ä»£å…ƒç´ ï¼Œä¿ç•™è¿”å›å€¼ä¸º`True`çš„å…ƒç´ ï¼š

```python
In [1]: fil = filter(lambda x: x>10,[1,11,2,45,7,6,13])

In [2]: list(fil)
Out[2]: [11, 45, 13]
```

#### 25 è½¬ä¸ºæµ®ç‚¹ç±»å‹ã€€

å°†ä¸€ä¸ªæ•´æ•°æˆ–æ•°å€¼å‹å­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°

```python
In [1]: float(3)
Out[1]: 3.0
```
å¦‚æœä¸èƒ½è½¬åŒ–ä¸ºæµ®ç‚¹æ•°ï¼Œåˆ™ä¼šæŠ¥`ValueError`:
```python
In [2]: float('a')
# ValueError: could not convert string to float: 'a'
```

#### 26 å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€€

æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ï¼Œformat(value, format_spec)å®è´¨ä¸Šæ˜¯è°ƒç”¨äº†valueçš„__format__(format_spec)æ–¹æ³•ã€‚

```
In [104]: print("i am {0},age{1}".format("tom",18))
i am tom,age18
```

| 3.1415926  | {:.2f}  | 3.14      | ä¿ç•™å°æ•°ç‚¹åä¸¤ä½             |
| ---------- | ------- | --------- | ---------------------------- |
| 3.1415926  | {:+.2f} | +3.14     | å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½       |
| -1         | {:+.2f} | -1.00     | å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½       |
| 2.71828    | {:.0f}  | 3         | ä¸å¸¦å°æ•°                     |
| 5          | {:0>2d} | 05        | æ•°å­—è¡¥é›¶ (å¡«å……å·¦è¾¹, å®½åº¦ä¸º2) |
| 5          | {:x<4d} | 5xxx      | æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)  |
| 10         | {:x<4d} | 10xx      | æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)  |
| 1000000    | {:,}    | 1,000,000 | ä»¥é€—å·åˆ†éš”çš„æ•°å­—æ ¼å¼         |
| 0.25       | {:.2%}  | 25.00%    | ç™¾åˆ†æ¯”æ ¼å¼                   |
| 1000000000 | {:.2e}  | 1.00e+09  | æŒ‡æ•°è®°æ³•                     |
| 18         | {:>10d} | ' 18'     | å³å¯¹é½ (é»˜è®¤, å®½åº¦ä¸º10)      |
| 18         | {:<10d} | '18 '     | å·¦å¯¹é½ (å®½åº¦ä¸º10)            |
| 18         | {:^10d} | ' 18 '    | ä¸­é—´å¯¹é½ (å®½åº¦ä¸º10)          |

#### 27 å†»ç»“é›†åˆã€€ã€€

åˆ›å»ºä¸€ä¸ªä¸å¯ä¿®æ”¹çš„é›†åˆã€‚

```python
In [1]: frozenset([1,1,3,2,3])
Out[1]: frozenset({1, 2, 3})
```
å› ä¸ºä¸å¯ä¿®æ”¹ï¼Œæ‰€ä»¥æ²¡æœ‰åƒ`set`é‚£æ ·çš„`add`å’Œ`pop`æ–¹æ³•

#### 28 åŠ¨æ€è·å–å¯¹è±¡å±æ€§ã€€

è·å–å¯¹è±¡çš„å±æ€§

```python
In [1]: class Student():
   ...:     def __init__(self,id,name):
   ...:         self.id = id
   ...:         self.name = name
   ...:     def __repr__(self):
   ...:         return 'id = '+self.id +', name = '+self.name

In [2]: xiaoming = Student(id='001',name='xiaoming')
In [3]: getattr(xiaoming,'name') # è·å–xiaomingè¿™ä¸ªå®ä¾‹çš„nameå±æ€§å€¼
Out[3]: 'xiaoming'
```

#### 29 å¯¹è±¡æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§

```python
In [1]: class Student():
   ...:     def __init__(self,id,name):
   ...:         self.id = id
   ...:         self.name = name
   ...:     def __repr__(self):
   ...:         return 'id = '+self.id +', name = '+self.name

In [2]: xiaoming = Student(id='001',name='xiaoming')
In [3]: hasattr(xiaoming,'name')
Out[3]: True

In [4]: hasattr(xiaoming,'address')
Out[4]: False
```

#### 30 è¿”å›å¯¹è±¡çš„å“ˆå¸Œå€¼ã€€ã€€

è¿”å›å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è‡ªå®šä¹‰çš„å®ä¾‹éƒ½æ˜¯å¯å“ˆå¸Œçš„ï¼Œ`list`, `dict`, `set`ç­‰å¯å˜å¯¹è±¡éƒ½æ˜¯ä¸å¯å“ˆå¸Œçš„(unhashable)

  ```python
In [1]: hash(xiaoming)
Out[1]: 6139638

In [2]: hash([1,2,3])
# TypeError: unhashable type: 'list'
  ```

#### 31  ä¸€é”®å¸®åŠ©ã€€

è¿”å›å¯¹è±¡çš„å¸®åŠ©æ–‡æ¡£

```python
In [1]: help(xiaoming)
Help on Student in module __main__ object:

class Student(builtins.object)
 |  Methods defined here:
 |
 |  __init__(self, id, name)
 |
 |  __repr__(self)
 |
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
```

#### 32 å¯¹è±¡é—¨ç‰Œå·ã€€

è¿”å›å¯¹è±¡çš„å†…å­˜åœ°å€

```python
In [1]: id(xiaoming)
Out[1]: 98234208
```

#### 33 è·å–ç”¨æˆ·è¾“å…¥ã€€

è·å–ç”¨æˆ·è¾“å…¥å†…å®¹

```python
In [1]: input()
aa
Out[1]: 'aa'
```

#### 34  è½¬ä¸ºæ•´å‹ã€€ã€€

int(x, base =10) , xå¯èƒ½ä¸ºå­—ç¬¦ä¸²æˆ–æ•°å€¼ï¼Œå°†x è½¬æ¢ä¸ºä¸€ä¸ªæ™®é€šæ•´æ•°ã€‚å¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½åŒ…å«ç¬¦å·å’Œå°æ•°ç‚¹ã€‚å¦‚æœè¶…å‡ºäº†æ™®é€šæ•´æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼Œä¸€ä¸ªé•¿æ•´æ•°è¢«è¿”å›ã€‚  

```python
In [1]: int('12',16)
Out[1]: 18
```

#### 35 isinstance

åˆ¤æ–­*object*æ˜¯å¦ä¸ºç±»*classinfo*çš„å®ä¾‹ï¼Œæ˜¯è¿”å›true

```python
In [1]: class Student():
   ...:     def __init__(self,id,name):
   ...:         self.id = id
   ...:         self.name = name
   ...:     def __repr__(self):
   ...:         return 'id = '+self.id +', name = '+self.name

In [2]: xiaoming = Student(id='001',name='xiaoming')

In [3]: isinstance(xiaoming,Student)
Out[3]: True
```

#### 36 çˆ¶å­å…³ç³»é‰´å®š

```python
In [1]: class undergraduate(Student):
    ...:     def studyClass(self):
    ...:         pass
    ...:     def attendActivity(self):
    ...:         pass

In [2]: issubclass(undergraduate,Student)
Out[2]: True

In [3]: issubclass(object,Student)
Out[3]: False

In [4]: issubclass(Student,object)
Out[4]: True
```

å¦‚æœclassæ˜¯classinfoå…ƒç»„ä¸­æŸä¸ªå…ƒç´ çš„å­ç±»ï¼Œä¹Ÿä¼šè¿”å›True

```python
In [1]: issubclass(int,(int,float))
Out[1]: True
```

#### 37 åˆ›å»ºè¿­ä»£å™¨ç±»å‹

ä½¿ç”¨`iter(obj, sentinel)`, è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡, sentinelå¯çœç•¥(ä¸€æ—¦è¿­ä»£åˆ°æ­¤å…ƒç´ ï¼Œç«‹å³ç»ˆæ­¢)

```python
In [1]: lst = [1,3,5]

In [2]: for i in iter(lst):
    ...:     print(i)
    ...:
1
3
5
```

```python
In [1]: class TestIter(object):
    ...:     def __init__(self):
    ...:         self.l=[1,3,2,3,4,5]
    ...:         self.i=iter(self.l)
    ...:     def __call__(self):  #å®šä¹‰äº†__call__æ–¹æ³•çš„ç±»çš„å®ä¾‹æ˜¯å¯è°ƒç”¨çš„
    ...:         item = next(self.i)
    ...:         print ("__call__ is called,fowhich would return",item)
    ...:         return item
    ...:     def __iter__(self): #æ”¯æŒè¿­ä»£åè®®(å³å®šä¹‰æœ‰__iter__()å‡½æ•°)
    ...:         print ("__iter__ is called!!")
    ...:         return iter(self.l)
In [2]: t = TestIter()
In [3]: t() # å› ä¸ºå®ç°äº†__call__ï¼Œæ‰€ä»¥tå®ä¾‹èƒ½è¢«è°ƒç”¨
__call__ is called,which would return 1
Out[3]: 1

In [4]: for e in TestIter(): # å› ä¸ºå®ç°äº†__iter__æ–¹æ³•ï¼Œæ‰€ä»¥tèƒ½è¢«è¿­ä»£
    ...:     print(e)
    ...: 
__iter__ is called!!
1
3
2
3
4
5
```

#### 38 æ‰€æœ‰å¯¹è±¡ä¹‹æ ¹

object æ˜¯æ‰€æœ‰ç±»çš„åŸºç±»

```python
In [1]: o = object()

In [2]: type(o)
Out[2]: object
```

#### 39 æ‰“å¼€æ–‡ä»¶

è¿”å›æ–‡ä»¶å¯¹è±¡

```python
In [1]: fo = open('D:/a.txt',mode='r', encoding='utf-8')

In [2]: fo.read()
Out[2]: '\ufefflife is not so long,\nI use Python to play.'
```

modeå–å€¼è¡¨ï¼š

| å­—ç¬¦  | æ„ä¹‰                             |
| :---- | :------------------------------- |
| `'r'` | è¯»å–ï¼ˆé»˜è®¤ï¼‰                     |
| `'w'` | å†™å…¥ï¼Œå¹¶å…ˆæˆªæ–­æ–‡ä»¶               |
| `'x'` | æ’å®ƒæ€§åˆ›å»ºï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™å¤±è´¥ |
| `'a'` | å†™å…¥ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™åœ¨æœ«å°¾è¿½åŠ    |
| `'b'` | äºŒè¿›åˆ¶æ¨¡å¼                       |
| `'t'` | æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰                 |
| `'+'` | æ‰“å¼€ç”¨äºæ›´æ–°ï¼ˆè¯»å–ä¸å†™å…¥ï¼‰       |

#### 40 æ¬¡å¹‚

baseä¸ºåº•çš„expæ¬¡å¹‚ï¼Œå¦‚æœmodç»™å‡ºï¼Œå–ä½™

```python
In [1]: pow(3, 2, 4)
Out[1]: 1
```

#### 41 æ‰“å°

```python
In [5]: lst = [1,3,5]

In [6]: print(lst)
[1, 3, 5]

In [7]: print(f'lst: {lst}')
lst: [1, 3, 5]

In [8]: print('lst:{}'.format(lst))
lst:[1, 3, 5]

In [9]: print('lst:',lst)
lst: [1, 3, 5]
```



#### 42  åˆ›å»ºå±æ€§çš„ä¸¤ç§æ–¹å¼

è¿”å› property å±æ€§ï¼Œå…¸å‹çš„ç”¨æ³•ï¼š

```python
class C:
    def __init__(self):
        self._x = None

    def getx(self):
        return self._x

    def setx(self, value):
        self._x = value

    def delx(self):
        del self._x
    # ä½¿ç”¨propertyç±»åˆ›å»º property å±æ€§
    x = property(getx, setx, delx, "I'm the 'x' property.")
```

ä½¿ç”¨pythonè£…é¥°å™¨ï¼Œå®ç°ä¸ä¸Šå®Œå…¨ä¸€æ ·çš„æ•ˆæœä»£ç ï¼š

```python
class C:
    def __init__(self):
        self._x = None

    @property
    def x(self):
        return self._x

    @x.setter
    def x(self, value):
        self._x = value

    @x.deleter
    def x(self):
        del self._x
```

#### 43 åˆ›å»ºrangeåºåˆ—

1) range(stop)
2) range(start, stop[,step])

ç”Ÿæˆä¸€ä¸ªä¸å¯å˜åºåˆ—ï¼š

```python
In [1]: range(11)
Out[1]: range(0, 11)

In [2]: range(0,11,1)
Out[2]: range(0, 11)
```

#### 44 åå‘è¿­ä»£å™¨

```python
In [1]: rev = reversed([1,4,2,3,1])

In [2]: for i in rev:
     ...:     print(i)
     ...:
1
3
2
4
1
```

#### 45 å››èˆäº”å…¥

å››èˆäº”å…¥ï¼Œ`ndigits`ä»£è¡¨å°æ•°ç‚¹åä¿ç•™å‡ ä½ï¼š

```python
In [11]: round(10.0222222, 3)
Out[11]: 10.022

In [12]: round(10.05,1)
Out[12]: 10.1
```

#### 46 è½¬ä¸ºé›†åˆç±»å‹

è¿”å›ä¸€ä¸ªsetå¯¹è±¡ï¼Œé›†åˆå†…ä¸å…è®¸æœ‰é‡å¤å…ƒç´ ï¼š

```python
In [159]: a = [1,4,2,3,1]

In [160]: set(a)
Out[160]: {1, 2, 3, 4}
```

#### 47 è½¬ä¸ºåˆ‡ç‰‡å¯¹è±¡

*class* slice(*start*, *stop*[, *step*])

è¿”å›ä¸€ä¸ªè¡¨ç¤ºç”± range(start, stop, step) æ‰€æŒ‡å®šç´¢å¼•é›†çš„ sliceå¯¹è±¡ï¼Œå®ƒè®©ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å˜å¥½ã€‚

```python
In [1]: a = [1,4,2,3,1]

In [2]: my_slice_meaning = slice(0,5,2)

In [3]: a[my_slice_meaning]
Out[3]: [1, 2, 1]
```

#### 48 æ‹¿æ¥å°±ç”¨çš„æ’åºå‡½æ•°

æ’åºï¼š

```python
In [1]: a = [1,4,2,3,1]

In [2]: sorted(a,reverse=True)
Out[2]: [4, 3, 2, 1, 1]

In [3]: a = [{'name':'xiaoming','age':18,'gender':'male'},{'name':'
     ...: xiaohong','age':20,'gender':'female'}]
In [4]: sorted(a,key=lambda x: x['age'],reverse=False)
Out[4]:
[{'name': 'xiaoming', 'age': 18, 'gender': 'male'},
 {'name': 'xiaohong', 'age': 20, 'gender': 'female'}]
```

#### 49 æ±‚å’Œå‡½æ•°

æ±‚å’Œï¼š

```python
In [181]: a = [1,4,2,3,1]

In [182]: sum(a)
Out[182]: 11

In [185]: sum(a,10) #æ±‚å’Œçš„åˆå§‹å€¼ä¸º10
Out[185]: 21
```

#### 50 è½¬å…ƒç»„

 `tuple()` å°†å¯¹è±¡è½¬ä¸ºä¸€ä¸ªä¸å¯å˜çš„åºåˆ—ç±»å‹

 ```python
 In [16]: i_am_list = [1,3,5]
 In [17]: i_am_tuple = tuple(i_am_list)
 In [18]: i_am_tuple
 Out[18]: (1, 3, 5)
 ```

#### 51 æŸ¥çœ‹å¯¹è±¡ç±»å‹

*class* `type`(*name*, *bases*, *dict*)

ä¼ å…¥ä¸€ä¸ªå‚æ•°æ—¶ï¼Œè¿”å› *object* çš„ç±»å‹ï¼š

```python
In [1]: class Student():
   ...:     def __init__(self,id,name):
   ...:         self.id = id
   ...:         self.name = name
   ...:     def __repr__(self):
   ...:         return 'id = '+self.id +', name = '+self.name
   ...: 
   ...: 

In [2]: xiaoming = Student(id='001',name='xiaoming')
In [3]: type(xiaoming)
Out[3]: __main__.Student

In [4]: type(tuple())
Out[4]: tuple
```

#### 52 èšåˆè¿­ä»£å™¨

åˆ›å»ºä¸€ä¸ªèšåˆäº†æ¥è‡ªæ¯ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼š

```python
In [1]: x = [3,2,1]
In [2]: y = [4,5,6]
In [3]: list(zip(y,x))
Out[3]: [(4, 3), (5, 2), (6, 1)]

In [4]: a = range(5)
In [5]: b = list('abcde')
In [6]: b
Out[6]: ['a', 'b', 'c', 'd', 'e']
In [7]: [str(y) + str(x) for x,y in zip(a,b)]
Out[7]: ['a0', 'b1', 'c2', 'd3', 'e4']
```

#### 53 nonlocalç”¨äºå†…åµŒå‡½æ•°ä¸­

å…³é”®è¯`nonlocal`å¸¸ç”¨äºå‡½æ•°åµŒå¥—ä¸­ï¼Œå£°æ˜å˜é‡`i`ä¸ºéå±€éƒ¨å˜é‡ï¼›
å¦‚æœä¸å£°æ˜ï¼Œ`i+=1`è¡¨æ˜`i`ä¸ºå‡½æ•°`wrapper`å†…çš„å±€éƒ¨å˜é‡ï¼Œå› ä¸ºåœ¨`i+=1`å¼•ç”¨(reference)æ—¶,iæœªè¢«å£°æ˜ï¼Œæ‰€ä»¥ä¼šæŠ¥`unreferenced variable`çš„é”™è¯¯ã€‚
```python
def excepter(f):
    i = 0
    t1 = time.time()
    def wrapper(): 
        try:
            f()
        except Exception as e:
            nonlocal i
            i += 1
            print(f'{e.args[0]}: {i}')
            t2 = time.time()
            if i == n:
                print(f'spending time:{round(t2-t1,2)}')
    return wrapper
```

#### 54 global å£°æ˜å…¨å±€å˜é‡
å…ˆå›ç­”ä¸ºä»€ä¹ˆè¦æœ‰`global`ï¼Œä¸€ä¸ªå˜é‡è¢«å¤šä¸ªå‡½æ•°å¼•ç”¨ï¼Œæƒ³è®©å…¨å±€å˜é‡è¢«æ‰€æœ‰å‡½æ•°å…±äº«ã€‚æœ‰çš„ä¼™ä¼´å¯èƒ½ä¼šæƒ³è¿™è¿˜ä¸ç®€å•ï¼Œè¿™æ ·å†™ï¼š
```python
i = 5
def f():
    print(i)

def g():
    print(i)
    pass

f()
g()

```
få’Œgä¸¤ä¸ªå‡½æ•°éƒ½èƒ½å…±äº«å˜é‡`i`ï¼Œç¨‹åºæ²¡æœ‰æŠ¥é”™ï¼Œæ‰€ä»¥ä»–ä»¬ä¾ç„¶ä¸æ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨`global`.

ä½†æ˜¯ï¼Œå¦‚æœæˆ‘æƒ³è¦æœ‰ä¸ªå‡½æ•°å¯¹`i`é€’å¢ï¼Œè¿™æ ·ï¼š
```python
def h():
    i += 1

h()
```
æ­¤æ—¶æ‰§è¡Œç¨‹åºï¼Œbang, å‡ºé”™äº†ï¼ æŠ›å‡ºå¼‚å¸¸ï¼š`UnboundLocalError`ï¼ŒåŸæ¥ç¼–è¯‘å™¨åœ¨è§£é‡Š`i+=1`æ—¶ä¼šæŠŠ`i`è§£æä¸ºå‡½æ•°`h()`å†…çš„å±€éƒ¨å˜é‡ï¼Œå¾ˆæ˜¾ç„¶åœ¨æ­¤å‡½æ•°å†…ï¼Œç¼–è¯‘å™¨æ‰¾ä¸åˆ°å¯¹å˜é‡`i`çš„å®šä¹‰ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚

`global`å°±æ˜¯ä¸ºè§£å†³æ­¤é—®é¢˜è€Œè¢«æå‡ºï¼Œåœ¨å‡½æ•°hå†…ï¼Œæ˜¾ç¤ºåœ°å‘Šè¯‰ç¼–è¯‘å™¨`i`ä¸ºå…¨å±€å˜é‡ï¼Œç„¶åç¼–è¯‘å™¨ä¼šåœ¨å‡½æ•°å¤–é¢å¯»æ‰¾`i`çš„å®šä¹‰ï¼Œæ‰§è¡Œå®Œ`i+=1`åï¼Œ`i`è¿˜ä¸ºå…¨å±€å˜é‡ï¼Œå€¼åŠ 1ï¼š
```python
i = 0
def h():
    global i
    i += 1

h()
print(i)
```

#### 55 é“¾å¼æ¯”è¾ƒ

```python
i = 3
print(1 < i < 3)  # False
print(1 < i <= 3)  # True
```


#### 56 ä¸ç”¨elseå’Œifå®ç°è®¡ç®—å™¨

```python
from operator import *


def calculator(a, b, k):
    return {
        '+': add,
        '-': sub,
        '*': mul,
        '/': truediv,
        '**': pow
    }[k](a, b)


calculator(1, 2, '+')  # 3
calculator(3, 4, '**')  # 81
```

#### 57 é“¾å¼æ“ä½œ

```python
from operator import (add, sub)


def add_or_sub(a, b, oper):
    return (add if oper == '+' else sub)(a, b)


add_or_sub(1, 2, '-')  # -1
```

#### 58 äº¤æ¢ä¸¤å…ƒç´ 

```python
def swap(a, b):
    return b, a


print(swap(1, 0))  # (0,1)
```

#### 59 å»æœ€æ±‚å¹³å‡

```python
def score_mean(lst):
    lst.sort()
    lst2=lst[1:(len(lst)-1)]
    return round((sum(lst2)/len(lst2)),1)

lst=[9.1, 9.0,8.1, 9.7, 19,8.2, 8.6,9.8]
score_mean(lst) # 9.1
```

#### 60 æ‰“å°99ä¹˜æ³•è¡¨

æ‰“å°å‡ºå¦‚ä¸‹æ ¼å¼çš„ä¹˜æ³•è¡¨

```python
1*1=1
1*2=2   2*2=4
1*3=3   2*3=6   3*3=9
1*4=4   2*4=8   3*4=12  4*4=16
1*5=5   2*5=10  3*5=15  4*5=20  5*5=25
1*6=6   2*6=12  3*6=18  4*6=24  5*6=30  6*6=36
1*7=7   2*7=14  3*7=21  4*7=28  5*7=35  6*7=42  7*7=49
1*8=8   2*8=16  3*8=24  4*8=32  5*8=40  6*8=48  7*8=56  8*8=64
1*9=9   2*9=18  3*9=27  4*9=36  5*9=45  6*9=54  7*9=63  8*9=72  9*9=81
```

ä¸€å…±æœ‰10 è¡Œï¼Œç¬¬`i`è¡Œçš„ç¬¬`j`åˆ—ç­‰äºï¼š`j*i`ï¼Œ

å…¶ä¸­,

 `i`å–å€¼èŒƒå›´ï¼š`1<=i<=9`

 `j`å–å€¼èŒƒå›´ï¼š`1<=j<=i`

æ ¹æ®`ä¾‹å­åˆ†æ`çš„è¯­è¨€æè¿°ï¼Œè½¬åŒ–ä¸ºå¦‚ä¸‹ä»£ç ï¼š

```python
for i in range(1, 10):
    for j in range(1, i+1):
        print('%d * %d = %d' % (j, i, j * i) , end="\t")
    print()
```

#### 61 å…¨å±•å¼€

å¯¹äºå¦‚ä¸‹æ•°ç»„ï¼š

```
[[[1,2,3],[4,5]]]
```

å¦‚ä½•å®Œå…¨å±•å¼€æˆä¸€ç»´çš„ã€‚è¿™ä¸ªå°ä¾‹å­å®ç°çš„`flatten`æ˜¯é€’å½’ç‰ˆï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«è¡¨ç¤ºå¸¦å±•å¼€çš„æ•°ç»„ï¼Œè¾“å‡ºæ•°ç»„ã€‚

```python
from collections.abc import *

def flatten(lst, out_lst=None):
    if out_lst is None:
        out_lst = []
    for i in lst:
        if isinstance(i, Iterable): # åˆ¤æ–­iæ˜¯å¦å¯è¿­ä»£
            flatten(i, out_lst)  # å°¾æ•°é€’å½’
        else:
            out_lst.append(i)    # äº§ç”Ÿç»“æœ
    return out_lst
```

è°ƒç”¨`flatten`:

```python
print(flatten([[1,2,3],[4,5]]))
print(flatten([[1,2,3],[4,5]], [6,7]))
print(flatten([[[1,2,3],[4,5,6]]]))
# ç»“æœï¼š
[1, 2, 3, 4, 5]
[6, 7, 1, 2, 3, 4, 5]
[1, 2, 3, 4, 5, 6]
```

numpyé‡Œçš„`flatten`ä¸ä¸Šé¢çš„å‡½æ•°å®ç°æœ‰äº›å¾®å¦™çš„ä¸åŒï¼š

```python
import numpy
b = numpy.array([[1,2,3],[4,5]])
b.flatten()
array([list([1, 2, 3]), list([4, 5])], dtype=object)
```

#### 62 åˆ—è¡¨ç­‰åˆ†

```python
from math import ceil

def divide(lst, size):
    if size <= 0:
        return [lst]
    return [lst[i * size:(i+1)*size] for i in range(0, ceil(len(lst) / size))]


r = divide([1, 3, 5, 7, 9], 2)
print(r)  # [[1, 3], [5, 7], [9]]

r = divide([1, 3, 5, 7, 9], 0)
print(r)  # [[1, 3, 5, 7, 9]]

r = divide([1, 3, 5, 7, 9], -3)
print(r)  # [[1, 3, 5, 7, 9]]

```

#### 63 åˆ—è¡¨å‹ç¼©

```python
def filter_false(lst):
    return list(filter(bool, lst))


r = filter_false([None, 0, False, '', [], 'ok', [1, 2]])
print(r)  # ['ok', [1, 2]]

```

#### 64 æ›´é•¿åˆ—è¡¨

```python
def max_length(*lst):
    return max(*lst, key=lambda v: len(v))


r = max_length([1, 2, 3], [4, 5, 6, 7], [8])
print(f'æ›´é•¿çš„åˆ—è¡¨æ˜¯{r}')  # [4, 5, 6, 7]

r = max_length([1, 2, 3], [4, 5, 6, 7], [8, 9])
print(f'æ›´é•¿çš„åˆ—è¡¨æ˜¯{r}')  # [4, 5, 6, 7]
```

#### 65 æ±‚ä¼—æ•°

```python
def top1(lst):
    return max(lst, default='åˆ—è¡¨ä¸ºç©º', key=lambda v: lst.count(v))

lst = [1, 3, 3, 2, 1, 1, 2]
r = top1(lst)
print(f'{lst}ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ ä¸º:{r}')  # [1, 3, 3, 2, 1, 1, 2]ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ ä¸º:1
```

#### 66 å¤šè¡¨ä¹‹æœ€
```python 
def max_lists(*lst):
    return max(max(*lst, key=lambda v: max(v)))


r = max_lists([1, 2, 3], [6, 7, 8], [4, 5])
print(r)  # 8
```

#### 67 åˆ—è¡¨æŸ¥é‡

```python
def has_duplicates(lst):
    return len(lst) == len(set(lst))


x = [1, 1, 2, 2, 3, 2, 3, 4, 5, 6]
y = [1, 2, 3, 4, 5]
has_duplicates(x)  # False
has_duplicates(y)  # True
```




#### 68 åˆ—è¡¨åè½¬

```python
def reverse(lst):
    return lst[::-1]


r = reverse([1, -2, 3, 4, 1, 2])
print(r)  # [2, 1, 4, 3, -2, 1]
```

#### 69 æµ®ç‚¹æ•°ç­‰å·®æ•°åˆ—

```python
def rang(start, stop, n):
    start,stop,n = float('%.2f' % start), float('%.2f' % stop),int('%.d' % n)
    step = (stop-start)/n
    lst = [start]
    while n > 0:
        start,n = start+step,n-1
        lst.append(round((start), 2))
    return lst

rang(1, 8, 10) # [1.0, 1.7, 2.4, 3.1, 3.8, 4.5, 5.2, 5.9, 6.6, 7.3, 8.0]
```

#### 70 æŒ‰æ¡ä»¶åˆ†ç»„

```python
def bif_by(lst, f):
    return [ [x for x in lst if f(x)],[x for x in lst if not f(x)]]

records = [25,89,31,34] 
bif_by(records, lambda x: x<80) # [[25, 31, 34], [89]]
```


#### 71 mapå®ç°å‘é‡è¿ç®—

```python
#å¤šåºåˆ—è¿ç®—å‡½æ•°â€”map(function,iterabel,iterable2)
lst1=[1,2,3,4,5,6]
lst2=[3,4,5,6,3,2]
list(map(lambda x,y:x*y+1,lst1,lst2))
### [4, 9, 16, 25, 16, 13]
```

#### 72 å€¼æœ€å¤§çš„å­—å…¸

```python
def max_pairs(dic):
    if len(dic) == 0:
        return dic
    max_val = max(map(lambda v: v[1], dic.items()))
    return [item for item in dic.items() if item[1] == max_val]


r = max_pairs({'a': -10, 'b': 5, 'c': 3, 'd': 5})
print(r)  # [('b', 5), ('d', 5)]
```

#### 73 åˆå¹¶ä¸¤ä¸ªå­—å…¸

```python
def merge_dict(dic1, dic2):
    return {**dic1, **dic2}  # python3.5åæ”¯æŒçš„ä¸€è¡Œä»£ç å®ç°åˆå¹¶å­—å…¸

merge_dict({'a': 1, 'b': 2}, {'c': 3})  # {'a': 1, 'b': 2, 'c': 3}
```

#### 74 topnå­—å…¸

```python
from heapq import nlargest

# è¿”å›å­—å…¸då‰nä¸ªæœ€å¤§å€¼å¯¹åº”çš„é”®

def topn_dict(d, n):
    return nlargest(n, d, key=lambda k: d[k])

topn_dict({'a': 10, 'b': 8, 'c': 9, 'd': 10}, 3)  # ['a', 'd', 'c']
```


#### 75 å¼‚ä½è¯

```python
from collections import Counter

# æ£€æŸ¥ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ ç›¸åŒå­—æ¯å¼‚åºè¯ï¼Œç®€ç§°ï¼šäº’ä¸ºå˜ä½è¯

def anagram(str1, str2):
    return Counter(str1) == Counter(str2)

anagram('eleven+two', 'twelve+one')  # True è¿™æ˜¯ä¸€å¯¹ç¥å™¨çš„å˜ä½è¯
anagram('eleven', 'twelve')  # False
```


#### 76 é€»è¾‘ä¸Šåˆå¹¶å­—å…¸
(1) ä¸¤ç§åˆå¹¶å­—å…¸æ–¹æ³•
è¿™æ˜¯ä¸€èˆ¬çš„å­—å…¸åˆå¹¶å†™æ³•

```python
dic1 = {'x': 1, 'y': 2 }
dic2 = {'y': 3, 'z': 4 }
merged1 = {**dic1, **dic2} # {'x': 1, 'y': 3, 'z': 4}
```

ä¿®æ”¹merged['x']=10ï¼Œdic1ä¸­çš„xå€¼`ä¸å˜`ï¼Œ`merged`æ˜¯é‡æ–°ç”Ÿæˆçš„ä¸€ä¸ª`æ–°å­—å…¸`ã€‚

ä½†æ˜¯ï¼Œ`ChainMap`å´ä¸åŒï¼Œå®ƒåœ¨å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ªå®¹çº³è¿™äº›å­—å…¸çš„åˆ—è¡¨ã€‚å› æ­¤ä½¿ç”¨ChainMapåˆå¹¶å­—å…¸ï¼Œä¿®æ”¹merged['x']=10åï¼Œdic1ä¸­çš„xå€¼`æ”¹å˜`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
from collections import ChainMap
merged2 = ChainMap(dic1,dic2)
print(merged2) # ChainMap({'x': 1, 'y': 2}, {'y': 3, 'z': 4})
```

#### 77 å‘½åå…ƒç»„æé«˜å¯è¯»æ€§

```python
from collections import namedtuple
Point = namedtuple('Point', ['x', 'y', 'z'])  # å®šä¹‰åå­—ä¸ºPointçš„å…ƒç¥–ï¼Œå­—æ®µå±æ€§æœ‰x,y,z
lst = [Point(1.5, 2, 3.0), Point(-0.3, -1.0, 2.1), Point(1.3, 2.8, -2.5)]
print(lst[0].y - lst[1].y)
```

ä½¿ç”¨å‘½åå…ƒç»„å†™å‡ºæ¥çš„ä»£ç å¯è¯»æ€§æ›´å¥½ï¼Œå°¤å…¶å¤„ç†ä¸Šç™¾ä¸Šåƒä¸ªå±æ€§æ—¶ä½œç”¨æ›´åŠ å‡¸æ˜¾ã€‚

#### 78 æ ·æœ¬æŠ½æ ·

ä½¿ç”¨`sample`æŠ½æ ·ï¼Œå¦‚ä¸‹ä¾‹å­ä»100ä¸ªæ ·æœ¬ä¸­éšæœºæŠ½æ ·10ä¸ªã€‚

```python
from random import randint,sample
lst = [randint(0,50) for _ in range(100)]
print(lst[:5])# [38, 19, 11, 3, 6]
lst_sample = sample(lst,10)
print(lst_sample) # [33, 40, 35, 49, 24, 15, 48, 29, 37, 24]
```

#### 79 é‡æ´—æ•°æ®é›†

ä½¿ç”¨`shuffle`ç”¨æ¥é‡æ´—æ•°æ®é›†ï¼Œ**å€¼å¾—æ³¨æ„`shuffle`æ˜¯å¯¹lstå°±åœ°(in place)æ´—ç‰Œï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´**

```python
from random import shuffle
lst = [randint(0,50) for _ in range(100)]
shuffle(lst)
print(lst[:5]) # [50, 3, 48, 1, 26]
```

#### 80 10ä¸ªå‡åŒ€åˆ†å¸ƒçš„åæ ‡ç‚¹

randomæ¨¡å—ä¸­çš„`uniform(a,b)`ç”Ÿæˆ[a,b)å†…çš„ä¸€ä¸ªéšæœºæ•°ï¼Œå¦‚ä¸‹ç”Ÿæˆ10ä¸ªå‡åŒ€åˆ†å¸ƒçš„äºŒç»´åæ ‡ç‚¹

```python
from random import uniform
In [1]: [(uniform(0,10),uniform(0,10)) for _ in range(10)]
Out[1]: 
[(9.244361194237328, 7.684326645514235),
 (8.129267671737324, 9.988395854203773),
 (9.505278771040661, 2.8650440524834107),
 (3.84320100484284, 1.7687190176304601),
 (6.095385729409376, 2.377133802224657),
 (8.522913365698605, 3.2395995841267844),
 (8.827829601859406, 3.9298809217233766),
 (1.4749644859469302, 8.038753079253127),
 (9.005430657826324, 7.58011186920019),
 (8.700789540392917, 1.2217577293254112)]
```

#### 81 10ä¸ªé«˜æ–¯åˆ†å¸ƒçš„åæ ‡ç‚¹

randomæ¨¡å—ä¸­çš„`gauss(u,sigma)`ç”Ÿæˆå‡å€¼ä¸ºu, æ ‡å‡†å·®ä¸ºsigmaçš„æ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„å€¼ï¼Œå¦‚ä¸‹ç”Ÿæˆ10ä¸ªäºŒç»´åæ ‡ç‚¹ï¼Œæ ·æœ¬è¯¯å·®(y-2*x-1)æ»¡è¶³å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„é«˜æ–¯åˆ†å¸ƒï¼š

```python
from random import gauss
x = range(10)
y = [2*xi+1+gauss(0,1) for xi in x]
points = list(zip(x,y))
### 10ä¸ªäºŒç»´ç‚¹ï¼š
[(0, -0.86789025305992),
 (1, 4.738439437453464),
 (2, 5.190278040856102),
 (3, 8.05270893133576),
 (4, 9.979481700775292),
 (5, 11.960781766216384),
 (6, 13.025427054303737),
 (7, 14.02384035204836),
 (8, 15.33755823101161),
 (9, 17.565074449028497)]
```

#### 82 chainé«˜æ•ˆä¸²è”å¤šä¸ªå®¹å™¨å¯¹è±¡

`chain`å‡½æ•°ä¸²è”aå’Œbï¼Œå…¼é¡¾å†…å­˜æ•ˆç‡åŒæ—¶å†™æ³•æ›´åŠ ä¼˜é›…ã€‚

```python
from itertools import chain
a = [1,3,5,0]
b = (2,4,6)

for i in chain(a,b):
  print(i)
### ç»“æœ
1
3
5
0
2
4
6
```

#### 83 æ“ä½œå‡½æ•°å¯¹è±¡

```python
In [31]: def f():
    ...:     print('i\'m f')
    ...:

In [32]: def g():
    ...:     print('i\'m g')
    ...:

In [33]: [f,g][1]()
i'm g
```

åˆ›å»ºå‡½æ•°å¯¹è±¡çš„listï¼Œæ ¹æ®æƒ³è¦è°ƒç”¨çš„indexï¼Œæ–¹ä¾¿ç»Ÿä¸€è°ƒç”¨ã€‚

#### 84 ç”Ÿæˆé€†åºåºåˆ—

```python
list(range(10,-1,-1)) # [10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
```

ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºè´Ÿæ—¶ï¼Œè¡¨ç¤ºä»ç¬¬ä¸€ä¸ªå‚æ•°å¼€å§‹é€’å‡ï¼Œç»ˆæ­¢åˆ°ç¬¬äºŒä¸ªå‚æ•°(ä¸åŒ…æ‹¬æ­¤è¾¹ç•Œ)

#### 85 å‡½æ•°çš„äº”ç±»å‚æ•°ä½¿ç”¨ä¾‹å­

pythonäº”ç±»å‚æ•°ï¼šä½ç½®å‚æ•°ï¼Œå…³é”®å­—å‚æ•°ï¼Œé»˜è®¤å‚æ•°ï¼Œå¯å˜ä½ç½®æˆ–å…³é”®å­—å‚æ•°çš„ä½¿ç”¨ã€‚

```python
def f(a,*b,c=10,**d):
  print(f'a:{a},b:{b},c:{c},d:{d}')
```
*é»˜è®¤å‚æ•°`c`ä¸èƒ½ä½äºå¯å˜å…³é”®å­—å‚æ•°`d`å.*

è°ƒç”¨f:
```python
In [10]: f(1,2,5,width=10,height=20)
a:1,b:(2, 5),c:10,d:{'width': 10, 'height': 20}
```
å¯å˜ä½ç½®å‚æ•°`b`å®å‚åè¢«è§£æä¸ºå…ƒç»„`(2,5)`;è€Œcå–å¾—é»˜è®¤å€¼10; dè¢«è§£æä¸ºå­—å…¸.

å†æ¬¡è°ƒç”¨f:
```python
In [11]: f(a=1,c=12)
a:1,b:(),c:12,d:{}
```
a=1ä¼ å…¥æ—¶aå°±æ˜¯å…³é”®å­—å‚æ•°ï¼Œb,déƒ½æœªä¼ å€¼ï¼Œcè¢«ä¼ å…¥12ï¼Œè€Œéé»˜è®¤å€¼ã€‚

æ³¨æ„è§‚å¯Ÿå‚æ•°`a`, æ—¢å¯ä»¥`f(1)`,ä¹Ÿå¯ä»¥`f(a=1)` å…¶å¯è¯»æ€§æ¯”ç¬¬ä¸€ç§æ›´å¥½ï¼Œå»ºè®®ä½¿ç”¨f(a=1)ã€‚å¦‚æœè¦å¼ºåˆ¶ä½¿ç”¨`f(a=1)`ï¼Œéœ€è¦åœ¨å‰é¢æ·»åŠ ä¸€ä¸ª**æ˜Ÿå·**:
```python
def f(*,a,**b):
  print(f'a:{a},b:{b}')
```
æ­¤æ—¶f(1)è°ƒç”¨ï¼Œå°†ä¼šæŠ¥é”™ï¼š`TypeError: f() takes 0 positional arguments but 1 was given`

åªèƒ½`f(a=1)`æ‰èƒ½OK.

è¯´æ˜å‰é¢çš„`*`å‘æŒ¥ä½œç”¨ï¼Œå®ƒå˜ä¸ºåªèƒ½ä¼ å…¥å…³é”®å­—å‚æ•°ï¼Œé‚£ä¹ˆå¦‚ä½•æŸ¥çœ‹è¿™ä¸ªå‚æ•°çš„ç±»å‹å‘¢ï¼Ÿå€ŸåŠ©pythonçš„`inspect`æ¨¡å—ï¼š

```python
In [22]: for name,val in signature(f).parameters.items():
    ...:     print(name,val.kind)
    ...:
a KEYWORD_ONLY
b VAR_KEYWORD
```

å¯çœ‹åˆ°å‚æ•°`a`çš„ç±»å‹ä¸º`KEYWORD_ONLY`ï¼Œä¹Ÿå°±æ˜¯ä»…ä»…ä¸ºå…³é”®å­—å‚æ•°ã€‚

ä½†æ˜¯ï¼Œå¦‚æœfå®šä¹‰ä¸ºï¼š
```python
def f(a,*b):
  print(f'a:{a},b:{b}')
```
æŸ¥çœ‹å‚æ•°ç±»å‹ï¼š
```python
In [24]: for name,val in signature(f).parameters.items():
    ...:     print(name,val.kind)
    ...:
a POSITIONAL_OR_KEYWORD
b VAR_POSITIONAL
```
å¯ä»¥çœ‹åˆ°å‚æ•°`a`æ—¢å¯ä»¥æ˜¯ä½ç½®å‚æ•°ä¹Ÿå¯æ˜¯å…³é”®å­—å‚æ•°ã€‚

#### 86  ä½¿ç”¨sliceå¯¹è±¡

ç”Ÿæˆå…³äºè›‹ç³•çš„åºåˆ—cake1ï¼š

```
In [1]: cake1 = list(range(5,0,-1))

In [2]: b = cake1[1:10:2]

In [3]: b
Out[3]: [4, 2]

In [4]: cake1
Out[4]: [5, 4, 3, 2, 1]
```

å†ç”Ÿæˆä¸€ä¸ªåºåˆ—ï¼š

```
In [5]: from random import randint
   ...: cake2 = [randint(1,100) for _ in range(100)]
   ...: # åŒæ ·ä»¥é—´éš”ä¸º2åˆ‡å‰10ä¸ªå…ƒç´ ï¼Œå¾—åˆ°åˆ‡ç‰‡d
   ...: d = cake2[1:10:2]
In [6]: d
Out[6]: [75, 33, 63, 93, 15]
```

ä½ çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒä¸€ç§åˆ‡æ³•ï¼Œåˆ†åˆ«åˆ‡å¼€ä¸¤ä¸ªè›‹ç³•cake1,cake2. åæ¥å‘ç°è¿™ç§åˆ‡æ³•`æä¸ºç»å…¸`ï¼Œåˆæ‹¿å®ƒå»åˆ‡æ›´å¤šçš„å®¹å™¨å¯¹è±¡ã€‚

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸æŠŠè¿™ç§åˆ‡æ³•å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿäºæ˜¯å°±æœ‰äº†sliceå¯¹è±¡ã€‚

å®šä¹‰sliceå¯¹è±¡æä¸ºç®€å•ï¼Œå¦‚æŠŠä¸Šé¢çš„åˆ‡æ³•å®šä¹‰æˆsliceå¯¹è±¡ï¼š

```
perfect_cake_slice_way = slice(1,10,2)
#å»åˆ‡cake1
cake1_slice = cake1[perfect_cake_slice_way] 
cake2_slice = cake2[perfect_cake_slice_way]

In [11]: cake1_slice
Out[11]: [4, 2]

In [12]: cake2_slice
Out[12]: [75, 33, 63, 93, 15]
```

ä¸ä¸Šé¢çš„ç»“æœä¸€è‡´ã€‚

å¯¹äºé€†å‘åºåˆ—åˆ‡ç‰‡ï¼Œ`slice`å¯¹è±¡ä¸€æ ·å¯è¡Œï¼š

```
a = [1,3,5,7,9,0,3,5,7]
a_ = a[5:1:-1]

named_slice = slice(5,1,-1)
a_slice = a[named_slice] 

In [14]: a_
Out[14]: [0, 9, 7, 5]

In [15]: a_slice
Out[15]: [0, 9, 7, 5]
```

é¢‘ç¹ä½¿ç”¨åŒä¸€åˆ‡ç‰‡çš„æ“ä½œå¯ä½¿ç”¨sliceå¯¹è±¡æŠ½å‡ºæ¥ï¼Œå¤ç”¨çš„åŒæ—¶è¿˜èƒ½æé«˜ä»£ç å¯è¯»æ€§ã€‚



#### 87 lambda å‡½æ•°çš„åŠ¨ç”»æ¼”ç¤º

æœ‰äº›è¯»è€…åæ˜ ï¼Œ`lambda`å‡½æ•°ä¸å¤ªä¼šç”¨ï¼Œé—®æˆ‘èƒ½ä¸èƒ½è§£é‡Šä¸€ä¸‹ã€‚

æ¯”å¦‚ï¼Œä¸‹é¢æ±‚è¿™ä¸ª `lambda`å‡½æ•°ï¼š

```python
def max_len(*lists):
    return max(*lists, key=lambda v: len(v))
```

æœ‰ä¸¤ç‚¹ç–‘æƒ‘ï¼š

- å‚æ•°`v`çš„å–å€¼ï¼Ÿ 
- `lambda`å‡½æ•°æœ‰è¿”å›å€¼å—ï¼Ÿå¦‚æœæœ‰ï¼Œè¿”å›å€¼æ˜¯å¤šå°‘ï¼Ÿ

è°ƒç”¨ä¸Šé¢å‡½æ•°ï¼Œæ±‚å‡ºä»¥ä¸‹ä¸‰ä¸ªæœ€é•¿çš„åˆ—è¡¨ï¼š

```python
r = max_len([1, 2, 3], [4, 5, 6, 7], [8])
print(f'æ›´é•¿çš„åˆ—è¡¨æ˜¯{r}')
```

ç¨‹åºå®Œæ•´è¿è¡Œè¿‡ç¨‹ï¼ŒåŠ¨ç”»æ¼”ç¤ºå¦‚ä¸‹ï¼š

![](./img/lambda_show.gif)




ç»“è®ºï¼š
- å‚æ•°vçš„å¯èƒ½å–å€¼ä¸º`*lists`ï¼Œä¹Ÿå°±æ˜¯ `tuple` çš„ä¸€ä¸ªå…ƒç´ ã€‚

- `lambda`å‡½æ•°è¿”å›å€¼ï¼Œç­‰äº`lambda v`å†’å·åè¡¨è¾¾å¼çš„è¿”å›å€¼ã€‚

#### 88 ç²˜æ€§ä¹‹ç¦…

7 è¡Œä»£ç å¤Ÿçƒ§è„‘ï¼Œä¸ä¿¡è¯•è¯•~~

```python
def product(*args, repeat=1):
    pools = [tuple(pool) for pool in args] * repeat
    result = [[]]
    for pool in pools:
        result = [x+[y] for x in result for y in pool]
    for prod in result:
        yield tuple(prod)
```


è°ƒç”¨å‡½æ•°ï¼š
```python
rtn = product('xyz', '12', repeat=3)
print(list(rtn))
```

å¿«å»æ‰‹åŠ¨æ•²æ•²ï¼Œçœ‹çœ‹è¾“å‡ºå•¥å§~~

#### 89 å…ƒç±»

`xiaoming`, `xiaohong`, `xiaozhang` éƒ½æ˜¯å­¦ç”Ÿï¼Œè¿™ç±»ç¾¤ä½“å«åš `Student`. 

Python å®šä¹‰ç±»çš„å¸¸è§æ–¹æ³•ï¼Œä½¿ç”¨å…³é”®å­— `class`

```python
In [36]: class Student(object):
    ...:     pass
```
`xiaoming`, `xiaohong`, `xiaozhang` æ˜¯ç±»çš„å®ä¾‹ï¼Œåˆ™ï¼š

```python
xiaoming = Student()
xiaohong = Student()
xiaozhang = Student()
```

åˆ›å»ºåï¼Œxiaoming çš„ `__class__` å±æ€§ï¼Œè¿”å›çš„ä¾¿æ˜¯ `Student`ç±»

```python
In [38]: xiaoming.__class__
Out[38]: __main__.Student
```

é—®é¢˜åœ¨äºï¼Œ`Student` ç±»æœ‰ `__class__`å±æ€§ï¼Œå¦‚æœæœ‰ï¼Œè¿”å›çš„åˆæ˜¯ä»€ä¹ˆï¼Ÿ
```python
In [39]: xiaoming.__class__.__class__
Out[39]: type
```
å“‡ï¼Œç¨‹åºæ²¡æŠ¥é”™ï¼Œè¿”å› `type`

é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸å¦¨çŒœæµ‹ï¼š`Student` ç±»ï¼Œç±»å‹å°±æ˜¯ `type`

æ¢å¥è¯è¯´ï¼Œ`Student`ç±»å°±æ˜¯ä¸€ä¸ª**å¯¹è±¡**ï¼Œå®ƒçš„ç±»å‹å°±æ˜¯ `type`

æ‰€ä»¥ï¼ŒPython ä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼Œ**ç±»ä¹Ÿæ˜¯å¯¹è±¡**

Python ä¸­ï¼Œå°†æè¿° `Student` ç±»çš„ç±»è¢«ç§°ä¸ºï¼šå…ƒç±»ã€‚

æŒ‰ç…§æ­¤é€»è¾‘å»¶ä¼¸ï¼Œæè¿°å…ƒç±»çš„ç±»è¢«ç§°ä¸ºï¼š*å…ƒå…ƒç±»*ï¼Œå¼€ç©ç¬‘äº†~ æè¿°å…ƒç±»çš„ç±»ä¹Ÿè¢«ç§°ä¸ºå…ƒç±»ã€‚

èªæ˜çš„æœ‹å‹ä¼šé—®äº†ï¼Œæ—¢ç„¶ `Student` ç±»å¯åˆ›å»ºå®ä¾‹ï¼Œé‚£ä¹ˆ `type` ç±»å¯åˆ›å»ºå®ä¾‹å—ï¼Ÿ å¦‚æœèƒ½ï¼Œå®ƒåˆ›å»ºçš„å®ä¾‹å°±å«ï¼šç±» äº†ã€‚ ä½ ä»¬çœŸèªæ˜ï¼

è¯´å¯¹äº†ï¼Œ`type` ç±»ä¸€å®šèƒ½åˆ›å»ºå®ä¾‹ï¼Œæ¯”å¦‚ `Student` ç±»äº†ã€‚

```python
In [40]: Student = type('Student',(),{})

In [41]: Student
Out[41]: __main__.Student
```
å®ƒä¸ä½¿ç”¨ `class` å…³é”®å­—åˆ›å»ºçš„ `Student` ç±»ä¸€æ¨¡ä¸€æ ·ã€‚

Python çš„ç±»ï¼Œå› ä¸ºåˆæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å’Œ `xiaoming`ï¼Œ`xiaohong` å¯¹è±¡æ“ä½œç›¸ä¼¼ã€‚æ”¯æŒï¼š
- èµ‹å€¼
- æ‹·è´
- æ·»åŠ å±æ€§
- ä½œä¸ºå‡½æ•°å‚æ•°

```python
In [43]: StudentMirror = Student # ç±»ç›´æ¥èµ‹å€¼ # ç±»ç›´æ¥èµ‹å€¼
In [44]: Student.class_property = 'class_property' # æ·»åŠ ç±»å±æ€§
In [46]: hasattr(Student, 'class_property')
Out[46]: True
```

å…ƒç±»ï¼Œç¡®å®ä½¿ç”¨ä¸æ˜¯é‚£ä¹ˆå¤šï¼Œä¹Ÿè®¸å…ˆäº†è§£è¿™äº›ï¼Œå°±èƒ½åº”ä»˜ä¸€äº›åœºåˆã€‚å°±è¿ Python ç•Œçš„é¢†è¢– `Tim Peters` éƒ½è¯´ï¼š

â€œå…ƒç±»å°±æ˜¯æ·±åº¦çš„é­”æ³•ï¼Œ99%çš„ç”¨æˆ·åº”è¯¥æ ¹æœ¬ä¸å¿…ä¸ºæ­¤æ“å¿ƒã€‚â€

#### 90 å¯¹è±¡åºåˆ—åŒ–

å¯¹è±¡åºåˆ—åŒ–ï¼Œæ˜¯æŒ‡å°†å†…å­˜ä¸­çš„å¯¹è±¡è½¬åŒ–ä¸ºå¯å­˜å‚¨æˆ–ä¼ è¾“çš„è¿‡ç¨‹ã€‚å¾ˆå¤šåœºæ™¯ï¼Œç›´æ¥ä¸€ä¸ªç±»å¯¹è±¡ï¼Œä¼ è¾“ä¸æ–¹ä¾¿ã€‚

ä½†æ˜¯ï¼Œå½“å¯¹è±¡åºåˆ—åŒ–åï¼Œå°±ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œå› ä¸ºçº¦å®šä¿—æˆçš„ï¼Œæ¥å£é—´çš„è°ƒç”¨æˆ–è€…å‘èµ·çš„ web è¯·æ±‚ï¼Œä¸€èˆ¬ä½¿ç”¨ json ä¸²ä¼ è¾“ã€‚

å®é™…ä½¿ç”¨ä¸­ï¼Œä¸€èˆ¬å¯¹ç±»å¯¹è±¡åºåˆ—åŒ–ã€‚å…ˆåˆ›å»ºä¸€ä¸ª Student ç±»å‹ï¼Œå¹¶åˆ›å»ºä¸¤ä¸ªå®ä¾‹ã€‚

```python
class Student():
    def __init__(self,**args):
        self.ids = args['ids']
        self.name = args['name']
        self.address = args['address']
xiaoming = Student(ids = 1,name = 'xiaoming',address = 'åŒ—äº¬')
xiaohong = Student(ids = 2,name = 'xiaohong',address = 'å—äº¬')
```

å¯¼å…¥ json æ¨¡å—ï¼Œè°ƒç”¨ dump æ–¹æ³•ï¼Œå°±ä¼šå°†åˆ—è¡¨å¯¹è±¡ [xiaoming,xiaohong]ï¼Œåºåˆ—åŒ–åˆ°æ–‡ä»¶ json.txt ä¸­ã€‚
```python
import json

with open('json.txt', 'w') as f:
    json.dump([xiaoming,xiaohong], f, default=lambda obj: obj.__dict__, ensure_ascii=False, indent=2, sort_keys=True)
```

ç”Ÿæˆçš„æ–‡ä»¶å†…å®¹ï¼Œå¦‚ä¸‹ï¼š
```json
[
    {
        "address":"åŒ—äº¬",
        "ids":1,
        "name":"xiaoming"
    },
    {
        "address":"å—äº¬",
        "ids":2,
        "name":"xiaohong"
    }
]
```

### äºŒã€Pythonå­—ç¬¦ä¸²å’Œæ­£åˆ™

å­—ç¬¦ä¸²æ— æ‰€ä¸åœ¨ï¼Œå­—ç¬¦ä¸²çš„å¤„ç†ä¹Ÿæ˜¯æœ€å¸¸è§çš„æ“ä½œã€‚æœ¬ç« èŠ‚å°†æ€»ç»“å’Œå­—ç¬¦ä¸²å¤„ç†ç›¸å…³çš„ä¸€åˆ‡æ“ä½œã€‚ä¸»è¦åŒ…æ‹¬åŸºæœ¬çš„å­—ç¬¦ä¸²æ“ä½œï¼›é«˜çº§å­—ç¬¦ä¸²æ“ä½œä¹‹æ­£åˆ™ã€‚ç›®å‰å…±æœ‰`25`ä¸ªå°ä¾‹å­

#### 91 åè½¬å­—ç¬¦ä¸²

```python
st="python"
#æ–¹æ³•1
''.join(reversed(st))
#æ–¹æ³•2
st[::-1]
```

#### 92 å­—ç¬¦ä¸²åˆ‡ç‰‡æ“ä½œ

```python
å­—ç¬¦ä¸²åˆ‡ç‰‡æ“ä½œâ€”â€”æŸ¥æ‰¾æ›¿æ¢3æˆ–5çš„å€æ•°
In [1]:[str("java"[i%3*4:]+"python"[i%5*6:] or i) for i in range(1,15)]
OUT[1]:['1',
 '2',
 'java',
 '4',
 'python',
 'java',
 '7',
 '8',
 'java',
 'python',
 '11',
 'java',
 '13',
 '14']
```
#### 93 joinä¸²è”å­—ç¬¦ä¸²
```python
In [4]: mystr = ['1',
   ...:  '2',
   ...:  'java',
   ...:  '4',
   ...:  'python',
   ...:  'java',
   ...:  '7',
   ...:  '8',
   ...:  'java',
   ...:  'python',
   ...:  '11',
   ...:  'java',
   ...:  '13',
   ...:  '14']

In [5]: ','.join(mystr) #ç”¨é€—å·è¿æ¥å­—ç¬¦ä¸²
Out[5]: '1,2,java,4,python,java,7,8,java,python,11,java,13,14'
```

#### 94 å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦

```python
def str_byte_len(mystr):
    return (len(mystr.encode('utf-8')))


str_byte_len('i love python')  # 13(ä¸ªå­—èŠ‚)
str_byte_len('å­—ç¬¦')  # 6(ä¸ªå­—èŠ‚)
```



**ä»¥ä¸‹æ˜¯æ­£åˆ™éƒ¨åˆ†**

```python
import re
```

#### 95 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…ä¸²

```python
s = 'i love python very much'
pat = 'python' 
r = re.search(pat,s)
print(r.span()) #(7,13)
```

#### 96 æŸ¥æ‰¾æ‰€æœ‰ 1 çš„ç´¢å¼•

```python
s = 'å±±ä¸œçœæ½åŠå¸‚é’å·ç¬¬1ä¸­å­¦é«˜ä¸‰1ç­'
pat = '1'
r = re.finditer(pat,s)
for i in r:
    print(i)

# <re.Match object; span=(9, 10), match='1'>
# <re.Match object; span=(14, 15), match='1'>
```

#### 97 \d åŒ¹é…æ•°å­—[0-9]
findallæ‰¾å‡ºå…¨éƒ¨ä½ç½®çš„æ‰€æœ‰åŒ¹é…
```python
s = 'ä¸€å…±20è¡Œä»£ç è¿è¡Œæ—¶é—´13.59s'
pat = r'\d+' # +è¡¨ç¤ºåŒ¹é…æ•°å­—(\dè¡¨ç¤ºæ•°å­—çš„é€šç”¨å­—ç¬¦)1æ¬¡æˆ–å¤šæ¬¡
r = re.findall(pat,s)
print(r)
# ['20', '13', '59']
```

#### 98 åŒ¹é…æµ®ç‚¹æ•°å’Œæ•´æ•°

?è¡¨ç¤ºå‰ä¸€ä¸ªå­—ç¬¦åŒ¹é…0æˆ–1æ¬¡
```python
s = 'ä¸€å…±20è¡Œä»£ç è¿è¡Œæ—¶é—´13.59s'
pat = r'\d+\.?\d+' # ?è¡¨ç¤ºåŒ¹é…å°æ•°ç‚¹(\.)0æ¬¡æˆ–1æ¬¡ï¼Œè¿™ç§å†™æ³•æœ‰ä¸ªå°bugï¼Œä¸èƒ½åŒ¹é…åˆ°ä¸ªä½æ•°çš„æ•´æ•°
r = re.findall(pat,s)
print(r)
# ['20', '13.59']

# æ›´å¥½çš„å†™æ³•ï¼š
pat = r'\d+\.\d+|\d+' # A|Bï¼ŒåŒ¹é…Aå¤±è´¥æ‰åŒ¹é…B
```
#### 99 ^åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´

```python
s = 'This module provides regular expression matching operations similar to those found in Perl'
pat = r'^[emrt]' # æŸ¥æ‰¾ä»¥å­—ç¬¦e,m,ræˆ–tå¼€å§‹çš„å­—ç¬¦ä¸²
r = re.findall(pat,s)
print(r)
# [],å› ä¸ºå­—ç¬¦ä¸²çš„å¼€å¤´æ˜¯å­—ç¬¦`T`ï¼Œä¸åœ¨emrtåŒ¹é…èŒƒå›´å†…ï¼Œæ‰€ä»¥è¿”å›ä¸ºç©º
IN [11]: s2 = 'email for me is guozhennianhua@163.com'
re.findall('^[emrt].*',s2)# åŒ¹é…ä»¥e,m,r,tå¼€å§‹çš„å­—ç¬¦ä¸²ï¼Œåé¢æ˜¯å¤šä¸ªä»»æ„å­—ç¬¦
Out[11]: ['email for me is guozhennianhua@163.com']

```
#### 100 re.I å¿½ç•¥å¤§å°å†™

```python
s = 'That'
pat = r't' 
r = re.findall(pat,s,re.I)
In [22]: r
Out[22]: ['T', 't']
```
#### 101 ç†è§£compileçš„ä½œç”¨
å¦‚æœè¦åšå¾ˆå¤šæ¬¡åŒ¹é…ï¼Œå¯ä»¥å…ˆç¼–è¯‘åŒ¹é…ä¸²ï¼š
```python
import re
pat = re.compile('\W+') # \W åŒ¹é…ä¸æ˜¯æ•°å­—å’Œå­—æ¯çš„å­—ç¬¦
has_special_chars = pat.search('ed#2@edc') 
if has_special_chars:
    print(f'str contains special characters:{has_special_chars.group(0)}')

###è¾“å‡ºç»“æœ: 
 # str contains special characters:#   

### å†æ¬¡ä½¿ç”¨patæ­£åˆ™ç¼–è¯‘å¯¹è±¡ åšåŒ¹é…
again_pattern = pat.findall('guozhennianhua@163.com')
if '@' in again_pattern:
    print('possibly it is an email')

```

#### 102 ä½¿ç”¨()æ•è·å•è¯ï¼Œä¸æƒ³å¸¦ç©ºæ ¼
ä½¿ç”¨`()`æ•è·
```python
s = 'This module provides regular expression matching operations similar to those found in Perl'
pat = r'\s([a-zA-Z]+)'  
r = re.findall(pat,s)
print(r) #['module', 'provides', 'regular', 'expression', 'matching', 'operations', 'similar', 'to', 'those', 'found', 'in', 'Perl']
```
çœ‹åˆ°æå–å•è¯ä¸­æœªåŒ…æ‹¬ç¬¬ä¸€ä¸ªå•è¯ï¼Œä½¿ç”¨`?`è¡¨ç¤ºå‰é¢å­—ç¬¦å‡ºç°0æ¬¡æˆ–1æ¬¡ï¼Œä½†æ˜¯æ­¤å­—ç¬¦è¿˜æœ‰è¡¨ç¤ºè´ªå¿ƒæˆ–éè´ªå¿ƒåŒ¹é…å«ä¹‰ï¼Œä½¿ç”¨æ—¶è¦è°¨æ…ã€‚
```python
s = 'This module provides regular expression matching operations similar to those found in Perl'
pat = r'\s?([a-zA-Z]+)'  
r = re.findall(pat,s)
print(r) #['This', 'module', 'provides', 'regular', 'expression', 'matching', 'operations', 'similar', 'to', 'those', 'found', 'in', 'Perl']
```

#### 103 splitåˆ†å‰²å•è¯
ä½¿ç”¨ä»¥ä¸Šæ–¹æ³•åˆ†å‰²å•è¯ä¸æ˜¯ç®€æ´çš„ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ¼”ç¤ºã€‚åˆ†å‰²å•è¯æœ€ç®€å•è¿˜æ˜¯ä½¿ç”¨`split`å‡½æ•°ã€‚
```python
s = 'This module provides regular expression matching operations similar to those found in Perl'
pat = r'\s+'  
r = re.split(pat,s)
print(r) # ['This', 'module', 'provides', 'regular', 'expression', 'matching', 'operations', 'similar', 'to', 'those', 'found', 'in', 'Perl']

### ä¸Šé¢è¿™å¥è¯ä¹Ÿå¯ç›´æ¥ä½¿ç”¨strè‡ªå¸¦çš„splitå‡½æ•°ï¼š
s.split(' ') #ä½¿ç”¨ç©ºæ ¼åˆ†éš”

### ä½†æ˜¯ï¼Œå¯¹äºé£æ ¼ç¬¦æ›´åŠ å¤æ‚çš„æƒ…å†µï¼Œsplitæ— èƒ½ä¸ºåŠ›ï¼Œåªèƒ½ä½¿ç”¨æ­£åˆ™

s = 'This,,,   module ; \t   provides|| regular ; '
words = re.split('[,\s;|]+',s)  #è¿™æ ·åˆ†éš”å‡ºæ¥ï¼Œæœ€åä¼šæœ‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²
words = [i for i in words if len(i)>0]
```

#### 104 matchä»å­—ç¬¦ä¸²å¼€å§‹ä½ç½®åŒ¹é…
æ³¨æ„`match`,`search`ç­‰çš„ä¸åŒï¼š
1) matchå‡½æ•°
```python
import re
### match
mystr = 'This'
pat = re.compile('hi')
pat.match(mystr) # None
pat.match(mystr,1) # ä»ä½ç½®1å¤„å¼€å§‹åŒ¹é…
Out[90]: <re.Match object; span=(1, 3), match='hi'>
```
2) searchå‡½æ•°
searchæ˜¯ä»å­—ç¬¦ä¸²çš„ä»»æ„ä½ç½®å¼€å§‹åŒ¹é…
```python
In [91]: mystr = 'This'
    ...: pat = re.compile('hi')
    ...: pat.search(mystr)
Out[91]: <re.Match object; span=(1, 3), match='hi'>
```

#### 105 æ›¿æ¢åŒ¹é…çš„å­ä¸²
`sub`å‡½æ•°å®ç°å¯¹åŒ¹é…å­ä¸²çš„æ›¿æ¢
```python
content="hello 12345, hello 456321"    
pat=re.compile(r'\d+') #è¦æ›¿æ¢çš„éƒ¨åˆ†
m=pat.sub("666",content)
print(m) # hello 666, hello 666
```

#### 106 è´ªå¿ƒæ•è·
(.*)è¡¨ç¤ºæ•è·ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œå°½å¯èƒ½å¤šçš„åŒ¹é…å­—ç¬¦
```python
content='<h>ddedadsad</h><div>graph</div>bb<div>math</div>cc'
pat=re.compile(r"<div>(.*)</div>")  #è´ªå©ªæ¨¡å¼
m=pat.findall(content)
print(m) #åŒ¹é…ç»“æœä¸ºï¼š ['graph</div>bb<div>math']
```
#### 107 éè´ªå¿ƒæ•è·
ä»…æ·»åŠ ä¸€ä¸ªé—®å·(`?`)ï¼Œå¾—åˆ°ç»“æœå®Œå…¨ä¸åŒï¼Œè¿™æ˜¯éè´ªå¿ƒåŒ¹é…ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­ä½“ä¼šè´ªå¿ƒå’Œéè´ªå¿ƒçš„åŒ¹é…çš„ä¸åŒã€‚
```python
content='<h>ddedadsad</h><div>graph</div>bb<div>math</div>cc'
pat=re.compile(r"<div>(.*?)</div>")
m=pat.findall(content)
print(m) # ['graph', 'math']
```
éè´ªå¿ƒæ•è·ï¼Œè§å¥½å°±æ”¶ã€‚

#### 108 å¸¸ç”¨å…ƒå­—ç¬¦æ€»ç»“

    . åŒ¹é…ä»»æ„å­—ç¬¦  
    ^ åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹ä½ç½® 
    $ åŒ¹é…å­—ç¬¦ä¸²ä¸­ç»“æŸçš„ä½ç½® 
    * å‰é¢çš„åŸå­é‡å¤0æ¬¡ã€1æ¬¡ã€å¤šæ¬¡ 
    ? å‰é¢çš„åŸå­é‡å¤0æ¬¡æˆ–è€…1æ¬¡ 
    + å‰é¢çš„åŸå­é‡å¤1æ¬¡æˆ–å¤šæ¬¡
    {n} å‰é¢çš„åŸå­å‡ºç°äº† n æ¬¡
    {n,} å‰é¢çš„åŸå­è‡³å°‘å‡ºç° n æ¬¡
    {n,m} å‰é¢çš„åŸå­å‡ºç°æ¬¡æ•°ä»‹äº n-m ä¹‹é—´
    ( ) åˆ†ç»„,éœ€è¦è¾“å‡ºçš„éƒ¨åˆ†

#### 109 å¸¸ç”¨é€šç”¨å­—ç¬¦æ€»ç»“

    \s  åŒ¹é…ç©ºç™½å­—ç¬¦ 
    \w  åŒ¹é…ä»»æ„å­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿ 
    \W  å’Œå°å†™ w ç›¸åï¼ŒåŒ¹é…ä»»æ„å­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿ä»¥å¤–çš„å­—ç¬¦
    \d  åŒ¹é…åè¿›åˆ¶æ•°å­—
    \D  åŒ¹é…é™¤äº†åè¿›åˆ¶æ•°ä»¥å¤–çš„å€¼ 
    [0-9]  åŒ¹é…ä¸€ä¸ª0-9ä¹‹é—´çš„æ•°å­—
    [a-z]  åŒ¹é…å°å†™è‹±æ–‡å­—æ¯
    [A-Z]  åŒ¹é…å¤§å†™è‹±æ–‡å­—æ¯

#### 110 å¯†ç å®‰å…¨æ£€æŸ¥

å¯†ç å®‰å…¨è¦æ±‚ï¼š1)è¦æ±‚å¯†ç ä¸º6åˆ°20ä½; 2)å¯†ç åªåŒ…å«è‹±æ–‡å­—æ¯å’Œæ•°å­—

```python
pat = re.compile(r'\w{6,20}') # è¿™æ˜¯é”™è¯¯çš„ï¼Œå› ä¸º\wé€šé…ç¬¦åŒ¹é…çš„æ˜¯å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¢˜ç›®è¦æ±‚ä¸èƒ½å«æœ‰ä¸‹åˆ’çº¿
# ä½¿ç”¨æœ€ç¨³çš„æ–¹æ³•ï¼š\da-zA-Zæ»¡è¶³`å¯†ç åªåŒ…å«è‹±æ–‡å­—æ¯å’Œæ•°å­—`
pat = re.compile(r'[\da-zA-Z]{6,20}')
```
é€‰ç”¨æœ€ä¿é™©çš„`fullmatch`æ–¹æ³•ï¼ŒæŸ¥çœ‹æ˜¯å¦æ•´ä¸ªå­—ç¬¦ä¸²éƒ½åŒ¹é…ï¼š
```python
pat.fullmatch('qaz12') # è¿”å› None, é•¿åº¦å°äº6
pat.fullmatch('qaz12wsxedcrfvtgb67890942234343434') # None é•¿åº¦å¤§äº22
pat.fullmatch('qaz_231') # None å«æœ‰ä¸‹åˆ’çº¿
pat.fullmatch('n0passw0Rd')
Out[4]: <re.Match object; span=(0, 10), match='n0passw0Rd'>
```

#### 111 çˆ¬å–ç™¾åº¦é¦–é¡µæ ‡é¢˜

```python
import re
from urllib import request

#çˆ¬è™«çˆ¬å–ç™¾åº¦é¦–é¡µå†…å®¹
data=request.urlopen("http://www.baidu.com/").read().decode()

#åˆ†æç½‘é¡µ,ç¡®å®šæ­£åˆ™è¡¨è¾¾å¼
pat=r'<title>(.*?)</title>'

result=re.search(pat,data)
print(result) <re.Match object; span=(1358, 1382), match='<title>ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“</title>'>

result.group() # ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“
```

#### 112 æ‰¹é‡è½¬åŒ–ä¸ºé©¼å³°æ ¼å¼(Camel)

æ•°æ®åº“å­—æ®µåæ‰¹é‡è½¬åŒ–ä¸ºé©¼å³°æ ¼å¼

åˆ†æè¿‡ç¨‹

```python
# ç”¨åˆ°çš„æ­£åˆ™ä¸²è®²è§£
# \s æŒ‡åŒ¹é…ï¼š [ \t\n\r\f\v]
# A|Bï¼šè¡¨ç¤ºåŒ¹é…Aä¸²æˆ–Bä¸²
# re.sub(pattern, newchar, string): 
# substitueä»£æ›¿ï¼Œç”¨newcharå­—ç¬¦æ›¿ä»£ä¸patternåŒ¹é…çš„å­—ç¬¦æ‰€æœ‰.
```



```python
# title(): è½¬åŒ–ä¸ºå¤§å†™ï¼Œä¾‹å­ï¼š
# 'Hello world'.title() # 'Hello World'
```



```python
# print(re.sub(r"\s|_|", "", "He llo_worl\td"))
s = re.sub(r"(\s|_|-)+", " ",
           'some_database_field_name').title().replace(" ", "")  
#ç»“æœï¼š SomeDatabaseFieldName
```



```python
# å¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå¤§å†™ï¼Œéœ€è¦è½¬åŒ–ä¸ºå°å†™
s = s[0].lower()+s[1:]  # æœ€ç»ˆç»“æœ
```

 

æ•´ç†ä»¥ä¸Šåˆ†æå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š

```python
import re
def camel(s):
    s = re.sub(r"(\s|_|-)+", " ", s).title().replace(" ", "")
    return s[0].lower() + s[1:]

# æ‰¹é‡è½¬åŒ–
def batch_camel(slist):
    return [camel(s) for s in slist]
```

æµ‹è¯•ç»“æœï¼š

```python
s = batch_camel(['student_id', 'student\tname', 'student-add'])
print(s)
# ç»“æœ
['studentId', 'studentName', 'studentAdd']
```



#### 113 str1æ˜¯å¦ä¸ºstr2çš„permutation

æ’åºè¯(permutation)ï¼šä¸¤ä¸ªå­—ç¬¦ä¸²å«æœ‰ç›¸åŒå­—ç¬¦ï¼Œä½†å­—ç¬¦é¡ºåºä¸åŒã€‚

```python
from collections import defaultdict


def is_permutation(str1, str2):
    if str1 is None or str2 is None:
        return False
    if len(str1) != len(str2):
        return False
    unq_s1 = defaultdict(int)
    unq_s2 = defaultdict(int)
    for c1 in str1:
        unq_s1[c1] += 1
    for c2 in str2:
        unq_s2[c2] += 1

    return unq_s1 == unq_s2
```

è¿™ä¸ªå°ä¾‹å­ï¼Œä½¿ç”¨pythonå†…ç½®çš„`defaultdict`ï¼Œé»˜è®¤ç±»å‹åˆå§‹åŒ–ä¸º`int`ï¼Œè®¡æ•°é»˜æ¬¡æ•°éƒ½ä¸º0. è¿™ä¸ªè§£æ³•æœ¬è´¨æ˜¯ `hash map lookup`

ç»Ÿè®¡å‡ºçš„ä¸¤ä¸ªdefaultdictï¼šunq_s1ï¼Œunq_s2ï¼Œå¦‚æœç›¸ç­‰ï¼Œå°±è¡¨æ˜str1ã€ str2äº’ä¸ºæ’åºè¯ã€‚

ä¸‹é¢æµ‹è¯•ï¼š

```python
r = is_permutation('nice', 'cine')
print(r)  # True

r = is_permutation('', '')
print(r)  # True

r = is_permutation('', None)
print(r)  # False

r = is_permutation('work', 'woo')
print(r)  # False

```

ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨defaultdictçš„å°ä¾‹å­ï¼Œå¸Œæœ›å¯¹è¯»è€…æœ‹å‹ç†è§£æ­¤ç±»å‹æœ‰å¸®åŠ©ã€‚

#### 114 str1æ˜¯å¦ç”±str2æ—‹è½¬è€Œæ¥

`stringbook`æ—‹è½¬åå¾—åˆ°`bookstring`,å†™ä¸€æ®µä»£ç éªŒè¯`str1`æ˜¯å¦ä¸º`str2`æ—‹è½¬å¾—åˆ°ã€‚

**æ€è·¯**

è½¬åŒ–ä¸ºåˆ¤æ–­ï¼š`str1`æ˜¯å¦ä¸º`str2+str2`çš„å­ä¸²

```python
def is_rotation(s1: str, s2: str) -> bool:
    if s1 is None or s2 is None:
        return False
    if len(s1) != len(s2):
        return False

    def is_substring(s1: str, s2: str) -> bool:
        return s1 in s2
    return is_substring(s1, s2 + s2)
```

**æµ‹è¯•**

```python
r = is_rotation('stringbook', 'bookstring')
print(r)  # True

r = is_rotation('greatman', 'maneatgr')
print(r)  # False
```

#### 115 æ­£æµ®ç‚¹æ•°

ä»ä¸€ç³»åˆ—å­—ç¬¦ä¸²ä¸­ï¼ŒæŒ‘é€‰å‡ºæ‰€æœ‰æ­£æµ®ç‚¹æ•°ã€‚

è¯¥æ€ä¹ˆåŠï¼Ÿ

ç©ç©æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ­£åˆ™æå®ƒï¼

å…³é”®æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ

æœ‰äº†ï¼

`^[1-9]\d*\.\d*$`

`^` è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹

`[1-9]` è¡¨ç¤ºæ•°å­—1,2,3,4,5,6,7,8,9

`^[1-9]` è¿èµ·æ¥è¡¨ç¤ºä»¥æ•°å­— `1-9` ä½œä¸ºå¼€å¤´

`\d` è¡¨ç¤ºä¸€ä½ `0-9` çš„æ•°å­—

`*` è¡¨ç¤ºå‰ä¸€ä½å­—ç¬¦å‡ºç° 0 æ¬¡ï¼Œ1 æ¬¡æˆ–å¤šæ¬¡

`\d*` è¡¨ç¤ºæ•°å­—å‡ºç° 0 æ¬¡ï¼Œ1 æ¬¡æˆ–å¤šæ¬¡ 

`\.` è¡¨ç¤ºå°æ•°ç‚¹

`\$` è¡¨ç¤ºå­—ç¬¦ä¸²ä»¥å‰ä¸€ä½çš„å­—ç¬¦ç»“æŸ

`^[1-9]\d*\.\d*$` è¿èµ·æ¥å°±æ±‚å‡ºæ‰€æœ‰å¤§äº 1.0 çš„æ­£æµ®ç‚¹æ•°ã€‚

é‚£ 0.0 åˆ° 1.0 ä¹‹é—´çš„æ­£æµ®ç‚¹æ•°ï¼Œæ€ä¹ˆæ±‚ï¼Œå¹²å˜›ä¸ç›´æ¥æ±‡æ€»åˆ°ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­å‘¢ï¼Ÿ

è¿™æ ·å†™ä¸è¡Œå—ï¼š`^[0-9]\d*\.\d*$`

OK!

é‚£æˆ‘ä»¬ç«‹å³æµ‹è¯•ä¸‹å‘—

```python
In [85]: import re

In [87]: recom = re.compile(r'^[0-9]\d*\.\d*$')

In [88]: recom.match('000.2')
Out[88]: <re.Match object; span=(0, 5), match='000.2'>
```

ç»“æœæ˜¾ç¤ºï¼Œæ­£åˆ™è¡¨è¾¾å¼ `^[0-9]\d*\.\d*$` ç«Ÿç„¶åŒ¹é…åˆ° `000.2 `ï¼Œè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ­£æµ®ç‚¹æ•°~~~ï¼ï¼ï¼ï¼

æ™•ï¼ï¼ï¼ï¼ï¼ï¼

æ‰€ä»¥çŸ¥é“ä¸ºå•¥è¦å…ˆåŒ¹é…å¤§äº 1.0 çš„æµ®ç‚¹æ•°äº†å§ï¼

å¦‚æœèƒ½å†™å‡ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå†å†™å¦ä¸€éƒ¨åˆ†å°±ä¸å›°éš¾äº†ï¼

0.0 åˆ° 1.0 é—´çš„æµ®ç‚¹æ•°ï¼š`^0\.\d*[1-9]\d*$`

ä¸¤ä¸ªå¼å­è¿æ¥èµ·æ¥å°±æ˜¯æœ€ç»ˆçš„ç»“æœï¼š

`^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$`

å¦‚æœè¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œçœ‹çœ‹ä¸‹é¢çš„æ­£åˆ™åˆ†å¸ƒå‰–æå›¾å§ï¼š

<img src="./img/image-20200220225043053.png" width="50%"/>

### ä¸‰ã€Pythonæ–‡ä»¶ã€æ—¥æœŸå’Œå¤šçº¿ç¨‹

Pythonæ–‡ä»¶IOæ“ä½œæ¶‰åŠæ–‡ä»¶è¯»å†™æ“ä½œï¼Œè·å–æ–‡ä»¶`åç¼€å`ï¼Œä¿®æ”¹åç¼€åï¼Œè·å–æ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œ`å‹ç¼©`æ–‡ä»¶ï¼Œ`åŠ å¯†`æ–‡ä»¶ç­‰æ“ä½œã€‚

Pythonæ—¥æœŸç« èŠ‚ï¼Œç”±è¡¨ç¤ºå¤§æ—¥æœŸçš„`calendar`, `date`æ¨¡å—ï¼Œé€æ¸è¿‡æ¸¡åˆ°è¡¨ç¤ºæ—¶é—´åˆ»åº¦æ›´å°çš„æ¨¡å—ï¼š`datetime`, `time`æ¨¡å—ï¼ŒæŒ‰ç…§æ­¤é€»è¾‘å±•å¼€ã€‚

Python`å¤šçº¿ç¨‹`å¸Œæœ›é€è¿‡5ä¸ªå°ä¾‹å­ï¼Œå¸®åŠ©ä½ å¯¹å¤šçº¿ç¨‹æ¨¡å‹ç¼–ç¨‹æœ¬è´¨æœ‰äº›æ›´æ¸…æ™°çš„è®¤è¯†ã€‚

ä¸€å…±æ€»ç»“æœ€å¸¸ç”¨çš„`26`ä¸ªå…³äºæ–‡ä»¶å’Œæ—¶é—´å¤„ç†æ¨¡å—çš„ä¾‹å­ã€‚

#### 116 è·å–åç¼€å

```python
import os
file_ext = os.path.splitext('./data/py/test.py')
front,ext = file_ext
In [5]: front
Out[5]: './data/py/test'

In [6]: ext
Out[6]: '.py'
```

#### 117 æ–‡ä»¶è¯»æ“ä½œ

```python
import os
# åˆ›å»ºæ–‡ä»¶å¤¹

def mkdir(path):
    isexists = os.path.exists(path)
    if not isexists:
        os.mkdir(path)
# è¯»å–æ–‡ä»¶ä¿¡æ¯

def openfile(filename):
    f = open(filename)
    fllist = f.read()
    f.close()
    return fllist  # è¿”å›è¯»å–å†…å®¹
```

#### 118  æ–‡ä»¶å†™æ“ä½œ

```python
# å†™å…¥æ–‡ä»¶ä¿¡æ¯
# example1
# wå†™å…¥ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æ¸…ç©ºå†…å®¹åå†™å…¥ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º
f = open(r"./data/test.txt", "w", encoding="utf-8")
print(f.write("æµ‹è¯•æ–‡ä»¶å†™å…¥"))
f.close

# example2
# aå†™å…¥ï¼Œæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™åœ¨æ–‡ä»¶å†…å®¹åè¿½åŠ å†™å…¥ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º
f = open(r"./data/test.txt", "a", encoding="utf-8")
print(f.write("æµ‹è¯•æ–‡ä»¶å†™å…¥"))
f.close

# example3
# withå…³é”®å­—ç³»ç»Ÿä¼šè‡ªåŠ¨å…³é—­æ–‡ä»¶å’Œå¤„ç†å¼‚å¸¸
with open(r"./data/test.txt", "w") as f:
    f.write("hello world!")
```

#### 119 è·¯å¾„ä¸­çš„æ–‡ä»¶å

```python
In [11]: import os
    ...: file_ext = os.path.split('./data/py/test.py')
    ...: ipath,ifile = file_ext
    ...:

In [12]: ipath
Out[12]: './data/py'

In [13]: ifile
Out[13]: 'test.py'
```

#### 120 æ‰¹é‡ä¿®æ”¹æ–‡ä»¶åç¼€

**æ‰¹é‡ä¿®æ”¹æ–‡ä»¶åç¼€**

æœ¬ä¾‹å­ä½¿ç”¨Pythonçš„`os`æ¨¡å—å’Œ `argparse`æ¨¡å—ï¼Œå°†å·¥ä½œç›®å½•`work_dir`ä¸‹æ‰€æœ‰åç¼€åä¸º`old_ext`çš„æ–‡ä»¶ä¿®æ”¹ä¸ºåç¼€åä¸º`new_ext`

é€šè¿‡æœ¬ä¾‹å­ï¼Œå¤§å®¶å°†ä¼šå¤§æ¦‚æ¸…æ¥š`argparse`æ¨¡å—çš„ä¸»è¦ç”¨æ³•ã€‚

å¯¼å…¥æ¨¡å—

```python
import argparse
import os
```

å®šä¹‰è„šæœ¬å‚æ•°

```python
def get_parser():
    parser = argparse.ArgumentParser(
        description='å·¥ä½œç›®å½•ä¸­æ–‡ä»¶åç¼€åä¿®æ”¹')
    parser.add_argument('work_dir', metavar='WORK_DIR', type=str, nargs=1,
                        help='ä¿®æ”¹åç¼€åçš„æ–‡ä»¶ç›®å½•')
    parser.add_argument('old_ext', metavar='OLD_EXT',
                        type=str, nargs=1, help='åŸæ¥çš„åç¼€')
    parser.add_argument('new_ext', metavar='NEW_EXT',
                        type=str, nargs=1, help='æ–°çš„åç¼€')
    return parser
```

åç¼€åæ‰¹é‡ä¿®æ”¹

```python
def batch_rename(work_dir, old_ext, new_ext):
    """
    ä¼ é€’å½“å‰ç›®å½•ï¼ŒåŸæ¥åç¼€åï¼Œæ–°çš„åç¼€ååï¼Œæ‰¹é‡é‡å‘½ååç¼€
    """
    for filename in os.listdir(work_dir):
        # è·å–å¾—åˆ°æ–‡ä»¶åç¼€
        split_file = os.path.splitext(filename)
        file_ext = split_file[1]
        # å®šä½åç¼€åä¸ºold_ext çš„æ–‡ä»¶
        if old_ext == file_ext:
            # ä¿®æ”¹åæ–‡ä»¶çš„å®Œæ•´åç§°
            newfile = split_file[0] + new_ext
            # å®ç°é‡å‘½åæ“ä½œ
            os.rename(
                os.path.join(work_dir, filename),
                os.path.join(work_dir, newfile)
            )
    print("å®Œæˆé‡å‘½å")
    print(os.listdir(work_dir))
```

å®ç°Main

```python
def main():
    """
    mainå‡½æ•°
    """
    # å‘½ä»¤è¡Œå‚æ•°
    parser = get_parser()
    args = vars(parser.parse_args())
    # ä»å‘½ä»¤è¡Œå‚æ•°ä¸­ä¾æ¬¡è§£æå‡ºå‚æ•°
    work_dir = args['work_dir'][0]
    old_ext = args['old_ext'][0]
    if old_ext[0] != '.':
        old_ext = '.' + old_ext
    new_ext = args['new_ext'][0]
    if new_ext[0] != '.':
        new_ext = '.' + new_ext

    batch_rename(work_dir, old_ext, new_ext)
```



#### 121 xlsæ‰¹é‡è½¬æ¢æˆxlsx

```python
import os


def xls_to_xlsx(work_dir):
    """
    ä¼ é€’å½“å‰ç›®å½•ï¼ŒåŸæ¥åç¼€åï¼Œæ–°çš„åç¼€ååï¼Œæ‰¹é‡é‡å‘½ååç¼€
    """
    old_ext, new_ext = '.xls', '.xlsx'
    for filename in os.listdir(work_dir):
        # è·å–å¾—åˆ°æ–‡ä»¶åç¼€
        split_file = os.path.splitext(filename)
        file_ext = split_file[1]
        # å®šä½åç¼€åä¸ºold_ext çš„æ–‡ä»¶
        if old_ext == file_ext:
            # ä¿®æ”¹åæ–‡ä»¶çš„å®Œæ•´åç§°
            newfile = split_file[0] + new_ext
            # å®ç°é‡å‘½åæ“ä½œ
            os.rename(
                os.path.join(work_dir, filename),
                os.path.join(work_dir, newfile)
            )
    print("å®Œæˆé‡å‘½å")
    print(os.listdir(work_dir))


xls_to_xlsx('./data')

# è¾“å‡ºç»“æœï¼š
# ['cut_words.csv', 'email_list.xlsx', 'email_test.docx', 'email_test.jpg', 'email_test.xlsx', 'geo_data.png', 'geo_data.xlsx',
'iotest.txt', 'pyside2.md', 'PySimpleGUI-4.7.1-py3-none-any.whl', 'test.txt', 'test_excel.xlsx', 'ziptest', 'ziptest.zip']
```



#### 122 å®šåˆ¶æ–‡ä»¶ä¸åŒè¡Œ


æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶åœ¨å“ªäº›è¡Œå†…å®¹ä¸åŒï¼Œè¿”å›è¿™äº›è¡Œçš„ç¼–å·ï¼Œè¡Œå·ç¼–å·ä»1å¼€å§‹ã€‚

å®šä¹‰ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°çš„å‡½æ•°

```python
# ç»Ÿè®¡æ–‡ä»¶ä¸ªæ•°
    def statLineCnt(statfile):
        print('æ–‡ä»¶åï¼š'+statfile)
        cnt = 0
        with open(statfile, encoding='utf-8') as f:
            while f.readline():
                cnt += 1
            return cnt
```



ç»Ÿè®¡æ–‡ä»¶ä¸åŒä¹‹å¤„çš„å­å‡½æ•°ï¼š

```python
# moreè¡¨ç¤ºå«æœ‰æ›´å¤šè¡Œæ•°çš„æ–‡ä»¶
        def diff(more, cnt, less):
            difflist = []
            with open(less, encoding='utf-8') as l:
                with open(more, encoding='utf-8') as m:
                    lines = l.readlines()
                    for i, line in enumerate(lines):
                        if line.strip() != m.readline().strip():
                            difflist.append(i)
            if cnt - i > 1:
                difflist.extend(range(i + 1, cnt))
            return [no+1 for no in difflist]
```



ä¸»å‡½æ•°ï¼š

```python
# è¿”å›çš„ç»“æœè¡Œå·ä»1å¼€å§‹
# listè¡¨ç¤ºfileAå’ŒfileBä¸åŒçš„è¡Œçš„ç¼–å·

def file_diff_line_nos(fileA, fileB):
    try:
        cntA = statLineCnt(fileA)
        cntB = statLineCnt(fileB)
        if cntA > cntB:
            return diff(fileA, cntA, fileB)
        return diff(fileB, cntB, fileA)

    except Exception as e:
        print(e)
```

æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶Aå’ŒBï¼Œæ‹¿ç›¸å¯¹è¾ƒçŸ­çš„æ–‡ä»¶å»æ¯”è¾ƒï¼Œè¿‡æ»¤è¡Œåçš„æ¢è¡Œç¬¦`\n`å’Œç©ºæ ¼ã€‚

æš‚æœªè€ƒè™‘æŸä¸ªæ–‡ä»¶æœ€åå¯èƒ½æœ‰çš„å¤šè¡Œç©ºè¡Œç­‰ç‰¹æ®Šæƒ…å†µ

ä½¿ç”¨`file_diff_line_nos` å‡½æ•°ï¼š

```python
if __name__ == '__main__':
    import os
    print(os.getcwd())

    '''
    ä¾‹å­ï¼š
    fileA = "'hello world!!!!''\
            'nice to meet you'\
            'yes'\
            'no1'\
            'jack'"
    fileB = "'hello world!!!!''\
            'nice to meet you'\
            'yes' "
    '''
    diff = file_diff_line_nos('./testdir/a.txt', './testdir/b.txt')
    print(diff)  # [4, 5]
```

å…³äºæ–‡ä»¶æ¯”è¾ƒçš„ï¼Œå®é™…ä¸Šï¼Œåœ¨Pythonä¸­æœ‰å¯¹åº”æ¨¡å—`difflib` , æä¾›æ›´å¤šå…¶ä»–æ ¼å¼çš„æ–‡ä»¶æ›´è¯¦ç»†çš„æ¯”è¾ƒï¼Œå¤§å®¶å¯å‚è€ƒï¼š

> https://docs.python.org/3/library/difflib.html?highlight=difflib#module-difflib



#### 123 è·å–æŒ‡å®šåç¼€åçš„æ–‡ä»¶

```python
import os

def find_file(work_dir,extension='jpg'):
    lst = []
    for filename in os.listdir(work_dir):
        print(filename)
        splits = os.path.splitext(filename)
        ext = splits[1] # æ‹¿åˆ°æ‰©å±•å
        if ext == '.'+extension:
            lst.append(filename)
    return lst

r = find_file('.','md') 
print(r) # è¿”å›æ‰€æœ‰ç›®å½•ä¸‹çš„mdæ–‡ä»¶
```


#### 124 æ‰¹é‡è·å–æ–‡ä»¶ä¿®æ”¹æ—¶é—´

```python
# è·å–ç›®å½•ä¸‹æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´
import os
from datetime import datetime

print(f"å½“å‰æ—¶é—´ï¼š{datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")

def get_modify_time(indir):
    for root, _, files in os.walk(indir):  # å¾ªç¯D:\worksç›®å½•å’Œå­ç›®å½•
        for file in files:
            absfile = os.path.join(root, file)
            modtime = datetime.fromtimestamp(os.path.getmtime(absfile))
            now = datetime.now()
            difftime = now-modtime
            if difftime.days < 20:  # æ¡ä»¶ç­›é€‰è¶…è¿‡æŒ‡å®šæ—¶é—´çš„æ–‡ä»¶
                print(f"""{absfile}
                    ä¿®æ”¹æ—¶é—´[{modtime.strftime('%Y-%m-%d %H:%M:%S')}]
                    è·ä»Š[{difftime.days:3d}å¤©{difftime.seconds//3600:2d}æ—¶{difftime.seconds%3600//60:2d}]"""
                      )  # æ‰“å°ç›¸å…³ä¿¡æ¯


get_modify_time('./data')
```

    æ‰“å°æ•ˆæœï¼š
    å½“å‰æ—¶é—´ï¼š2019-12-22 16:38:53
    ./data\cut_words.csv
                        ä¿®æ”¹æ—¶é—´[2019-12-21 10:34:15]
                        è·ä»Š[  1å¤© 6æ—¶ 4]
    å½“å‰æ—¶é—´ï¼š2019-12-22 16:38:53
    ./data\cut_words.csv
                        ä¿®æ”¹æ—¶é—´[2019-12-21 10:34:15]
                        è·ä»Š[  1å¤© 6æ—¶ 4]
    ./data\email_test.docx
                        ä¿®æ”¹æ—¶é—´[2019-12-03 07:46:29]
                        è·ä»Š[ 19å¤© 8æ—¶52]
    ./data\email_test.jpg
                        ä¿®æ”¹æ—¶é—´[2019-12-03 07:46:29]
                        è·ä»Š[ 19å¤© 8æ—¶52]
    ./data\email_test.xlsx
                        ä¿®æ”¹æ—¶é—´[2019-12-03 07:46:29]
                        è·ä»Š[ 19å¤© 8æ—¶52]
    ./data\iotest.txt
                        ä¿®æ”¹æ—¶é—´[2019-12-13 08:23:18]
                        è·ä»Š[  9å¤© 8æ—¶15]
    ./data\pyside2.md
                        ä¿®æ”¹æ—¶é—´[2019-12-05 08:17:22]
                        è·ä»Š[ 17å¤© 8æ—¶21]
    ./data\PySimpleGUI-4.7.1-py3-none-any.whl
                        ä¿®æ”¹æ—¶é—´[2019-12-05 00:25:47]
                        è·ä»Š[ 17å¤©16æ—¶13]

#### 125 æ‰¹é‡å‹ç¼©æ–‡ä»¶


```python
import zipfile  # å¯¼å…¥zipfile,è¿™ä¸ªæ˜¯ç”¨æ¥åšå‹ç¼©å’Œè§£å‹çš„Pythonæ¨¡å—ï¼›
import os
import time


def batch_zip(start_dir):
    start_dir = start_dir  # è¦å‹ç¼©çš„æ–‡ä»¶å¤¹è·¯å¾„
    file_news = start_dir + '.zip'  # å‹ç¼©åæ–‡ä»¶å¤¹çš„åå­—

    z = zipfile.ZipFile(file_news, 'w', zipfile.ZIP_DEFLATED)
    for dir_path, dir_names, file_names in os.walk(start_dir):
        # è¿™ä¸€å¥å¾ˆé‡è¦ï¼Œä¸replaceçš„è¯ï¼Œå°±ä»æ ¹ç›®å½•å¼€å§‹å¤åˆ¶
        f_path = dir_path.replace(start_dir, '')
        f_path = f_path and f_path + os.sep  # å®ç°å½“å‰æ–‡ä»¶å¤¹ä»¥åŠåŒ…å«çš„æ‰€æœ‰æ–‡ä»¶çš„å‹ç¼©
        for filename in file_names:
            z.write(os.path.join(dir_path, filename), f_path + filename)
    z.close()
    return file_news


batch_zip('./data/ziptest')


```

#### 126 32ä½åŠ å¯†

```python
import hashlib
# å¯¹å­—ç¬¦ä¸²så®ç°32ä½åŠ å¯†


def hash_cry32(s):
    m = hashlib.md5()
    m.update((str(s).encode('utf-8')))
    return m.hexdigest()


print(hash_cry32(1))  # c4ca4238a0b923820dcc509a6f75849b
print(hash_cry32('hello'))  # 5d41402abc4b2a76b9719d911017c592
```

#### 127 å¹´çš„æ—¥å†å›¾

```python
import calendar
from datetime import date
mydate = date.today()
year_calendar_str = calendar.calendar(2019)
print(f"{mydate.year}å¹´çš„æ—¥å†å›¾ï¼š{year_calendar_str}\n")
```

æ‰“å°ç»“æœï¼š

```python
2019

      January                   February                   March
Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su
    1  2  3  4  5  6                   1  2  3                   1  2  3
 7  8  9 10 11 12 13       4  5  6  7  8  9 10       4  5  6  7  8  9 10
14 15 16 17 18 19 20      11 12 13 14 15 16 17      11 12 13 14 15 16 17
21 22 23 24 25 26 27      18 19 20 21 22 23 24      18 19 20 21 22 23 24
28 29 30 31               25 26 27 28               25 26 27 28 29 30 31

       April                      May                       June
Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su
 1  2  3  4  5  6  7             1  2  3  4  5                      1  2
 8  9 10 11 12 13 14       6  7  8  9 10 11 12       3  4  5  6  7  8  9
15 16 17 18 19 20 21      13 14 15 16 17 18 19      10 11 12 13 14 15 16
22 23 24 25 26 27 28      20 21 22 23 24 25 26      17 18 19 20 21 22 23
29 30                     27 28 29 30 31            24 25 26 27 28 29 30

        July                     August                  September
Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su
 1  2  3  4  5  6  7                1  2  3  4                         1
 8  9 10 11 12 13 14       5  6  7  8  9 10 11       2  3  4  5  6  7  8
15 16 17 18 19 20 21      12 13 14 15 16 17 18       9 10 11 12 13 14 15
22 23 24 25 26 27 28      19 20 21 22 23 24 25      16 17 18 19 20 21 22
29 30 31                  26 27 28 29 30 31         23 24 25 26 27 28 29
                                                    30

      October                   November                  December
Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su      Mo Tu We Th Fr Sa Su
    1  2  3  4  5  6                   1  2  3                         1
 7  8  9 10 11 12 13       4  5  6  7  8  9 10       2  3  4  5  6  7  8
14 15 16 17 18 19 20      11 12 13 14 15 16 17       9 10 11 12 13 14 15
21 22 23 24 25 26 27      18 19 20 21 22 23 24      16 17 18 19 20 21 22
28 29 30 31               25 26 27 28 29 30         23 24 25 26 27 28 29
                                                    30 31
```

#### 128 åˆ¤æ–­æ˜¯å¦ä¸ºé—°å¹´

```python
import calendar
from datetime import date

mydate = date.today()
is_leap = calendar.isleap(mydate.year)
print_leap_str = "%så¹´æ˜¯é—°å¹´" if is_leap else "%så¹´ä¸æ˜¯é—°å¹´\n"
print(print_leap_str % mydate.year)
```

æ‰“å°ç»“æœï¼š

```python
2019å¹´ä¸æ˜¯é—°å¹´
```

#### 129 æœˆçš„æ—¥å†å›¾

```python
import calendar
from datetime import date

mydate = date.today()
month_calendar_str = calendar.month(mydate.year, mydate.month)

print(f"{mydate.year}å¹´-{mydate.month}æœˆçš„æ—¥å†å›¾ï¼š{month_calendar_str}\n")
```

æ‰“å°ç»“æœï¼š

```python
December 2019
Mo Tu We Th Fr Sa Su
                   1
 2  3  4  5  6  7  8
 9 10 11 12 13 14 15
16 17 18 19 20 21 22
23 24 25 26 27 28 29
30 31
```

#### 130 æœˆæœ‰å‡ å¤©

```python
import calendar
from datetime import date

mydate = date.today()
weekday, days = calendar.monthrange(mydate.year, mydate.month)
print(f'{mydate.year}å¹´-{mydate.month}æœˆçš„ç¬¬ä¸€å¤©æ˜¯é‚£ä¸€å‘¨çš„ç¬¬{weekday}å¤©\n')
print(f'{mydate.year}å¹´-{mydate.month}æœˆå…±æœ‰{days}å¤©\n')
```

æ‰“å°ç»“æœï¼š

```python
2019å¹´-12æœˆçš„ç¬¬ä¸€å¤©æ˜¯é‚£ä¸€å‘¨çš„ç¬¬6å¤©

2019å¹´-12æœˆå…±æœ‰31å¤©
```



#### 131 æœˆç¬¬ä¸€å¤©

```python
from datetime import date
mydate = date.today()
month_first_day = date(mydate.year, mydate.month, 1)
print(f"å½“æœˆç¬¬ä¸€å¤©:{month_first_day}\n")
```

æ‰“å°ç»“æœï¼š

```python
# å½“æœˆç¬¬ä¸€å¤©:2019-12-01
```



#### 131 æœˆæœ€åä¸€å¤©

```python
from datetime import date
import calendar
mydate = date.today()
_, days = calendar.monthrange(mydate.year, mydate.month)
month_last_day = date(mydate.year, mydate.month, days)
print(f"å½“æœˆæœ€åä¸€å¤©:{month_last_day}\n")
```

æ‰“å°ç»“æœï¼š

```python
å½“æœˆæœ€åä¸€å¤©:2019-12-31
```



#### 132 è·å–å½“å‰æ—¶é—´

```python
from datetime import date, datetime
from time import localtime

today_date = date.today()
print(today_date)  # 2019-12-22

today_time = datetime.today()
print(today_time)  # 2019-12-22 18:02:33.398894

local_time = localtime()
print(strftime("%Y-%m-%d %H:%M:%S", local_time))  # è½¬åŒ–ä¸ºå®šåˆ¶çš„æ ¼å¼ 2019-12-22 18:13:41
```



#### 133 å­—ç¬¦æ—¶é—´è½¬æ—¶é—´

```python
from time import strptime

# parse str time to struct time
struct_time = strptime('2019-12-22 10:10:08', "%Y-%m-%d %H:%M:%S")
print(struct_time) # struct_timeç±»å‹å°±æ˜¯timeä¸­çš„ä¸€ä¸ªç±»

# time.struct_time(tm_year=2019, tm_mon=12, tm_mday=22, tm_hour=10, tm_min=10, tm_sec=8, tm_wday=6, tm_yday=356, tm_isdst=-1)
```



#### 134 æ—¶é—´è½¬å­—ç¬¦æ—¶é—´

```python
from time import strftime, strptime, localtime

In [2]: print(localtime()) #è¿™æ˜¯è¾“å…¥çš„æ—¶é—´
Out[2]: time.struct_time(tm_year=2019, tm_mon=12, tm_mday=22, tm_hour=18, tm_min=24, tm_sec=56, tm_wday=6, tm_yday=356, tm_isdst=0)

print(strftime("%m-%d-%Y %H:%M:%S", localtime()))  # è½¬åŒ–ä¸ºå®šåˆ¶çš„æ ¼å¼
# è¿™æ˜¯å­—ç¬¦ä¸²è¡¨ç¤ºçš„æ—¶é—´ï¼š   12-22-2019 18:26:21
```



#### 135 é»˜è®¤å¯åŠ¨ä¸»çº¿ç¨‹

ä¸€èˆ¬çš„ï¼Œç¨‹åºé»˜è®¤æ‰§è¡Œåªåœ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹ç§°ä¸ºä¸»çº¿ç¨‹ï¼Œä¾‹å­æ¼”ç¤ºå¦‚ä¸‹ï¼š

å¯¼å…¥çº¿ç¨‹ç›¸å…³çš„æ¨¡å— `threading`:

```python
import threading
```

threadingçš„ç±»æ–¹æ³• `current_thread()`è¿”å›å½“å‰çº¿ç¨‹ï¼š

```python
t = threading.current_thread()
print(t) # <_MainThread(MainThread, started 139908235814720)>
```

æ‰€ä»¥ï¼ŒéªŒè¯äº†ç¨‹åºé»˜è®¤æ˜¯åœ¨`MainThead`ä¸­æ‰§è¡Œã€‚

`t.getName()`è·å¾—è¿™ä¸ªçº¿ç¨‹çš„åå­—ï¼Œå…¶ä»–å¸¸ç”¨æ–¹æ³•ï¼Œ`getName()`è·å¾—çº¿ç¨‹`id`,`isAlive()`åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å­˜æ´»ç­‰ã€‚

```python
print(t.getName()) # MainThread
print(t.ident) # 139908235814720
print(t.isAlive()) # True
```

ä»¥ä¸Šè¿™äº›ä»…æ˜¯ä»‹ç»å¤šçº¿ç¨‹çš„`èƒŒæ™¯çŸ¥è¯†`ï¼Œå› ä¸ºåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª"å¹²æ´»"çš„ä¸»çº¿ç¨‹

#### 136 åˆ›å»ºçº¿ç¨‹

åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼š

```python
my_thread = threading.Thread()
```

åˆ›å»ºä¸€ä¸ªåç§°ä¸º`my_thread`çš„çº¿ç¨‹ï¼š

```python
my_thread = threading.Thread(name='my_thread')
```

åˆ›å»ºçº¿ç¨‹çš„ç›®çš„æ˜¯å‘Šè¯‰å®ƒå¸®åŠ©æˆ‘ä»¬åšäº›ä»€ä¹ˆï¼Œåšäº›ä»€ä¹ˆé€šè¿‡å‚æ•°`target`ä¼ å…¥ï¼Œå‚æ•°ç±»å‹ä¸º`callable`ï¼Œå‡½æ•°å°±æ˜¯å¯è°ƒç”¨çš„ï¼š

```python
def print_i(i):
    print('æ‰“å°i:%d'%(i,))
my_thread = threading.Thread(target=print_i,args=(1,))
```

`my_thread`çº¿ç¨‹å·²ç»å…¨å‰¯æ­¦è£…ï¼Œä½†æ˜¯æˆ‘ä»¬å¾—æŒ‰ä¸‹å‘å°„æŒ‰é’®ï¼Œå¯åŠ¨start()ï¼Œå®ƒæ‰å¼€å§‹çœŸæ­£èµ·é£ã€‚

```python
my_thread().start()
```

æ‰“å°ç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­`args`æŒ‡å®šå‡½æ•°`print_i`éœ€è¦çš„å‚æ•°iï¼Œç±»å‹ä¸ºå…ƒç¥–ã€‚

```python
æ‰“å°i:1
```

è‡³æ­¤ï¼Œå¤šçº¿ç¨‹ç›¸å…³çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œå·²ç»æ€»ç»“å®Œæ¯•ã€‚ä½†æ˜¯ï¼Œä»…ä»…çŸ¥é“è¿™äº›ï¼Œè¿˜ä¸å¤Ÿï¼å…‰çº¸ä¸Šè°ˆå…µï¼Œå½“ç„¶è¿œè¿œä¸å¤Ÿã€‚

æ¥ä¸‹æ¥ï¼ŒèŠèŠåº”ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œæœ€æœ¬è´¨çš„ä¸€äº›ä¸œè¥¿ã€‚

**3 äº¤æ›¿è·å¾—CPUæ—¶é—´ç‰‡**

ä¸ºäº†æ›´å¥½è§£é‡Šï¼Œå‡å®šè®¡ç®—æœºæ˜¯å•æ ¸çš„ï¼Œå°½ç®¡å¯¹äº`cpython`ï¼Œè¿™ä¸ªå‡å®šæœ‰äº›å¤šä½™ã€‚

å¼€è¾Ÿ3ä¸ªçº¿ç¨‹ï¼Œè£…åˆ°`threads`ä¸­:

```python
import time
from datetime import datetime
import threading


def print_time():
    for _ in range(5): # åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­æ‰“å°5æ¬¡
        time.sleep(0.1) # æ¨¡æ‹Ÿæ‰“å°å‰çš„ç›¸å…³å¤„ç†é€»è¾‘
        print('å½“å‰çº¿ç¨‹%s,æ‰“å°ç»“æŸæ—¶é—´ä¸º:%s'%(threading.current_thread().getName(),datetime.today()))


threads = [threading.Thread(name='t%d'%(i,),target=print_time) for i in range(3)]
```

å¯åŠ¨3ä¸ªçº¿ç¨‹ï¼š

```python
[t.start() for t in threads]
```

æ‰“å°ç»“æœå¦‚ä¸‹ï¼Œ`t0`,`t1`,`t2`ä¸‰ä¸ªçº¿ç¨‹ï¼Œæ ¹æ®æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ç®—æ³•ï¼Œè½®è¯¢è·å¾—CPUæ—¶é—´ç‰‡ï¼Œæ³¨æ„è§‚å¯Ÿï¼Œ`t2`çº¿ç¨‹å¯èƒ½è¢«è¿ç»­è°ƒåº¦ï¼Œä»è€Œè·å¾—æ—¶é—´ç‰‡ã€‚

```python
å½“å‰çº¿ç¨‹t0,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.705235
å½“å‰çº¿ç¨‹t1,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.705402
å½“å‰çº¿ç¨‹t2,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.705687
å½“å‰çº¿ç¨‹t0,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.805767
å½“å‰çº¿ç¨‹t1,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.805886
å½“å‰çº¿ç¨‹t2,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.806044
å½“å‰çº¿ç¨‹t0,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.906200
å½“å‰çº¿ç¨‹t2,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.906320
å½“å‰çº¿ç¨‹t1,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:15.906433
å½“å‰çº¿ç¨‹t0,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.006581
å½“å‰çº¿ç¨‹t1,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.006766
å½“å‰çº¿ç¨‹t2,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.007006
å½“å‰çº¿ç¨‹t2,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.107564
å½“å‰çº¿ç¨‹t0,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.107290
å½“å‰çº¿ç¨‹t1,æ‰“å°ç»“æŸæ—¶é—´ä¸º:2020-01-12 02:27:16.107741
```

#### 137 å¤šçº¿ç¨‹æŠ¢å¤ºåŒä¸€ä¸ªå˜é‡

å¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œå­˜åœ¨æŠ¢å¤ºåŒä¸€ä¸ªå˜é‡çš„é—®é¢˜ã€‚

æ¯”å¦‚ä¸‹é¢ä¾‹å­ï¼Œåˆ›å»ºçš„10ä¸ªçº¿ç¨‹åŒæ—¶ç«äº‰å…¨å±€å˜é‡`a`:
â€‹

```python
import threading


a = 0
def add1():
    global a    
    a += 1
    print('%s  adds a to 1: %d'%(threading.current_thread().getName(),a))
    
threads = [threading.Thread(name='t%d'%(i,),target=add1) for i in range(10)]
[t.start() for t in threads]
```

æ‰§è¡Œç»“æœï¼š

```python
t0  adds a to 1: 1
t1  adds a to 1: 2
t2  adds a to 1: 3
t3  adds a to 1: 4
t4  adds a to 1: 5
t5  adds a to 1: 6
t6  adds a to 1: 7
t7  adds a to 1: 8
t8  adds a to 1: 9
t9  adds a to 1: 10
```

ç»“æœä¸€åˆ‡æ­£å¸¸ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€æ¬¡ï¼ŒæŠŠ`a`çš„å€¼åŠ 1ï¼Œæœ€å`a` å˜ä¸º10ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚

è¿è¡Œä¸Šé¢ä»£ç åå‡ éï¼Œä¸€åˆ‡ä¹Ÿéƒ½æ­£å¸¸ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬èƒ½ä¸‹ç»“è®ºï¼šè¿™æ®µä»£ç æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ

NOï¼

å¤šçº¿ç¨‹ä¸­ï¼Œåªè¦å­˜åœ¨åŒæ—¶è¯»å–å’Œä¿®æ”¹ä¸€ä¸ªå…¨å±€å˜é‡çš„æƒ…å†µï¼Œå¦‚æœä¸é‡‡å–å…¶ä»–æªæ–½ï¼Œå°±ä¸€å®šä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚

å°½ç®¡ï¼Œæœ‰æ—¶ï¼ŒæŸäº›æƒ…å†µçš„èµ„æºç«äº‰ï¼Œæš´éœ²å‡ºé—®é¢˜çš„æ¦‚ç‡`æä½æä½`ï¼š

æœ¬ä¾‹ä¸­ï¼Œå¦‚æœçº¿ç¨‹0 åœ¨ä¿®æ”¹aåï¼Œå…¶ä»–æŸäº›çº¿ç¨‹è¿˜æ˜¯getåˆ°çš„æ˜¯æ²¡æœ‰ä¿®æ”¹å‰çš„å€¼ï¼Œå°±ä¼šæš´éœ²é—®é¢˜ã€‚



ä½†æ˜¯åœ¨æœ¬ä¾‹ä¸­ï¼Œ`a = a + 1`è¿™ç§ä¿®æ”¹æ“ä½œï¼ŒèŠ±è´¹çš„æ—¶é—´å¤ªçŸ­äº†ï¼ŒçŸ­åˆ°æˆ‘ä»¬æ— æ³•æƒ³è±¡ã€‚æ‰€ä»¥ï¼Œçº¿ç¨‹é—´è½®è¯¢æ‰§è¡Œæ—¶ï¼Œéƒ½èƒ½getåˆ°æœ€æ–°çš„aå€¼ã€‚æ‰€ä»¥ï¼Œæš´éœ²é—®é¢˜çš„æ¦‚ç‡å°±å˜å¾—å¾®ä¹å…¶å¾®ã€‚

#### 138 ä»£ç ç¨ä½œæ”¹åŠ¨ï¼Œå«é—®é¢˜æš´éœ²å‡ºæ¥

åªè¦å¼„æ˜ç™½é—®é¢˜æš´éœ²çš„åŸå› ï¼Œå«é—®é¢˜å‡ºç°è¿˜æ˜¯ä¸å›°éš¾çš„ã€‚

æƒ³è±¡æ•°æ®åº“çš„å†™å…¥æ“ä½œï¼Œä¸€èˆ¬éœ€è¦è€—è´¹æˆ‘ä»¬å¯ä»¥æ„ŸçŸ¥çš„æ—¶é—´ã€‚

ä¸ºäº†æ¨¡æ‹Ÿè¿™ä¸ªå†™å…¥åŠ¨ä½œï¼Œç®€åŒ–æœŸé—´ï¼Œæˆ‘ä»¬åªéœ€è¦å»¶é•¿ä¿®æ”¹å˜é‡`a`çš„æ—¶é—´ï¼Œé—®é¢˜å¾ˆå®¹æ˜“å°±ä¼šè¿˜åŸå‡ºæ¥ã€‚

```python
import threading
import time


a = 0
def add1():
    global a    
    tmp = a + 1
    time.sleep(0.2) # å»¶æ—¶0.2ç§’ï¼Œæ¨¡æ‹Ÿå†™å…¥æ‰€éœ€æ—¶é—´
    a = tmp
    print('%s  adds a to 1: %d'%(threading.current_thread().getName(),a))
    
threads = [threading.Thread(name='t%d'%(i,),target=add1) for i in range(10)]
[t.start() for t in threads]
```

é‡æ–°è¿è¡Œä»£ç ï¼Œåªéœ€ä¸€æ¬¡ï¼Œé—®é¢˜ç«‹é©¬å®Œå…¨æš´éœ²ï¼Œç»“æœå¦‚ä¸‹ï¼š

```python
t0  adds a to 1: 1
t1  adds a to 1: 1
t2  adds a to 1: 1
t3  adds a to 1: 1
t4  adds a to 1: 1
t5  adds a to 1: 1
t7  adds a to 1: 1
t6  adds a to 1: 1
t8  adds a to 1: 1
t9  adds a to 1: 1
```

çœ‹åˆ°ï¼Œ10ä¸ªçº¿ç¨‹å…¨éƒ¨è¿è¡Œåï¼Œ`a`çš„å€¼åªç›¸å½“äºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„ç»“æœã€‚

ä¸‹é¢åˆ†æï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸Šé¢çš„ç»“æœï¼š

è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰è¯´æœåŠ›çš„ä¾‹å­ï¼Œå› ä¸ºåœ¨ä¿®æ”¹aå‰ï¼Œæœ‰0.2ç§’çš„ä¼‘çœ æ—¶é—´ï¼ŒæŸä¸ªçº¿ç¨‹å»¶æ—¶åï¼ŒCPUç«‹å³åˆ†é…è®¡ç®—èµ„æºç»™å…¶ä»–çº¿ç¨‹ã€‚ç›´åˆ°åˆ†é…ç»™æ‰€æœ‰çº¿ç¨‹åï¼Œæ ¹æ®ç»“æœåæ˜ å‡ºï¼Œ0.2ç§’çš„ä¼‘çœ æ—¶é•¿è¿˜æ²¡è€—å°½ï¼Œè¿™æ ·æ¯ä¸ªçº¿ç¨‹getåˆ°çš„aå€¼éƒ½æ˜¯0ï¼Œæ‰€ä»¥æ‰å‡ºç°ä¸Šé¢çš„ç»“æœã€‚



ä»¥ä¸Šæœ€æ ¸å¿ƒçš„ä¸‰è¡Œä»£ç ï¼š

```python
tmp = a + 1
time.sleep(0.2) # å»¶æ—¶0.2ç§’ï¼Œæ¨¡æ‹Ÿå†™å…¥æ‰€éœ€æ—¶é—´
a = tmp
```

#### 139 åŠ ä¸Šä¸€æŠŠé”ï¼Œé¿å…ä»¥ä¸Šæƒ…å†µå‡ºç°

çŸ¥é“é—®é¢˜å‡ºç°çš„åŸå› åï¼Œè¦æƒ³ä¿®å¤é—®é¢˜ï¼Œä¹Ÿæ²¡é‚£ä¹ˆå¤æ‚ã€‚

é€šè¿‡pythonä¸­æä¾›çš„é”æœºåˆ¶ï¼ŒæŸæ®µä»£ç åªèƒ½å•çº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œä¸Šé”ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°é‡Šæ”¾é”åï¼Œå…¶ä»–çº¿ç¨‹å†äº‰é”ï¼Œæ‰§è¡Œä»£ç ï¼Œé‡Šæ”¾é”ï¼Œé‡å¤ä»¥ä¸Šã€‚

åˆ›å»ºä¸€æŠŠé”`locka`:

```python
import threading
import time


locka = threading.Lock()
```

é€šè¿‡ `locka.acquire()` è·å¾—é”ï¼Œé€šè¿‡`locka.release()`é‡Šæ”¾é”ï¼Œå®ƒä»¬ä¹‹é—´çš„è¿™äº›ä»£ç ï¼Œåªèƒ½å•çº¿ç¨‹æ‰§è¡Œã€‚

```python
a = 0
def add1():
    global a    
    try:
        locka.acquire() # è·å¾—é”
        tmp = a + 1
        time.sleep(0.2) # å»¶æ—¶0.2ç§’ï¼Œæ¨¡æ‹Ÿå†™å…¥æ‰€éœ€æ—¶é—´
        a = tmp
    finally:
        locka.release() # é‡Šæ”¾é”
    print('%s  adds a to 1: %d'%(threading.current_thread().getName(),a))
    
threads = [threading.Thread(name='t%d'%(i,),target=add1) for i in range(10)]
[t.start() for t in threads]
```

æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š

```python
t0  adds a to 1: 1
t1  adds a to 1: 2
t2  adds a to 1: 3
t3  adds a to 1: 4
t4  adds a to 1: 5
t5  adds a to 1: 6
t6  adds a to 1: 7
t7  adds a to 1: 8
t8  adds a to 1: 9
t9  adds a to 1: 10
```

ä¸€èµ·æ­£å¸¸ï¼Œå…¶å®è¿™å·²ç»æ˜¯å•çº¿ç¨‹é¡ºåºæ‰§è¡Œäº†ï¼Œå°±æœ¬ä¾‹å­è€Œè¨€ï¼Œå·²ç»å¤±å»å¤šçº¿ç¨‹çš„ä»·å€¼ï¼Œå¹¶ä¸”è¿˜å¸¦æ¥äº†å› ä¸ºçº¿ç¨‹åˆ›å»ºå¼€é”€ï¼Œæµªè´¹æ—¶é—´çš„å‰¯ä½œç”¨ã€‚

ç¨‹åºä¸­åªæœ‰ä¸€æŠŠé”ï¼Œé€šè¿‡ `try...finally`è¿˜èƒ½ç¡®ä¿ä¸å‘ç”Ÿæ­»é”ã€‚ä½†æ˜¯ï¼Œå½“ç¨‹åºä¸­å¯ç”¨å¤šæŠŠé”ï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“å‘ç”Ÿæ­»é”ã€‚

æ³¨æ„ä½¿ç”¨åœºåˆï¼Œé¿å…æ­»é”ï¼Œæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨å¤šçº¿ç¨‹å¼€å‘æ—¶éœ€è¦æ³¨æ„çš„ä¸€äº›é—®é¢˜ã€‚

#### 140 1 åˆ†é’ŸæŒæ¡ time æ¨¡å—

time æ¨¡å—æä¾›æ—¶é—´ç›¸å…³çš„ç±»å’Œå‡½æ•°

è®°ä½ä¸€ä¸ªç±»ï¼š`struct_time`ï¼Œ9 ä¸ªæ•´æ•°ç»„æˆçš„å…ƒç»„

è®°ä½ä¸‹é¢ 5 ä¸ªæœ€å¸¸ç”¨å‡½æ•°

é¦–å…ˆå¯¼å…¥`time`æ¨¡å—

```python
import time
```

**1 æ­¤æ—¶æ­¤åˆ»æ—¶é—´æµ®ç‚¹æ•°**

```python
In [58]: seconds = time.time()
In [60]: seconds
Out[60]: 1582341559.0950701
```

**2 æ—¶é—´æ•°ç»„**

```python
In [61]: local_time = time.localtime(seconds)

In [62]: local_time
Out[62]: time.struct_time(tm_year=2020, tm_mon=2, tm_mday=22, tm_hour=11, tm_min=19, tm_sec=19, tm_wday=5, tm_yday=53, tm_isdst=0)
```

**3 æ—¶é—´å­—ç¬¦ä¸²**

`time.asctime` è¯­ä¹‰ï¼š `as convert time`

```python
In [63]: str_time = time.asctime(local_time)

In [64]: str_time
Out[64]: 'Sat Feb 22 11:19:19 2020'
```

**4 æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²**

`time.strftime` è¯­ä¹‰ï¼š `string format time`

```python
In [65]: format_time = time.strftime('%Y-%m-%d %H:%M:%S',local_time)

In [66]: format_time
Out[66]: '2020-02-22 11:19:19'
```

**5 å­—ç¬¦æ—¶é—´è½¬æ—¶é—´æ•°ç»„**

```python
In [68]: str_to_struct = time.strptime(format_time,'%Y-%m-%d %H:%M:%S')

In [69]: str_to_struct
Out[69]: time.struct_time(tm_year=2020, tm_mon=2, tm_mday=22, tm_hour=11, tm_min=19, tm_sec=19, tm_wday=5, tm_yday=53, tm_isdst=-1)
```

æœ€åå†è®°ä½å¸¸ç”¨å­—ç¬¦ä¸²æ ¼å¼

**å¸¸ç”¨å­—ç¬¦ä¸²æ ¼å¼**

%mï¼šæœˆ

%M: åˆ†é’Ÿ

```markdown
    %Y  Year with century as a decimal number.
    %m  Month as a decimal number [01,12].
    %d  Day of the month as a decimal number [01,31].
    %H  Hour (24-hour clock) as a decimal number [00,23].
    %M  Minute as a decimal number [00,59].
    %S  Second as a decimal number [00,61].
    %z  Time zone offset from UTC.
    %a  Locale's abbreviated weekday name.
    %A  Locale's full weekday name.
    %b  Locale's abbreviated month name.
```

#### 141 4G å†…å­˜å¤„ç† 10G å¤§å°çš„æ–‡ä»¶

4G å†…å­˜å¤„ç† 10G å¤§å°çš„æ–‡ä»¶ï¼Œå•æœºæ€ä¹ˆåšï¼Ÿ

ä¸‹é¢çš„è®¨è®ºåŸºäºçš„å‡å®šï¼šå¯ä»¥å•ç‹¬å¤„ç†ä¸€è¡Œæ•°æ®ï¼Œè¡Œé—´æ•°æ®ç›¸å…³æ€§ä¸ºé›¶ã€‚

æ–¹æ³•ä¸€ï¼š

ä»…ä½¿ç”¨ Python å†…ç½®æ¨¡æ¿ï¼Œé€è¡Œè¯»å–åˆ°å†…å­˜ã€‚

ä½¿ç”¨ yieldï¼Œå¥½å¤„æ˜¯è§£è€¦è¯»å–æ“ä½œå’Œå¤„ç†æ“ä½œï¼š

```python
def python_read(filename):
    with open(filename,'r',encoding='utf-8') as f:
        while True:
            line = f.readline()
            if not line:
                return
            yield line
```

ä»¥ä¸Šæ¯æ¬¡è¯»å–ä¸€è¡Œï¼Œé€è¡Œè¿­ä»£ï¼Œé€è¡Œå¤„ç†æ•°æ®

```python
if __name__ == '__main__':
    g = python_read('./data/movies.dat')
    for c in g:
        print(c)
        # process c
```

æ–¹æ³•äºŒï¼š

æ–¹æ³•ä¸€æœ‰ç¼ºç‚¹ï¼Œé€è¡Œè¯»å…¥ï¼Œé¢‘ç¹çš„ IO æ“ä½œæ‹–ç´¯å¤„ç†æ•ˆç‡ã€‚æ˜¯å¦æœ‰ä¸€æ¬¡ IO ï¼Œè¯»å–å¤šè¡Œçš„æ–¹æ³•ï¼Ÿ

`pandas` åŒ… `read_csv` å‡½æ•°ï¼Œå‚æ•°æœ‰ 38 ä¸ªä¹‹å¤šï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚

å…³äºå•æœºå¤„ç†å¤§æ–‡ä»¶ï¼Œ`read_csv` çš„ `chunksize` å‚æ•°èƒ½åšåˆ°ï¼Œè®¾ç½®ä¸º `5`ï¼Œ æ„å‘³ç€ä¸€æ¬¡è¯»å– 5 è¡Œã€‚

```python
def pandas_read(filename,sep=',',chunksize=5):
    reader = pd.read_csv(filename,sep,chunksize=chunksize)
    while True:
        try:
            yield reader.get_chunk()
        except StopIteration:
            print('---Done---')
            break
```

ä½¿ç”¨å¦‚åŒæ–¹æ³•ä¸€ï¼š
```python
if __name__ == '__main__':
    g = pandas_read('./data/movies.dat',sep="::")
    for c in g:
        print(c)
        # process c
```

ä»¥ä¸Šå°±æ˜¯å•æœºå¤„ç†å¤§æ–‡ä»¶çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæ¨èä½¿ç”¨æ–¹æ³•äºŒï¼Œæ›´åŠ çµæ´»ã€‚é™¤äº†å·¥ä½œä¸­ä¼šç”¨åˆ°ï¼Œé¢è¯•ä¸­ä¹Ÿæœ‰æ—¶è¢«é—®åˆ°ã€‚

### å››ã€Pythonä¸‰å¤§åˆ©å™¨

Pythonä¸­çš„ä¸‰å¤§åˆ©å™¨åŒ…æ‹¬ï¼š`è¿­ä»£å™¨`ï¼Œ`ç”Ÿæˆå™¨`ï¼Œ`è£…é¥°å™¨`ï¼Œåˆ©ç”¨å¥½å®ƒä»¬æ‰èƒ½å¼€å‘å‡ºæœ€é«˜æ€§èƒ½çš„Pythonç¨‹åºï¼Œæ¶‰åŠåˆ°çš„å†…ç½®æ¨¡å— `itertools`æä¾›è¿­ä»£å™¨ç›¸å…³çš„æ“ä½œã€‚æ­¤éƒ¨åˆ†æ”¶å½•æœ‰æ„æ€çš„ä¾‹å­å…±è®¡`15`ä¾‹ã€‚


#### 142 å¯»æ‰¾ç¬¬næ¬¡å‡ºç°ä½ç½®

```python
def search_n(s, c, n):
    size = 0
    for i, x in enumerate(s):
        if x == c:
            size += 1
        if size == n:
            return i
    return -1



print(search_n("fdasadfadf", "a", 3))# ç»“æœä¸º7ï¼Œæ­£ç¡®
print(search_n("fdasadfadf", "a", 30))# ç»“æœä¸º-1ï¼Œæ­£ç¡®
```


#### 143 æ–æ³¢é‚£å¥‘æ•°åˆ—å‰né¡¹

```python
def fibonacci(n):
    a, b = 1, 1
    for _ in range(n):
        yield a
        a, b = b, a + b


list(fibonacci(5))  # [1, 1, 2, 3, 5]
```

#### 144 æ‰¾å‡ºæ‰€æœ‰é‡å¤å…ƒç´ 

```python
from collections import Counter


def find_all_duplicates(lst):
    c = Counter(lst)
    return list(filter(lambda k: c[k] > 1, c))


find_all_duplicates([1, 2, 2, 3, 3, 3])  # [2,3]
```

#### 145 è”åˆç»Ÿè®¡æ¬¡æ•°
Counterå¯¹è±¡é—´å¯ä»¥åšæ•°å­¦è¿ç®—

```python
from collections import Counter
a = ['apple', 'orange', 'computer', 'orange']
b = ['computer', 'orange']

ca = Counter(a)
cb = Counter(b)
#Counterå¯¹è±¡é—´å¯ä»¥åšæ•°å­¦è¿ç®—
ca + cb  # Counter({'orange': 3, 'computer': 2, 'apple': 1})


# è¿›ä¸€æ­¥æŠ½è±¡ï¼Œå®ç°å¤šä¸ªåˆ—è¡¨å†…å…ƒç´ çš„ä¸ªæ•°ç»Ÿè®¡


def sumc(*c):
    if (len(c) < 1):
        return
    mapc = map(Counter, c)
    s = Counter([])
    for ic in mapc: # ic æ˜¯ä¸€ä¸ªCounterå¯¹è±¡
        s += ic
    return s


#Counter({'orange': 3, 'computer': 3, 'apple': 1, 'abc': 1, 'face': 1})
sumc(a, b, ['abc'], ['face', 'computer'])

```

#### 146 groupbyå•å­—æ®µåˆ†ç»„

å¤©æ°”è®°å½•ï¼š

```python
a = [{'date': '2019-12-15', 'weather': 'cloud'},
 {'date': '2019-12-13', 'weather': 'sunny'},
 {'date': '2019-12-14', 'weather': 'cloud'}]
```

æŒ‰ç…§å¤©æ°”å­—æ®µ`weather`åˆ†ç»„æ±‡æ€»ï¼š

```python
from itertools import groupby
for k, items in  groupby(a,key=lambda x:x['weather']):
     print(k)
```

è¾“å‡ºç»“æœçœ‹å‡ºï¼Œåˆ†ç»„å¤±è´¥ï¼åŸå› ï¼šåˆ†ç»„å‰å¿…é¡»æŒ‰ç…§åˆ†ç»„å­—æ®µ`æ’åº`ï¼Œè¿™ä¸ªå¾ˆå‘~

```python
cloud
sunny
cloud
```

ä¿®æ”¹ä»£ç ï¼š

```python
a.sort(key=lambda x: x['weather'])
for k, items in  groupby(a,key=lambda x:x['weather']):
     print(k)
     for i in items:
         print(i)
```

è¾“å‡ºç»“æœï¼š

```python
cloud
{'date': '2019-12-15', 'weather': 'cloud'}
{'date': '2019-12-14', 'weather': 'cloud'}
sunny
{'date': '2019-12-13', 'weather': 'sunny'}
```

#### 147 itemgetterå’Œkeyå‡½æ•°

æ³¨æ„åˆ°`sort`å’Œ`groupby`æ‰€ç”¨çš„`key`å‡½æ•°ï¼Œé™¤äº†`lambda`å†™æ³•å¤–ï¼Œè¿˜æœ‰ä¸€ç§ç®€å†™ï¼Œå°±æ˜¯ä½¿ç”¨`itemgetter`ï¼š

```python
a = [{'date': '2019-12-15', 'weather': 'cloud'},
 {'date': '2019-12-13', 'weather': 'sunny'},
 {'date': '2019-12-14', 'weather': 'cloud'}]
from operator import itemgetter
from itertools import groupby

a.sort(key=itemgetter('weather'))
for k, items in groupby(a, key=itemgetter('weather')):
     print(k)
     for i in items:
         print(i)
```

ç»“æœï¼š

```python
cloud
{'date': '2019-12-15', 'weather': 'cloud'}
{'date': '2019-12-14', 'weather': 'cloud'}
sunny
{'date': '2019-12-13', 'weather': 'sunny'}
```

#### 148 groupbyå¤šå­—æ®µåˆ†ç»„

`itemgetter`æ˜¯ä¸€ä¸ªç±»ï¼Œ`itemgetter('weather')`è¿”å›ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œå®ƒçš„å‚æ•°å¯æœ‰å¤šä¸ªï¼š

```python
from operator import itemgetter
from itertools import groupby

a.sort(key=itemgetter('weather', 'date'))
for k, items in groupby(a, key=itemgetter('weather')):
     print(k)
     for i in items:
         print(i)
```

ç»“æœå¦‚ä¸‹ï¼Œä½¿ç”¨`weather`å’Œ`date`ä¸¤ä¸ªå­—æ®µæ’åº`a`ï¼Œ

```python
cloud
{'date': '2019-12-14', 'weather': 'cloud'}
{'date': '2019-12-15', 'weather': 'cloud'}
sunny
{'date': '2019-12-13', 'weather': 'sunny'}
```

æ³¨æ„è¿™ä¸ªç»“æœä¸ä¸Šé¢ç»“æœæœ‰äº›å¾®å¦™ä¸åŒï¼Œè¿™ä¸ªæ›´å¤šæ˜¯æˆ‘ä»¬æƒ³çœ‹åˆ°å’Œä½¿ç”¨æ›´å¤šçš„ã€‚

#### 149 sumå‡½æ•°è®¡ç®—å’ŒèšåˆåŒæ—¶åš

Pythonä¸­çš„èšåˆç±»å‡½æ•°`sum`,`min`,`max`ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯`iterable`ç±»å‹ï¼Œä¸€èˆ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```python
a = [4,2,5,1]
sum([i+1 for i in a]) # 16
```

ä½¿ç”¨åˆ—è¡¨ç”Ÿæˆå¼`[i+1 for i in a]`åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸`a`ä¸€è¡Œçš„ä¸´æ—¶åˆ—è¡¨ï¼Œè¿™æ­¥å®Œæˆåï¼Œå†åš`sum`èšåˆã€‚

è¯•æƒ³å¦‚æœä½ çš„æ•°ç»„`a`é•¿åº¦åç™¾ä¸‡çº§ï¼Œå†åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„ä¸´æ—¶åˆ—è¡¨å°±å¾ˆä¸åˆ’ç®—ï¼Œæœ€å¥½æ˜¯ä¸€è¾¹ç®—ä¸€è¾¹èšåˆï¼Œç¨æ”¹åŠ¨ä¸ºå¦‚ä¸‹ï¼š

```python
a = [4,2,5,1]
sum(i+1 for i in a) # 16
```

æ­¤æ—¶`i+1 for i in a`æ˜¯`(i+1 for i in a)`çš„ç®€å†™ï¼Œå¾—åˆ°ä¸€ä¸ªç”Ÿæˆå™¨(`generator`)å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
In [8]:(i+1 for i in a)
OUT [8]:<generator object <genexpr> at 0x000002AC7FFA8CF0>
```

ç”Ÿæˆå™¨æ¯è¿­ä»£ä¸€æ­¥åå‡º(`yield`)ä¸€ä¸ªå…ƒç´ å¹¶è®¡ç®—å’Œèšåˆåï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œç›´åˆ°ç»ˆç‚¹ã€‚

#### 150 liståˆ†ç»„(ç”Ÿæˆå™¨ç‰ˆ)

```python
from math import ceil

def divide_iter(lst, n):
    if n <= 0:
        yield lst
        return
    i, div = 0, ceil(len(lst) / n)
    while i < n:
        yield lst[i * div: (i + 1) * div]
        i += 1

list(divide_iter([1, 2, 3, 4, 5], 0))  # [[1, 2, 3, 4, 5]]
list(divide_iter([1, 2, 3, 4, 5], 2))  # [[1, 2, 3], [4, 5]]
```

#### 151 åˆ—è¡¨å…¨å±•å¼€ï¼ˆç”Ÿæˆå™¨ç‰ˆï¼‰
```python
#å¤šå±‚åˆ—è¡¨å±•å¼€æˆå•å±‚åˆ—è¡¨
a=[1,2,[3,4,[5,6],7],8,["python",6],9]
def function(lst):
    for i in lst:
        if type(i)==list:
            yield from function(i)
        else:
            yield i
print(list(function(a))) # [1, 2, 3, 4, 5, 6, 7, 8, 'python', 6, 9]
```

#### 152 æµ‹è¯•å‡½æ•°è¿è¡Œæ—¶é—´çš„è£…é¥°å™¨
```python
#æµ‹è¯•å‡½æ•°æ‰§è¡Œæ—¶é—´çš„è£…é¥°å™¨ç¤ºä¾‹
import time
def timing_func(fn):
    def wrapper():
        start=time.time()
        fn()   #æ‰§è¡Œä¼ å…¥çš„fnå‚æ•°
        stop=time.time()
        return (stop-start)
    return wrapper
@timing_func
def test_list_append():
    lst=[]
    for i in range(0,100000):
        lst.append(i)  
@timing_func
def test_list_compre():
    [i for i in range(0,100000)]  #åˆ—è¡¨ç”Ÿæˆå¼
a=test_list_append()
c=test_list_compre()
print("test list append time:",a)
print("test list comprehension time:",c)
print("append/compre:",round(a/c,3))

test list append time: 0.0219423770904541
test list comprehension time: 0.007980823516845703
append/compre: 2.749
```

#### 153 ç»Ÿè®¡å¼‚å¸¸å‡ºç°æ¬¡æ•°å’Œæ—¶é—´çš„è£…é¥°å™¨


å†™ä¸€ä¸ªè£…é¥°å™¨ï¼Œç»Ÿè®¡æŸä¸ªå¼‚å¸¸é‡å¤å‡ºç°æŒ‡å®šæ¬¡æ•°æ—¶ï¼Œç»å†çš„æ—¶é•¿ã€‚
```python
import time
import math


def excepter(f):
    i = 0
    t1 = time.time()
    def wrapper(): 
        try:
            f()
        except Exception as e:
            nonlocal i
            i += 1
            print(f'{e.args[0]}: {i}')
            t2 = time.time()
            if i == n:
                print(f'spending time:{round(t2-t1,2)}')
    return wrapper

```

å…³é”®è¯`nonlocal`å¸¸ç”¨äºå‡½æ•°åµŒå¥—ä¸­ï¼Œå£°æ˜å˜é‡iä¸ºéå±€éƒ¨å˜é‡ï¼›

å¦‚æœä¸å£°æ˜ï¼Œ`i+=1`è¡¨æ˜`i`ä¸ºå‡½æ•°`wrapper`å†…çš„å±€éƒ¨å˜é‡ï¼Œå› ä¸ºåœ¨`i+=1`å¼•ç”¨(reference)æ—¶,`i`æœªè¢«å£°æ˜ï¼Œæ‰€ä»¥ä¼šæŠ¥`unreferenced variable`çš„é”™è¯¯ã€‚

ä½¿ç”¨åˆ›å»ºçš„è£…é¥°å‡½æ•°`excepter`, `n`æ˜¯å¼‚å¸¸å‡ºç°çš„æ¬¡æ•°ã€‚

å…±æµ‹è¯•äº†ä¸¤ç±»å¸¸è§çš„å¼‚å¸¸ï¼š`è¢«é›¶é™¤`å’Œ`æ•°ç»„è¶Šç•Œ`ã€‚

```python
n = 10 # except count

@excepter
def divide_zero_except():
    time.sleep(0.1)
    j = 1/(40-20*2)

# test zero divived except
for _ in range(n):
    divide_zero_except()


@excepter
def outof_range_except():
    a = [1,3,5]
    time.sleep(0.1)
    print(a[3])
# test out of range except
for _ in range(n):
    outof_range_except()

```

æ‰“å°å‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š
```python
division by zero: 1
division by zero: 2
division by zero: 3
division by zero: 4
division by zero: 5
division by zero: 6
division by zero: 7
division by zero: 8
division by zero: 9
division by zero: 10
spending time:1.01
list index out of range: 1
list index out of range: 2
list index out of range: 3
list index out of range: 4
list index out of range: 5
list index out of range: 6
list index out of range: 7
list index out of range: 8
list index out of range: 9
list index out of range: 10
spending time:1.01
```


#### 154 æµ‹è¯•è¿è¡Œæ—¶é•¿çš„è£…é¥°å™¨


```python
#æµ‹è¯•å‡½æ•°æ‰§è¡Œæ—¶é—´çš„è£…é¥°å™¨ç¤ºä¾‹
import time
def timing(fn):
    def wrapper():
        start=time.time()
        fn()   #æ‰§è¡Œä¼ å…¥çš„fnå‚æ•°
        stop=time.time()
        return (stop-start)
    return wrapper

@timing
def test_list_append():
    lst=[]
    for i in range(0,100000):
        lst.append(i)  

@timing
def test_list_compre():
    [i for i in range(0,100000)]  #åˆ—è¡¨ç”Ÿæˆå¼

a=test_list_append()
c=test_list_compre()
print("test list append time:",a)
print("test list comprehension time:",c)
print("append/compre:",round(a/c,3))

# test list append time: 0.0219
# test list comprehension time: 0.00798
# append/compre: 2.749
```

#### 155 è£…é¥°å™¨é€šä¿—ç†è§£

å†çœ‹ä¸€ä¸ªè£…é¥°å™¨ï¼š

```python
def call_print(f):
  def g():
    print('you\'re calling %s function'%(f.__name__,))
  return g
```

ä½¿ç”¨`call_print`è£…é¥°å™¨ï¼š

```python
@call_print
def myfun():
  pass
 
@call_print
def myfun2():
  pass
```

myfun()åè¿”å›ï¼š

```python
In [27]: myfun()
you're calling myfun function

In [28]: myfun2()
you're calling myfun2 function
```

**ä½¿ç”¨call_print**

ä½ çœ‹ï¼Œ`@call_print`æ”¾ç½®åœ¨ä»»ä½•ä¸€ä¸ªæ–°å®šä¹‰çš„å‡½æ•°ä¸Šé¢ï¼Œéƒ½ä¼šé»˜è®¤è¾“å‡ºä¸€è¡Œï¼Œä½ æ­£åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„åã€‚

è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ³¨æ„è§‚å¯Ÿæ–°å®šä¹‰çš„`call_print`å‡½æ•°(åŠ ä¸Š@åä¾¿æ˜¯è£…é¥°å™¨):

```python
def call_print(f):
  def g():
    print('you\'re calling %s function'%(f.__name__,))
  return g
```

å®ƒå¿…é¡»æ¥å—ä¸€ä¸ªå‡½æ•°`f`ï¼Œç„¶åè¿”å›å¦å¤–ä¸€ä¸ªå‡½æ•°`g`.

**è£…é¥°å™¨æœ¬è´¨**

æœ¬è´¨ä¸Šï¼Œå®ƒä¸ä¸‹é¢çš„è°ƒç”¨æ–¹å¼æ•ˆæœæ˜¯ç­‰æ•ˆçš„ï¼š

```
def myfun():
  pass

def myfun2():
  pass
  
def call_print(f):
  def g():
    print('you\'re calling %s function'%(f.__name__,))
  return g
```

ä¸‹é¢æ˜¯æœ€é‡è¦çš„ä»£ç ï¼š

```
myfun = call_print(myfun)
myfun2 = call_print(myfun2)
```

å¤§å®¶çœ‹æ˜ç™½å—ï¼Ÿä¹Ÿå°±æ˜¯call_print(myfun)åä¸æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°å—ï¼Œç„¶åå†èµ‹å€¼ç»™myfun.

å†æ¬¡è°ƒç”¨myfun, myfun2æ—¶ï¼Œæ•ˆæœæ˜¯è¿™æ ·çš„ï¼š

```python
In [32]: myfun()
you're calling myfun function

In [33]: myfun2()
you're calling myfun2 function
```

ä½ çœ‹ï¼Œè¿™ä¸è£…é¥°å™¨çš„å®ç°æ•ˆæœæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚è£…é¥°å™¨çš„å†™æ³•å¯èƒ½æ›´åŠ ç›´è§‚äº›ï¼Œæ‰€ä»¥ä¸ç”¨æ˜¾ç¤ºçš„è¿™æ ·èµ‹å€¼ï¼š`myfun = call_print(myfun)`ï¼Œ`myfun2 = call_print(myfun2)`ï¼Œä½†æ˜¯è£…é¥°å™¨çš„è¿™ç§å°è£…ï¼ŒçŒ›ä¸€çœ‹ï¼Œæœ‰äº›ä¸å¥½ç†è§£ã€‚

#### 156 å®šåˆ¶é€’å‡è¿­ä»£å™¨

```python
#ç¼–å†™ä¸€ä¸ªè¿­ä»£å™¨ï¼Œé€šè¿‡å¾ªç¯è¯­å¥ï¼Œå®ç°å¯¹æŸä¸ªæ­£æ•´æ•°çš„ä¾æ¬¡é€’å‡1ï¼Œç›´åˆ°0.
class Descend(Iterator):
    def __init__(self,N):
        self.N=N
        self.a=0
    def __iter__(self):
        return self 
    def __next__(self):
        while self.a<self.N:
            self.N-=1
            return self.N
        raise StopIteration
    
descend_iter=Descend(10)
print(list(descend_iter))
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
```

æ ¸å¿ƒè¦ç‚¹ï¼š

1 `__nex__ `åå­—ä¸èƒ½å˜ï¼Œå®ç°å®šåˆ¶çš„è¿­ä»£é€»è¾‘

2 `raise StopIteration`ï¼šé€šè¿‡ raise ä¸­æ–­ç¨‹åºï¼Œå¿…é¡»è¿™æ ·å†™



### äº”ã€Pythonç»˜å›¾

Pythonå¸¸ç”¨çš„ç»˜å›¾å·¥å…·åŒ…æ‹¬ï¼š`matplotlib`, `seaborn`, `plotly`ç­‰ï¼Œä»¥åŠä¸€äº›å…¶ä»–ä¸“ç”¨äºç»˜åˆ¶æŸç±»å›¾å¦‚è¯äº‘å›¾ç­‰çš„åŒ…ï¼Œæç»˜ç»˜å›¾è½¨è¿¹çš„`turtle`åŒ…ç­‰ã€‚æœ¬ç« èŠ‚å°†ä¼šä½¿ç”¨ä¸€äº›ä¾‹å­ç”±æ˜“åˆ°éš¾çš„é˜è¿°ç»˜å›¾çš„ç»å…¸å°ä¾‹å­ï¼Œç›®å‰å…±æ”¶å½•`27`ä¸ªã€‚

#### 157 turtleç»˜åˆ¶å¥¥è¿äº”ç¯å›¾

turtleç»˜å›¾çš„å‡½æ•°éå¸¸å¥½ç”¨ï¼ŒåŸºæœ¬çœ‹åˆ°å‡½æ•°åå­—ï¼Œå°±èƒ½çŸ¥é“å®ƒçš„å«ä¹‰ï¼Œä¸‹é¢ä½¿ç”¨turtleï¼Œä»…ç”¨15è¡Œä»£ç æ¥ç»˜åˆ¶å¥¥è¿äº”ç¯å›¾ã€‚

1 å¯¼å…¥åº“

```python
import turtle as p
```

2 å®šä¹‰ç”»åœ†å‡½æ•°

```python
def drawCircle(x,y,c='red'):
    p.pu()# æŠ¬èµ·ç”»ç¬”
    p.goto(x,y) # ç»˜åˆ¶åœ†çš„èµ·å§‹ä½ç½®
    p.pd()# æ”¾ä¸‹ç”»ç¬”
    p.color(c)# ç»˜åˆ¶cè‰²åœ†ç¯
    p.circle(30,360) #ç»˜åˆ¶åœ†ï¼šåŠå¾„ï¼Œè§’åº¦
```

3 ç”»ç¬”åŸºæœ¬è®¾ç½®

```python
p = turtle
p.pensize(3) # ç”»ç¬”å°ºå¯¸è®¾ç½®3
```

4 ç»˜åˆ¶äº”ç¯å›¾

è°ƒç”¨ç”»åœ†å‡½æ•°

```python
drawCircle(0,0,'blue')
drawCircle(60,0,'black')
drawCircle(120,0,'red')
drawCircle(90,-30,'green')
drawCircle(30,-30,'yellow')    

p.done()
```

ç»“æœï¼š

![](./img/turtle1.png)

#### 158 turtleç»˜åˆ¶æ¼«å¤©é›ªèŠ±


å¯¼å…¥æ¨¡å—

å¯¼å…¥ `turtle`åº“å’Œ pythonçš„ `random`

```python
import turtle as p
import random
```

ç»˜åˆ¶é›ªèŠ±

```python
def snow(snow_count):
    p.hideturtle()
    p.speed(500)
    p.pensize(2)
    for i in range(snow_count):
        r = random.random()
        g = random.random()
        b = random.random()
        p.pencolor(r, g, b)
        p.pu()
        p.goto(random.randint(-350, 350), random.randint(1, 270))
        p.pd()
        dens = random.randint(8, 12)
        snowsize = random.randint(10, 14)
        for _ in range(dens):
            p.forward(snowsize)  # å‘å½“å‰ç”»ç¬”æ–¹å‘ç§»åŠ¨snowsizeåƒç´ é•¿åº¦
            p.backward(snowsize)  # å‘å½“å‰ç”»ç¬”ç›¸åæ–¹å‘ç§»åŠ¨snowsizeåƒç´ é•¿åº¦
            p.right(360 / dens)  # é¡ºæ—¶é’ˆç§»åŠ¨360 / densåº¦

```

ç»˜åˆ¶åœ°é¢

```python
def ground(ground_line_count):
    p.hideturtle()
    p.speed(500)
    for i in range(ground_line_count):
        p.pensize(random.randint(5, 10))
        x = random.randint(-400, 350)
        y = random.randint(-280, -1)
        r = -y / 280
        g = -y / 280
        b = -y / 280
        p.pencolor(r, g, b)
        p.penup()  # æŠ¬èµ·ç”»ç¬”
        p.goto(x, y)  # è®©ç”»ç¬”ç§»åŠ¨åˆ°æ­¤ä½ç½®
        p.pendown()  # æ”¾ä¸‹ç”»ç¬”
        p.forward(random.randint(40, 100))  # çœ¼å½“å‰ç”»ç¬”æ–¹å‘å‘å‰ç§»åŠ¨40~100è·ç¦»
```

ä¸»å‡½æ•°

```python
def main():
    p.setup(800, 600, 0, 0)
    # p.tracer(False)
    p.bgcolor("black")
    snow(30)
    ground(30)
    # p.tracer(True)
    p.mainloop()

main()
```


åŠ¨æ€å›¾ç»“æœå±•ç¤ºï¼š

<img src="./img/turtlesnow.gif" alt="Sample"  width="50%">

#### 159 wordcloudè¯äº‘å›¾


```python
import hashlib
import pandas as pd
from wordcloud import WordCloud
geo_data=pd.read_excel(r"../data/geo_data.xlsx")
print(geo_data)
# 0     æ·±åœ³
# 1     æ·±åœ³
# 2     æ·±åœ³
# 3     æ·±åœ³
# 4     æ·±åœ³
# 5     æ·±åœ³
# 6     æ·±åœ³
# 7     å¹¿å·
# 8     å¹¿å·
# 9     å¹¿å·

words = ','.join(x for x in geo_data['city'] if x != []) #ç­›é€‰å‡ºéç©ºåˆ—è¡¨å€¼
wc = WordCloud(
    background_color="green", #èƒŒæ™¯é¢œè‰²"green"ç»¿è‰²
    max_words=100, #æ˜¾ç¤ºæœ€å¤§è¯æ•°
    font_path='./fonts/simhei.ttf', #æ˜¾ç¤ºä¸­æ–‡
    min_font_size=5,
    max_font_size=100,
    width=500  #å›¾å¹…å®½åº¦
    )
x = wc.generate(words)
x.to_file('../data/geo_data.png')
```

![](./data/geo_data.png)



#### 160 plotlyç”»æŸ±çŠ¶å›¾å’ŒæŠ˜çº¿å›¾



```python
#æŸ±çŠ¶å›¾+æŠ˜çº¿å›¾
import plotly.graph_objects as go
fig = go.Figure()
fig.add_trace(
    go.Scatter(
        x=[0, 1, 2, 3, 4, 5],
        y=[1.5, 1, 1.3, 0.7, 0.8, 0.9]
    ))
fig.add_trace(
    go.Bar(
        x=[0, 1, 2, 3, 4, 5],
        y=[2, 0.5, 0.7, -1.2, 0.3, 0.4]
    ))
fig.show()
```

<img src="img/image-20200416001202816.png" width=50%/>


#### 161 seabornçƒ­åŠ›å›¾

```python
# å¯¼å…¥åº“
import seaborn as sns
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# ç”Ÿæˆæ•°æ®é›†
data = np.random.random((6,6))
np.fill_diagonal(data,np.ones(6))
features = ["prop1","prop2","prop3","prop4","prop5", "prop6"]
data = pd.DataFrame(data, index = features, columns=features)
print(data)
# ç»˜åˆ¶çƒ­åŠ›å›¾
heatmap_plot = sns.heatmap(data, center=0, cmap='gist_rainbow')
plt.show()
```

<img src="./img/heatmap.png" width="50%" />

#### 162 matplotlibæŠ˜çº¿å›¾

æ¨¡å—åç§°ï¼šexample_utils.pyï¼Œé‡Œé¢åŒ…æ‹¬ä¸‰ä¸ªå‡½æ•°ï¼Œå„è‡ªåŠŸèƒ½å¦‚ä¸‹ï¼š

```python
import matplotlib.pyplot as plt

# åˆ›å»ºç”»å›¾figå’Œaxes
def setup_axes():
    fig, axes = plt.subplots(ncols=3, figsize=(6.5,3))
    for ax in fig.axes:
        ax.set(xticks=[], yticks=[])
    fig.subplots_adjust(wspace=0, left=0, right=0.93)
    return fig, axes
# å›¾ç‰‡æ ‡é¢˜
def title(fig, text, y=0.9):
    fig.suptitle(text, size=14, y=y, weight='semibold', x=0.98, ha='right',
                 bbox=dict(boxstyle='round', fc='floralwhite', ec='#8B7E66',
                           lw=2))
# ä¸ºæ•°æ®æ·»åŠ æ–‡æœ¬æ³¨é‡Š
def label(ax, text, y=0):
    ax.annotate(text, xy=(0.5, 0.00), xycoords='axes fraction', ha='center',
                style='italic',
                bbox=dict(boxstyle='round', facecolor='floralwhite',
                          ec='#8B7E66'))
```

<img src="./img/matplotlib1.png" width="60%"/>

```python
import numpy as np
import matplotlib.pyplot as plt

import example_utils

x = np.linspace(0, 10, 100)

fig, axes = example_utils.setup_axes()
for ax in axes:
    ax.margins(y=0.10)

# å­å›¾1 é»˜è®¤plotå¤šæ¡çº¿ï¼Œé¢œè‰²ç³»ç»Ÿåˆ†é…
for i in range(1, 6):
    axes[0].plot(x, i * x)

# å­å›¾2 å±•ç¤ºçº¿çš„ä¸åŒlinestyle
for i, ls in enumerate(['-', '--', ':', '-.']):
    axes[1].plot(x, np.cos(x) + i, linestyle=ls)

# å­å›¾3 å±•ç¤ºçº¿çš„ä¸åŒlinestyleå’Œmarker
for i, (ls, mk) in enumerate(zip(['', '-', ':'], ['o', '^', 's'])):
    axes[2].plot(x, np.cos(x) + i * x, linestyle=ls, marker=mk, markevery=10)

# è®¾ç½®æ ‡é¢˜
# example_utils.title(fig, '"ax.plot(x, y, ...)": Lines and/or markers', y=0.95)
# ä¿å­˜å›¾ç‰‡
fig.savefig('plot_example.png', facecolor='none')
# å±•ç¤ºå›¾ç‰‡
plt.show()
```

#### 163 matplotlibæ•£ç‚¹å›¾
<img src="./img/1578811129148.png" width="60%"/>

å¯¹åº”ä»£ç ï¼š

```python
"""
æ•£ç‚¹å›¾çš„åŸºæœ¬ç”¨æ³•
"""
import numpy as np
import matplotlib.pyplot as plt

import example_utils

# éšæœºç”Ÿæˆæ•°æ®
np.random.seed(1874)
x, y, z = np.random.normal(0, 1, (3, 100))
t = np.arctan2(y, x)
size = 50 * np.cos(2 * t)**2 + 10

fig, axes = example_utils.setup_axes()

# å­å›¾1
axes[0].scatter(x, y, marker='o',  color='darkblue', facecolor='white', s=80)
example_utils.label(axes[0], 'scatter(x, y)')

# å­å›¾2
axes[1].scatter(x, y, marker='s', color='darkblue', s=size)
example_utils.label(axes[1], 'scatter(x, y, s)')

# å­å›¾3
axes[2].scatter(x, y, s=size, c=z,  cmap='gist_ncar')
example_utils.label(axes[2], 'scatter(x, y, s, c)')

# example_utils.title(fig, '"ax.scatter(...)": Colored/scaled markers',
#                     y=0.95)
fig.savefig('scatter_example.png', facecolor='none')

plt.show()
```

#### 164 matplotlibæŸ±çŠ¶å›¾

<img src="./img/1578811155501.png" width="60%"/>

å¯¹åº”ä»£ç ï¼š

```python
import numpy as np
import matplotlib.pyplot as plt

import example_utils


def main():
    fig, axes = example_utils.setup_axes()

    basic_bar(axes[0])
    tornado(axes[1])
    general(axes[2])

    # example_utils.title(fig, '"ax.bar(...)": Plot rectangles')
    fig.savefig('bar_example.png', facecolor='none')
    plt.show()

# å­å›¾1
def basic_bar(ax):
    y = [1, 3, 4, 5.5, 3, 2]
    err = [0.2, 1, 2.5, 1, 1, 0.5]
    x = np.arange(len(y))
    ax.bar(x, y, yerr=err, color='lightblue', ecolor='black')
    ax.margins(0.05)
    ax.set_ylim(bottom=0)
    example_utils.label(ax, 'bar(x, y, yerr=e)')

# å­å›¾2
def tornado(ax):
    y = np.arange(8)
    x1 = y + np.random.random(8) + 1
    x2 = y + 3 * np.random.random(8) + 1
    ax.barh(y, x1, color='lightblue')
    ax.barh(y, -x2, color='salmon')
    ax.margins(0.15)
    example_utils.label(ax, 'barh(x, y)')

# å­å›¾3
def general(ax):
    num = 10
    left = np.random.randint(0, 10, num)
    bottom = np.random.randint(0, 10, num)
    width = np.random.random(num) + 0.5
    height = np.random.random(num) + 0.5
    ax.bar(left, height, width, bottom, color='salmon')
    ax.margins(0.15)
    example_utils.label(ax, 'bar(l, h, w, b)')


main()
```

#### 165 matplotlibç­‰é«˜çº¿å›¾

<img src="./img/1578811177737.png" width="60%"/>

å¯¹åº”ä»£ç ï¼š

```python
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.cbook import get_sample_data

import example_utils

z = np.load(get_sample_data('bivariate_normal.npy'))

fig, axes = example_utils.setup_axes()

axes[0].contour(z, cmap='gist_earth')
example_utils.label(axes[0], 'contour')

axes[1].contourf(z, cmap='gist_earth')
example_utils.label(axes[1], 'contourf')

axes[2].contourf(z, cmap='gist_earth')
cont = axes[2].contour(z, colors='black')
axes[2].clabel(cont, fontsize=6)
example_utils.label(axes[2], 'contourf + contour\n + clabel')

# example_utils.title(fig, '"contour, contourf, clabel": Contour/label 2D data',
#                     y=0.96)
fig.savefig('contour_example.png', facecolor='none')

plt.show()
```

#### 166 imshowå›¾

<img src="./img/1578811404145.png" width="60%"/>

å¯¹åº”ä»£ç ï¼š

```python
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.cbook import get_sample_data
from mpl_toolkits import axes_grid1

import example_utils


def main():
    fig, axes = setup_axes()
    plot(axes, *load_data())
    # example_utils.title(fig, '"ax.imshow(data, ...)": Colormapped or RGB arrays')
    fig.savefig('imshow_example.png', facecolor='none')
    plt.show()


def plot(axes, img_data, scalar_data, ny):

    # é»˜è®¤çº¿æ€§æ’å€¼
    axes[0].imshow(scalar_data, cmap='gist_earth', extent=[0, ny, ny, 0])

    # æœ€è¿‘é‚»æ’å€¼
    axes[1].imshow(scalar_data, cmap='gist_earth', interpolation='nearest',
                   extent=[0, ny, ny, 0])

    # å±•ç¤ºRGB/RGBAæ•°æ®
    axes[2].imshow(img_data)


def load_data():
    img_data = plt.imread(get_sample_data('5.png'))
    ny, nx, nbands = img_data.shape
    scalar_data = np.load(get_sample_data('bivariate_normal.npy'))
    return img_data, scalar_data, ny


def setup_axes():
    fig = plt.figure(figsize=(6, 3))
    axes = axes_grid1.ImageGrid(fig, [0, 0, .93, 1], (1, 3), axes_pad=0)

    for ax in axes:
        ax.set(xticks=[], yticks=[])
    return fig, axes


main()
```

#### 167 pyechartsç»˜åˆ¶ä»ªè¡¨ç›˜

ä½¿ç”¨pip install pyecharts å®‰è£…ï¼Œç‰ˆæœ¬ä¸º v1.6ï¼Œpyechartsç»˜åˆ¶ä»ªè¡¨ç›˜ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼š

```python
from pyecharts import charts

# ä»ªè¡¨ç›˜
gauge = charts.Gauge()
gauge.add('Pythonå°ä¾‹å­', [('Pythonæœºå™¨å­¦ä¹ ', 30), ('PythonåŸºç¡€', 70.),
                        ('Pythonæ­£åˆ™', 90)])
gauge.render(path="./data/ä»ªè¡¨ç›˜.html")
print('ok')
```

ä»ªè¡¨ç›˜ä¸­å…±å±•ç¤ºä¸‰é¡¹ï¼Œæ¯é¡¹çš„æ¯”ä¾‹ä¸º30%,70%,90%ï¼Œå¦‚ä¸‹å›¾é»˜è®¤åç§°æ˜¾ç¤ºç¬¬ä¸€é¡¹ï¼šPythonæœºå™¨å­¦ä¹ ï¼Œå®Œæˆæ¯”ä¾‹ä¸º30%

<img src="./img/image-20191228194635902.png" width="40%"/>

#### 168 pyechartsæ¼æ–—å›¾

```python
from pyecharts import options as opts
from pyecharts.charts import Funnel, Page
from random import randint

def funnel_base() -> Funnel:
  c = (
    Funnel()
    .add("è±ªè½¦", [list(z) for z in zip(['å®é©¬', 'æ³•æ‹‰åˆ©', 'å¥”é©°', 'å¥¥è¿ª', 'å¤§ä¼—', 'ä¸°ç”°', 'ç‰¹æ–¯æ‹‰'],
                 [randint(1, 20) for _ in range(7)])])
    .set_global_opts(title_opts=opts.TitleOpts(title="è±ªè½¦æ¼æ–—å›¾"))
  )
  return c
funnel_base().render('./img/car_fnnel.html')
```

ä»¥7ç§è½¦å‹åŠæŸä¸ªå±æ€§å€¼ç»˜åˆ¶çš„æ¼æ–—å›¾ï¼Œå±æ€§å€¼å¤§è¶Šé è¿‘æ¼æ–—çš„å¤§ç«¯ã€‚

<img src="./img/1578811483265.png" width="50%"/>

#### 169 pyechartsæ—¥å†å›¾

```python
import datetime
import random
from pyecharts import options as opts
from pyecharts.charts import Calendar

def calendar_interval_1() -> Calendar:
    begin = datetime.date(2019, 1, 1)
    end = datetime.date(2019, 12, 27)
    data = [
        [str(begin + datetime.timedelta(days=i)), random.randint(1000, 25000)]
        for i in range(0, (end - begin).days + 1, 2)  # éš”å¤©ç»Ÿè®¡
    ]
    calendar = (
      Calendar(init_opts=opts.InitOpts(width="1200px")).add(
            "", data, calendar_opts=opts.CalendarOpts(range_="2019"))
        .set_global_opts(
            title_opts=opts.TitleOpts(title="Calendar-2019å¹´æ­¥æ•°ç»Ÿè®¡"),
            visualmap_opts=opts.VisualMapOpts(
                max_=25000,
                min_=1000,
                orient="horizontal",
                is_piecewise=True,
                pos_top="230px",
                pos_left="100px",
            ),
        )
    )
    return calendar

calendar_interval_1().render('./img/calendar.html')
```

ç»˜åˆ¶2019å¹´1æœˆ1æ—¥åˆ°12æœˆ27æ—¥çš„æ­¥è¡Œæ•°ï¼Œå®˜æ–¹ç»™å‡ºçš„å›¾å½¢å®½åº¦`900px`ä¸å¤Ÿï¼Œåªèƒ½æ˜¾ç¤ºåˆ°9æœˆä»½ï¼Œæœ¬ä¾‹ä½¿ç”¨`opts.InitOpts(width="1200px")`åšå‡ºå¾®è°ƒï¼Œå¹¶ä¸”`visualmap`æ˜¾ç¤ºæ‰€æœ‰æ­¥æ•°ï¼Œæ¯éš”ä¸€å¤©æ˜¾ç¤ºä¸€æ¬¡ï¼š

<img src="./img/1578811543851.png" width="50%"/>

#### 170 pyechartsç»˜åˆ¶graphå›¾

```python
import json
import os
from pyecharts import options as opts
from pyecharts.charts import Graph, Page

def graph_base() -> Graph:
    nodes = [
        {"name": "cus1", "symbolSize": 10},
        {"name": "cus2", "symbolSize": 30},
        {"name": "cus3", "symbolSize": 20}
    ]
    links = []
    for i in nodes:
        if i.get('name') == 'cus1':
            continue
        for j in nodes:
            if j.get('name') == 'cus1':
                continue
            links.append({"source": i.get("name"), "target": j.get("name")})
    c = (
        Graph()
        .add("", nodes, links, repulsion=8000)
        .set_global_opts(title_opts=opts.TitleOpts(title="customer-influence"))
    )
    return c
```

æ„å»ºå›¾ï¼Œå…¶ä¸­å®¢æˆ·ç‚¹1ä¸å…¶ä»–ä¸¤ä¸ªå®¢æˆ·éƒ½æ²¡æœ‰å…³ç³»(`link`)ï¼Œä¹Ÿå°±æ˜¯ä¸å­˜åœ¨æœ‰æ•ˆè¾¹ï¼š

<img src="./img/1578811569529.png" width="50%"/>

#### 171 pyechartsæ°´çƒå›¾

```python
from pyecharts import options as opts
from pyecharts.charts import Liquid, Page
from pyecharts.globals import SymbolType

def liquid() -> Liquid:
    c = (
        Liquid()
        .add("lq", [0.67, 0.30, 0.15])
        .set_global_opts(title_opts=opts.TitleOpts(title="Liquid"))
    )
    return c

liquid().render('./img/liquid.html')
```

æ°´çƒå›¾çš„å–å€¼`[0.67, 0.30, 0.15]`è¡¨ç¤ºä¸‹å›¾ä¸­çš„`ä¸‰ä¸ªæ³¢æµªçº¿`ï¼Œä¸€èˆ¬ä»£è¡¨ä¸‰ä¸ªç™¾åˆ†æ¯”:

<img src="./img/liquid.gif" width="50%"/>

#### 172 pyechartsé¥¼å›¾

```python
from pyecharts import options as opts
from pyecharts.charts import Pie
from random import randint

def pie_base() -> Pie:
    c = (
        Pie()
        .add("", [list(z) for z in zip(['å®é©¬', 'æ³•æ‹‰åˆ©', 'å¥”é©°', 'å¥¥è¿ª', 'å¤§ä¼—', 'ä¸°ç”°', 'ç‰¹æ–¯æ‹‰'],
                                       [randint(1, 20) for _ in range(7)])])
        .set_global_opts(title_opts=opts.TitleOpts(title="Pie-åŸºæœ¬ç¤ºä¾‹"))
        .set_series_opts(label_opts=opts.LabelOpts(formatter="{b}: {c}"))
    )
    return c

pie_base().render('./img/pie_pyecharts.html')
```
<img src="./img/20191229105841.png" width="50%"/>


#### 173 pyechartsæåæ ‡å›¾

```python
import random
from pyecharts import options as opts
from pyecharts.charts import Page, Polar

def polar_scatter0() -> Polar:
    data = [(alpha, random.randint(1, 100)) for alpha in range(101)] # r = random.randint(1, 100)
    print(data)
    c = (
        Polar()
        .add("", data, type_="bar", label_opts=opts.LabelOpts(is_show=False))
        .set_global_opts(title_opts=opts.TitleOpts(title="Polar"))
    )
    return c

polar_scatter0().render('./img/polar.html')
```

æåæ ‡è¡¨ç¤ºä¸º`(å¤¹è§’,åŠå¾„)`ï¼Œå¦‚(6,94)è¡¨ç¤ºå¤¹è§’ä¸º6ï¼ŒåŠå¾„94çš„ç‚¹ï¼š

<img src="./img/1578811648010.png" width="50%"/>

#### 174 pyechartsè¯äº‘å›¾

```python
from pyecharts import options as opts
from pyecharts.charts import Page, WordCloud
from pyecharts.globals import SymbolType

words = [
    ("Python", 100),
    ("C++", 80),
    ("Java", 95),
    ("R", 50),
    ("JavaScript", 79),
    ("C", 65)
]

def wordcloud() -> WordCloud:
    c = (
        WordCloud()
        # word_size_range: å•è¯å­—ä½“å¤§å°èŒƒå›´
        .add("", words, word_size_range=[20, 100], shape='cardioid')
        .set_global_opts(title_opts=opts.TitleOpts(title="WordCloud"))
    )
    return c

wordcloud().render('./img/wordcloud.html')
```

`("C",65)`è¡¨ç¤ºåœ¨æœ¬æ¬¡ç»Ÿè®¡ä¸­Cè¯­è¨€å‡ºç°65æ¬¡

<img src="./img/1578811675413.png" width="50%"/>

#### 175 pyechartsç³»åˆ—æŸ±çŠ¶å›¾

```python
from pyecharts import options as opts
from pyecharts.charts import Bar
from random import randint

def bar_series() -> Bar:
    c = (
        Bar()
        .add_xaxis(['å®é©¬', 'æ³•æ‹‰åˆ©', 'å¥”é©°', 'å¥¥è¿ª', 'å¤§ä¼—', 'ä¸°ç”°', 'ç‰¹æ–¯æ‹‰'])
        .add_yaxis("é”€é‡", [randint(1, 20) for _ in range(7)])
        .add_yaxis("äº§é‡", [randint(1, 20) for _ in range(7)])
        .set_global_opts(title_opts=opts.TitleOpts(title="Barçš„ä¸»æ ‡é¢˜", subtitle="Barçš„å‰¯æ ‡é¢˜"))
    )
    return c

bar_series().render('./img/bar_series.html')
```

<img src="./img/1578811781930.png" width="50%"/>

#### 176 pyechartsçƒ­åŠ›å›¾

```python
import random
from pyecharts import options as opts
from pyecharts.charts import HeatMap

def heatmap_car() -> HeatMap:
    x = ['å®é©¬', 'æ³•æ‹‰åˆ©', 'å¥”é©°', 'å¥¥è¿ª', 'å¤§ä¼—', 'ä¸°ç”°', 'ç‰¹æ–¯æ‹‰']
    y = ['ä¸­å›½','æ—¥æœ¬','å—é','æ¾³å¤§åˆ©äºš','é˜¿æ ¹å»·','é˜¿å°”åŠåˆ©äºš','æ³•å›½','æ„å¤§åˆ©','åŠ æ‹¿å¤§']
    value = [[i, j, random.randint(0, 100)]
             for i in range(len(x)) for j in range(len(y))]
    c = (
        HeatMap()
        .add_xaxis(x)
        .add_yaxis("é”€é‡", y, value)
        .set_global_opts(
            title_opts=opts.TitleOpts(title="HeatMap"),
            visualmap_opts=opts.VisualMapOpts(),
        )
    )
    return c

heatmap_car().render('./img/heatmap_pyecharts.html')
```

çƒ­åŠ›å›¾æè¿°çš„å®é™…æ˜¯ä¸‰ç»´å…³ç³»ï¼Œxè½´è¡¨ç¤ºè½¦å‹ï¼Œyè½´è¡¨ç¤ºå›½å®¶ï¼Œæ¯ä¸ªè‰²å—çš„é¢œè‰²å€¼ä»£è¡¨é”€é‡ï¼Œé¢œè‰²åˆ»åº¦å°ºæ˜¾ç¤ºåœ¨å·¦ä¸‹è§’ï¼Œé¢œè‰²è¶Šçº¢è¡¨ç¤ºé”€é‡è¶Šå¤§ã€‚

<img src="./img/image-20191229101724665.png" width="50%"/>



#### 178 matplotlibç»˜åˆ¶åŠ¨ç”»

`matplotlib`æ˜¯pythonä¸­æœ€ç»å…¸çš„ç»˜å›¾åŒ…ï¼Œé‡Œé¢`animation`æ¨¡å—èƒ½ç»˜åˆ¶åŠ¨ç”»ã€‚

é¦–å…ˆå¯¼å…¥å°ä¾‹å­ä½¿ç”¨çš„æ¨¡å—ï¼š
```python
from matplotlib import pyplot as plt
from matplotlib import animation
from random import randint, random
```

ç”Ÿæˆæ•°æ®ï¼Œ`frames_count`æ˜¯å¸§çš„ä¸ªæ•°ï¼Œ`data_count`æ¯ä¸ªå¸§çš„æŸ±å­ä¸ªæ•°

```python
class Data:
    data_count = 32
    frames_count = 2

    def __init__(self, value):
        self.value = value
        self.color = (0.5, random(), random()) #rgb

    # é€ æ•°æ®
    @classmethod
    def create(cls):
        return [[Data(randint(1, cls.data_count)) for _ in range(cls.data_count)]
                for frame_i in range(cls.frames_count)]
```

ç»˜åˆ¶åŠ¨ç”»ï¼š`animation.FuncAnimation`å‡½æ•°çš„å›è°ƒå‡½æ•°çš„å‚æ•°`fi`è¡¨ç¤ºç¬¬å‡ å¸§ï¼Œæ³¨æ„è¦è°ƒç”¨`axs.cla()`æ¸…é™¤ä¸Šä¸€å¸§ã€‚

```python
def draw_chart():
    fig = plt.figure(1, figsize=(16, 9))
    axs = fig.add_subplot(111)
    axs.set_xticks([])
    axs.set_yticks([])

    # ç”Ÿæˆæ•°æ®
    frames = Data.create()

    def animate(fi):
        axs.cla()  # clear last frame
        axs.set_xticks([])
        axs.set_yticks([])
        return axs.bar(list(range(Data.data_count)),        # X
                       [d.value for d in frames[fi]],       # Y
                       1,                                   # width
                       color=[d.color for d in frames[fi]]  # color
                       )
    # åŠ¨ç”»å±•ç¤º
    anim = animation.FuncAnimation(fig, animate, frames=len(frames))
    plt.show()


draw_chart()
```

#### 179 pyechartsç»˜å›¾å±æ€§è®¾ç½®æ–¹æ³•

æ˜¨å¤©ä¸€ä½è¯»è€…æœ‹å‹é—®æˆ‘`pyecharts`ä¸­ï¼Œyè½´å¦‚ä½•æ˜¾ç¤ºåœ¨å³ä¾§ã€‚å…ˆè¯´ä¸‹å¦‚ä½•è®¾ç½®ï¼ŒåŒæ—¶é˜è¿°ä¾‹å­å›æ˜¯å¦‚ä½•æ‰¾åˆ°æ‰¾åˆ°æ­¤å±æ€§çš„ã€‚

è¿™æ˜¯pyechartsä¸­ä¸€èˆ¬çš„ç»˜å›¾æ­¥éª¤ï¼š
```python
from pyecharts.faker import Faker
from pyecharts import options as opts
from pyecharts.charts import Bar
from pyecharts.commons.utils import JsCode

def bar_base() -> Bar:
    c = (
        Bar()
        .add_xaxis(Faker.choose())
        .add_yaxis("å•†å®¶A", Faker.values())
        .set_global_opts(title_opts=opts.TitleOpts(title="Bar-åŸºæœ¬ç¤ºä¾‹", subtitle="æˆ‘æ˜¯å‰¯æ ‡é¢˜"))
    )
    return c

bar_base().render('./bar.html')
```
é‚£ä¹ˆï¼Œå¦‚ä½•è®¾ç½®yè½´æ˜¾ç¤ºåœ¨å³ä¾§ï¼Œæ·»åŠ ä¸€è¡Œä»£ç ï¼š
```python
.set_global_opts(yaxis_opts=opts.AxisOpts(position='right'))
```
ä¹Ÿå°±æ˜¯ï¼š
```python
c = (
        Bar()
        .add_xaxis(Faker.choose())
        .add_yaxis("å•†å®¶A", Faker.values())
        .set_global_opts(title_opts=opts.TitleOpts(title="Bar-åŸºæœ¬ç¤ºä¾‹", subtitle="æˆ‘æ˜¯å‰¯æ ‡é¢˜"))
        .set_global_opts(yaxis_opts=opts.AxisOpts(position='right'))
    )
```

å¦‚ä½•é”å®šè¿™ä¸ªå±æ€§ï¼Œé¦–å…ˆåº”è¯¥åœ¨set_global_optså‡½æ•°çš„å‚æ•°ä¸­æ‰¾ï¼Œå®ƒä¸€å…±æœ‰ä»¥ä¸‹`11`ä¸ªè®¾ç½®å‚æ•°ï¼Œå®ƒä»¬ä½äºæ¨¡å—`charts.py`:
```python
title_opts: types.Title = opts.TitleOpts(),
legend_opts: types.Legend = opts.LegendOpts(),
tooltip_opts: types.Tooltip = None,
toolbox_opts: types.Toolbox = None,
brush_opts: types.Brush = None,
xaxis_opts: types.Axis = None,
yaxis_opts: types.Axis = None,
visualmap_opts: types.VisualMap = None,
datazoom_opts: types.DataZoom = None,
graphic_opts: types.Graphic = None,
axispointer_opts: types.AxisPointer = None,
```
å› ä¸ºæ˜¯è®¾ç½®yè½´æ˜¾ç¤ºåœ¨å³ä¾§ï¼Œè‡ªç„¶æƒ³åˆ°è®¾ç½®å‚æ•°`yaxis_opts`ï¼Œå› ä¸ºå…¶ç±»å‹ä¸º`types.Axis`ï¼Œæ‰€ä»¥å†è¿›å…¥`types.py`ï¼ŒåŒæ—¶å®šä½åˆ°`Axis`ï¼š
```python
Axis = Union[opts.AxisOpts, dict, None]
```
Unionæ˜¯pyechartsä¸­å¯å®¹çº³å¤šä¸ªç±»å‹çš„å¹¶é›†åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯Axiså¯èƒ½ä¸º`opts.AxisOpt`, `dict`, æˆ–`None`ä¸‰ç§ç±»å‹ã€‚æŸ¥çœ‹ç¬¬ä¸€ä¸ª`opts.AxisOpt`ç±»ï¼Œå®ƒå…±å®šä¹‰ä»¥ä¸‹`25`ä¸ªå‚æ•°ï¼š
```python
type_: Optional[str] = None,
name: Optional[str] = None,
is_show: bool = True,
is_scale: bool = False,
is_inverse: bool = False,
name_location: str = "end",
name_gap: Numeric = 15,
name_rotate: Optional[Numeric] = None,
interval: Optional[Numeric] = None,
grid_index: Numeric = 0,
position: Optional[str] = None,
offset: Numeric = 0,
split_number: Numeric = 5,
boundary_gap: Union[str, bool, None] = None,
min_: Union[Numeric, str, None] = None,
max_: Union[Numeric, str, None] = None,
min_interval: Numeric = 0,
max_interval: Optional[Numeric] = None,
axisline_opts: Union[AxisLineOpts, dict, None] = None,
axistick_opts: Union[AxisTickOpts, dict, None] = None,
axislabel_opts: Union[LabelOpts, dict, None] = None,
axispointer_opts: Union[AxisPointerOpts, dict, None] = None,
name_textstyle_opts: Union[TextStyleOpts, dict, None] = None,
splitarea_opts: Union[SplitAreaOpts, dict, None] = None,
splitline_opts: Union[SplitLineOpts, dict] = SplitLineOpts(),
```
è§‚å¯Ÿåå°è¯•å‚æ•°`position`ï¼Œç»“åˆå®˜æ¡£ï¼š`https://pyecharts.org/#/zh-cn/global_options?id=axisopts%ef%bc%9a%e5%9d%90%e6%a0%87%e8%bd%b4%e9%85%8d%e7%bd%ae%e9%a1%b9`ï¼Œä»‹ç»xè½´è®¾ç½®positionæ—¶æœ‰bottom, top, æ‰€ä»¥yè½´è®¾ç½®å¾ˆå¯èƒ½å°±æ˜¯left,right.

OKï¼

#### 180 pyechartsç»˜å›¾å±æ€§è®¾ç½®æ–¹æ³•(ä¸‹)

<img src="./img/pyecharts-bar.png" width="50%"/>

**åˆ†æ­¥è®²è§£å¦‚ä½•é…ç½®ä¸ºä¸Šå›¾**

1)æŸ±çŠ¶å›¾æ˜¾ç¤ºæ•ˆæœåŠ¨ç”»å¯¹åº”æ§åˆ¶ä»£ç ï¼š

```python
animation_opts=opts.AnimationOpts(
                    animation_delay=500, animation_easing="cubicOut"
                )
```
2)æŸ±çŠ¶å›¾æ˜¾ç¤ºä¸»é¢˜å¯¹åº”æ§åˆ¶ä»£ç ï¼š
```python
theme=ThemeType.MACARONS
```
3)æ·»åŠ xè½´å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
add_xaxis( ["è‰è“", "èŠ’æœ", "è‘¡è„", "é›ªæ¢¨", "è¥¿ç“œ", "æŸ æª¬", "è½¦å˜å­"]
```
4)æ·»åŠ yè½´å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
add_yaxis("A", Faker.values(),
```
5)ä¿®æ”¹æŸ±é—´è·å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
category_gap="50%"
```

6)Aç³»åˆ—æŸ±å­æ˜¯å¦æ˜¾ç¤ºå¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
is_selected=True
```

7)Aç³»åˆ—æŸ±å­é¢œè‰²æ¸å˜å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
itemstyle_opts={
            "normal": {
                "color": JsCode("""new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                    offset: 0,
                    color: 'rgba(0, 244, 255, 1)'
                }, {
                    offset: 1,
                    color: 'rgba(0, 77, 167, 1)'
                }], false)"""),
                "barBorderRadius": [6, 6, 6, 6],
                "shadowColor": 'rgb(0, 160, 221)',
            }}
```
8)Aç³»åˆ—æŸ±å­æœ€å¤§å’Œæœ€å°å€¼`æ ‡è®°ç‚¹`å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
markpoint_opts=opts.MarkPointOpts(
                data=[
                    opts.MarkPointItem(type_="max", name="æœ€å¤§å€¼"),
                    opts.MarkPointItem(type_="min", name="æœ€å°å€¼"),
                ]
            )
```
9)Aç³»åˆ—æŸ±å­æœ€å¤§å’Œæœ€å°å€¼`æ ‡è®°çº¿`å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
markline_opts=opts.MarkLineOpts(
                data=[
                    opts.MarkLineItem(type_="min", name="æœ€å°å€¼"),
                    opts.MarkLineItem(type_="max", name="æœ€å¤§å€¼")
                ]
            )
```
10)æŸ±çŠ¶å›¾æ ‡é¢˜å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
title_opts=opts.TitleOpts(title="Bar-å‚æ•°ä½¿ç”¨ä¾‹å­"
```
11)æŸ±çŠ¶å›¾éå¸¸æœ‰ç”¨çš„toolboxæ˜¾ç¤ºå¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
toolbox_opts=opts.ToolboxOpts()
```

12)Yè½´æ˜¾ç¤ºåœ¨å³ä¾§å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
yaxis_opts=opts.AxisOpts(position="right")
```
13)Yè½´åç§°å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
yaxis_opts=opts.AxisOpts(,name="Yè½´")
```
14)æ•°æ®è½´åŒºåŸŸæ”¾å¤§ç¼©å°è®¾ç½®å¯¹åº”çš„æ§åˆ¶ä»£ç ï¼š
```python
datazoom_opts=opts.DataZoomOpts()
```

**å®Œæ•´ä»£ç **

```python
def bar_border_radius():
    c = (
        Bar(init_opts=opts.InitOpts(
                animation_opts=opts.AnimationOpts(
                    animation_delay=500, animation_easing="cubicOut"
                ),
                theme=ThemeType.MACARONS))
        .add_xaxis( ["è‰è“", "èŠ’æœ", "è‘¡è„", "é›ªæ¢¨", "è¥¿ç“œ", "æŸ æª¬", "è½¦å˜å­"])
        .add_yaxis("A", Faker.values(),category_gap="50%",markpoint_opts=opts.MarkPointOpts(),is_selected=True)
        .set_series_opts(itemstyle_opts={
            "normal": {
                "color": JsCode("""new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                    offset: 0,
                    color: 'rgba(0, 244, 255, 1)'
                }, {
                    offset: 1,
                    color: 'rgba(0, 77, 167, 1)'
                }], false)"""),
                "barBorderRadius": [6, 6, 6, 6],
                "shadowColor": 'rgb(0, 160, 221)',
            }}, markpoint_opts=opts.MarkPointOpts(
                data=[
                    opts.MarkPointItem(type_="max", name="æœ€å¤§å€¼"),
                    opts.MarkPointItem(type_="min", name="æœ€å°å€¼"),
                ]
            ),markline_opts=opts.MarkLineOpts(
                data=[
                    opts.MarkLineItem(type_="min", name="æœ€å°å€¼"),
                    opts.MarkLineItem(type_="max", name="æœ€å¤§å€¼")
                ]
            ))
        .set_global_opts(title_opts=opts.TitleOpts(title="Bar-å‚æ•°ä½¿ç”¨ä¾‹å­"), toolbox_opts=opts.ToolboxOpts(),yaxis_opts=opts.AxisOpts(position="right",name="Yè½´"),datazoom_opts=opts.DataZoomOpts(),)
        
    )

    return c

bar_border_radius().render()
```

#### 181 pyechartsåŸæ¥å¯ä»¥è¿™æ ·å¿«é€Ÿå…¥é—¨(ä¸Š)

æœ€è¿‘ä¸¤å¤©ï¼Œç¿»çœ‹ä¸‹`pyecharts`çš„æºç ï¼Œæ„Ÿå¹è¿™ä¸ªæ¡†æ¶å†™çš„çœŸæ£’ï¼Œæ€è·¯æ¸…æ™°ï¼Œè®¾è®¡ç®€æ´ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œæ¨èè¯»è€…ä»¬æœ‰ç©ºä¹Ÿé˜…è¯»ä¸‹ã€‚

beeå›æ˜¯è¢«pyechartså®˜æ¡£ä»‹ç»-äº”ä¸ªç‰¹æ€§æ‰€å¸å¼•ï¼š

1)ç®€æ´çš„ API è®¾è®¡ï¼Œä½¿ç”¨å¦‚ä¸æ»‘èˆ¬æµç•…ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨;

2)å›Šæ‹¬äº† 30+ ç§å¸¸è§å›¾è¡¨ï¼Œåº”æœ‰å°½æœ‰;

3)æ”¯æŒä¸»æµ Notebook ç¯å¢ƒï¼ŒJupyter Notebook å’Œ JupyterLab;

4)å¯è½»æ¾é›†æˆè‡³ Flaskï¼ŒDjango ç­‰ä¸»æµ Web æ¡†æ¶;

5)é«˜åº¦çµæ´»çš„é…ç½®é¡¹ï¼Œå¯è½»æ¾æ­é…å‡ºç²¾ç¾çš„å›¾è¡¨

pyecharts ç¡®å®ä¹Ÿå¦‚ä¸Šé¢äº”ä¸ªç‰¹æ€§ä»‹ç»é‚£æ ·ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚é‚£ä¹ˆï¼Œæœ‰äº›è¯»è€…ä¸ç¦å¥½å¥‡ä¼šé—®ï¼Œpyecharts æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿ

æˆ‘ä»¬ä¸å¦¨ä»pyechartså®˜æ¡£`5åˆ†é’Ÿå…¥é—¨pyecharts`ç« èŠ‚å¼€å§‹ï¼Œç”±è¡¨(æœ€é«˜å±‚å‡½æ•°)åŠé‡Œ(åº•å±‚å‡½æ•°ä¹Ÿå°±æ˜¯æ‰€è°“çš„`æºç `)ï¼Œä¸€æ¢ç©¶ç«Ÿã€‚



**å®˜æ–¹ç¬¬ä¸€ä¸ªä¾‹å­**

ä¸å¦¨ä»å®˜æ¡£ç»™å‡ºçš„ç¬¬ä¸€ä¸ªä¾‹å­è¯´èµ·ï¼Œ

```python
from pyecharts.charts import Bar

bar = Bar()
bar.add_xaxis(["è¡¬è¡«", "ç¾Šæ¯›è¡«", "é›ªçººè¡«", "è£¤å­", "é«˜è·Ÿé‹", "è¢œå­"])
bar.add_yaxis("å•†å®¶A", [5, 20, 36, 10, 75, 90])
# render ä¼šç”Ÿæˆæœ¬åœ° HTML æ–‡ä»¶ï¼Œé»˜è®¤ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ render.html æ–‡ä»¶
# ä¹Ÿå¯ä»¥ä¼ å…¥è·¯å¾„å‚æ•°ï¼Œå¦‚ bar.render("mycharts.html")
bar.render()
```

ç¬¬ä¸€è¡Œä»£ç ï¼š`from pyecharts.charts import Bar`ï¼Œå…ˆä¸Šä¸€å¼ æºç ä¸­`åŒ…çš„ç»“æ„å›¾`ï¼š

![](./img/pyecharts1.jpg)

`bar.py`æ¨¡å—ä¸­å®šä¹‰äº†ç±»`Bar(RectChart)`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
class Bar(RectChart):
    """
    <<< Bar Chart >>>

    Bar chart presents categorical data with rectangular bars
    with heights or lengths proportional to the values that they represent.
    """
```



è¿™é‡Œæœ‰è¯»è€…å¯èƒ½ä¼šæœ‰ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š

1)ä¸ºä»€ä¹ˆæ ¹æ®å›¾1ä¸­çš„åŒ…ç»“æ„ï¼Œä¸ºä»€ä¹ˆä¸è¿™ä¹ˆå†™ï¼š`from pyecharts.charts.basic_charts import Bar`

![](./img/pyechart2.jpg)



ç­”ï¼šè¯·çœ‹å›¾2ä¸­`__init__.py`æ¨¡å—ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œçœ‹åˆ°å¯¼å…¥`charts`åŒ…ï¼Œè€Œé`charts.basic_charts`

```python
from pyecharts import charts, commons, components, datasets, options, render, scaffold
from pyecharts._version import __author__, __version__
```

2)`Bar(RectChart)`æ˜¯ä»€ä¹ˆæ„æ€

ç­”ï¼šRectChartæ˜¯Barçš„å­ç±»

ä¸‹é¢4è¡Œä»£ç ï¼Œå¾ˆå¥½ç†è§£ï¼Œæ²¡æœ‰ç‰¹æ®Šæ€§ã€‚

pyechartsä¸»è¦ä¸¤ä¸ªå¤§ç‰ˆæœ¬,0.5åŸºç‰ˆæœ¬å’Œ1.0åŸºç‰ˆæœ¬ï¼Œä»1.0åŸºç‰ˆæœ¬å¼€å§‹å…¨é¢æ”¯æŒ`é“¾å¼è°ƒç”¨`ï¼Œbeeå›ä¹Ÿå¾ˆå–œçˆ±è¿™ç§é“¾å¼è°ƒç”¨æ¨¡å¼ï¼Œä»£ç çœ‹èµ·æ¥æ›´åŠ ç´§å‡‘ï¼š

```python
from pyecharts.charts import Bar

bar = (
    Bar()
    .add_xaxis(["è¡¬è¡«", "ç¾Šæ¯›è¡«", "é›ªçººè¡«", "è£¤å­", "é«˜è·Ÿé‹", "è¢œå­"])
    .add_yaxis("å•†å®¶A", [5, 20, 36, 10, 75, 90])
)
bar.render()
```

å®ç°`é“¾å¼è°ƒç”¨`ä¹Ÿæ²¡æœ‰å¤šéš¾ï¼Œä¿è¯è¿”å›ç±»æœ¬èº«`self`å³å¯ï¼Œå¦‚æœéè¦æœ‰å…¶ä»–è¿”å›å¯¹è±¡ï¼Œé‚£ä¹ˆè¦æåˆ°ç±»å†…ä»¥ä¾¿è¢«å…¨å±€å…±äº«ï¼Œ

add_xaxiså‡½æ•°è¿”å›`self`

```python
    def add_xaxis(self, xaxis_data: Sequence):
        self.options["xAxis"][0].update(data=xaxis_data)
        self._xaxis_data = xaxis_data
        return self
```

add_yaxiså‡½æ•°åŒæ ·è¿”å›`self`.

#### 182 pyechartsåŸæ¥å¯ä»¥è¿™æ ·å¿«é€Ÿå…¥é—¨(ä¸­)

**ä¸€åˆ‡çš†options**

pyechartsç”¨èµ·æ¥å¾ˆçˆ½çš„å¦ä¸€ä¸ªé‡è¦åŸå› ï¼Œ`å‚æ•°é…ç½®é¡¹`å°è£…çš„éå¸¸niceï¼Œé€šè¿‡å®šä¹‰ä¸€äº›åˆ—åŸºç¡€çš„é…ç½®ç»„ä»¶ï¼Œæ¯”å¦‚`global_options.py`æ¨¡å—ä¸­å®šä¹‰çš„é…ç½®å¯¹è±¡æœ‰ä»¥ä¸‹`27`ä¸ª

```python
    AngleAxisItem,
    AngleAxisOpts,
    AnimationOpts,
    Axis3DOpts,
    AxisLineOpts,
    AxisOpts,
    AxisPointerOpts,
    AxisTickOpts,
    BrushOpts,
    CalendarOpts,
    DataZoomOpts,
    Grid3DOpts,
    GridOpts,
    InitOpts,
    LegendOpts,
    ParallelAxisOpts,
    ParallelOpts,
    PolarOpts,
    RadarIndicatorItem,
    RadiusAxisItem,
    RadiusAxisOpts,
    SingleAxisOpts,
    TitleOpts,
    ToolBoxFeatureOpts,
    ToolboxOpts,
    TooltipOpts,
    VisualMapOpts,
```

#### 183 pyechartsåŸæ¥å¯ä»¥è¿™æ ·å¿«é€Ÿå…¥é—¨(ä¸‹)

**ç¬¬äºŒä¸ªä¾‹å­**

äº†è§£ä¸Šé¢çš„é…ç½®å¯¹è±¡åï¼Œå†çœ‹å®˜æ¡£ç»™å‡ºçš„ç¬¬äºŒä¸ªä¾‹å­ï¼Œä¸ç¬¬ä¸€ä¸ªä¾‹å­ç›¸æ¯”ï¼Œå¢åŠ äº†ä¸€è¡Œä»£ç ï¼š`set_global_opts`å‡½æ•°

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

# V1 ç‰ˆæœ¬å¼€å§‹æ”¯æŒé“¾å¼è°ƒç”¨
# ä½ æ‰€çœ‹åˆ°çš„æ ¼å¼å…¶å®æ˜¯ `black` æ ¼å¼åŒ–ä»¥åçš„æ•ˆæœ
# å¯ä»¥æ‰§è¡Œ `pip install black` ä¸‹è½½ä½¿ç”¨
bar = (
    Bar()
    .add_xaxis(["è¡¬è¡«", "ç¾Šæ¯›è¡«", "é›ªçººè¡«", "è£¤å­", "é«˜è·Ÿé‹", "è¢œå­"])
    .add_yaxis("å•†å®¶A", [5, 20, 36, 10, 75, 90])
    .set_global_opts(title_opts=opts.TitleOpts(title="ä¸»æ ‡é¢˜", subtitle="å‰¯æ ‡é¢˜"))
    
bar.render()
```

`set_global_opts`å‡½æ•°åœ¨pyechartsä¸­è¢«é«˜é¢‘ä½¿ç”¨ï¼Œå®ƒå®šä¹‰åœ¨åº•å±‚åŸºç¡€æ¨¡å—`Chart.py`ä¸­ï¼Œå®ƒæ˜¯å‰é¢è¯´åˆ°çš„`RectChart`çš„å­ç±»ï¼Œ`Bar`ç±»çš„å­™å­ç±»ã€‚

æµè§ˆä¸‹å‡½æ•°çš„å‚æ•°ï¼š

```python
def set_global_opts(
        self,
        title_opts: types.Title = opts.TitleOpts(),
        legend_opts: types.Legend = opts.LegendOpts(),
        tooltip_opts: types.Tooltip = None,
        toolbox_opts: types.Toolbox = None,
        brush_opts: types.Brush = None,
        xaxis_opts: types.Axis = None,
        yaxis_opts: types.Axis = None,
        visualmap_opts: types.VisualMap = None,
        datazoom_opts: types.DataZoom = None,
        graphic_opts: types.Graphic = None,
        axispointer_opts: types.AxisPointer = None,
    ):
```

ä»¥ç¬¬äºŒä¸ªå‚æ•°`title_opts`ä¸ºä¾‹ï¼Œè¯´æ˜`pyecharts`ä¸­å‚æ•°èµ‹å€¼çš„é£æ ¼ã€‚

é¦–å…ˆï¼Œ`title_opts`æ˜¯`é»˜è®¤å‚æ•°`ï¼Œé»˜è®¤å€¼ä¸º`opts.TitleOpts()`ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡ï¼Œæ˜¯`global_options.py`æ¨¡å—ä¸­å®šä¹‰çš„`27`ä¸ªé…ç½®å¯¹è±¡ç§çš„ä¸€ä¸ªã€‚

å…¶æ¬¡ï¼Œpyechartsä¸­ä¸ºäº†å¢å¼ºä»£ç å¯è¯»æ€§ï¼Œå‚æ•°çš„ç±»å‹éƒ½æ˜¾ç¤ºçš„ç»™å‡ºã€‚æ­¤å¤„å®ƒçš„ç±»å‹ä¸ºï¼š`types.Title`. è¿™æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿå®ƒçš„ç±»å‹ä¸æ˜¯`TitleOpts`å—ï¼Ÿä¸æ€¥ï¼Œçœ‹çœ‹Titleè¿™ä¸ªç±»å‹çš„å®šä¹‰ï¼š

```python
Title = Union[opts.TitleOpts, dict]
```

åŸæ¥`Title`å¯èƒ½æ˜¯`opts.TitleOpts`, ä¹Ÿå¯èƒ½æ˜¯pythonåŸç”Ÿçš„`dict`. é€šè¿‡`Union`å®ç°çš„å°±æ˜¯è¿™ç§`ç±»å‹æ•ˆæœ`ã€‚æ‰€ä»¥è¿™å°±è§£é‡Šäº†å®˜æ¡£ä¸­ä¸ºä»€ä¹ˆè¯´ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸é…ç½®å‚æ•°çš„é—®é¢˜ï¼Œå¦‚ä¸‹å®˜æ¡£ï¼š

```python
  # æˆ–è€…ç›´æ¥ä½¿ç”¨å­—å…¸å‚æ•°
    # .set_global_opts(title_opts={"text": "ä¸»æ ‡é¢˜", "subtext": "å‰¯æ ‡é¢˜"})
)
```

æœ€åï¼ŒçœŸæ­£çš„å…³äºå›¾è¡¨çš„æ ‡é¢˜ç›¸å…³çš„å±æ€§éƒ½è¢«å°è£…åˆ°TitleOptsç±»ä¸­ï¼Œæ¯”å¦‚`title`,`subtitle`å±æ€§ï¼ŒæŸ¥çœ‹æºç ï¼ŒTitleOptså¯¹è±¡è¿˜æœ‰æ›´å¤šå±æ€§ï¼š

```python
class TitleOpts(BasicOpts):
    def __init__(
        self,
        title: Optional[str] = None,
        title_link: Optional[str] = None,
        title_target: Optional[str] = None,
        subtitle: Optional[str] = None,
        subtitle_link: Optional[str] = None,
        subtitle_target: Optional[str] = None,
        pos_left: Optional[str] = None,
        pos_right: Optional[str] = None,
        pos_top: Optional[str] = None,
        pos_bottom: Optional[str] = None,
        padding: Union[Sequence, Numeric] = 5,
        item_gap: Numeric = 10,
        title_textstyle_opts: Union[TextStyleOpts, dict, None] = None,
        subtitle_textstyle_opts: Union[TextStyleOpts, dict, None] = None,
    ):
```

OK. åˆ°æ­¤è·Ÿéš5åˆ†é’Ÿå…¥é—¨çš„å®˜æ¡£ï¼Œç»“åˆä¸¤ä¸ªä¾‹å­å®ç°çš„èƒŒåæºç ï¼Œæ¢è®¨äº†ï¼š

1)ä¸åŒ…ç»“æ„ç»„ç»‡ç›¸å…³çš„`__init__.py`ï¼›

2)ç±»çš„ç»§æ‰¿å…³ç³»:Bar->RectChart->Chartï¼›

3)é“¾å¼è°ƒç”¨ï¼›

4)é‡è¦çš„å‚æ•°é…ç½®åŒ…`options`ï¼Œä»¥TitleOptsç±»ä¸ºä¾‹ï¼Œ`set_global_opts`å°†å®ƒè£…è½½åˆ°Barç±»ä¸­å®ç°å±æ€§è‡ªå®šä¹‰ã€‚

#### 184 1 åˆ†é’Ÿå­¦ä¼šç”» pairplot å›¾

seaborn ç»˜å›¾åº“ï¼ŒåŸºäº matplotlib å¼€å‘ï¼Œæä¾›æ›´é«˜å±‚ç»˜å›¾æ¥å£ã€‚

å­¦ä¹ ä½¿ç”¨ seaborn ç»˜åˆ¶ `pairplot` å›¾

`pairplot` å›¾èƒ½ç›´è§‚çš„åæ˜ å‡ºä¸¤ä¸¤ç‰¹å¾é—´çš„å…³ç³»ï¼Œå¸®åŠ©æˆ‘ä»¬å¯¹æ•°æ®é›†å»ºç«‹åˆæ­¥å°è±¡ï¼Œæ›´å¥½çš„å®Œæˆåˆ†ç±»å’Œèšç±»ä»»åŠ¡ã€‚

ä½¿ç”¨ skearn å¯¼å…¥ç»å…¸çš„ Iris æ•°æ®é›†ï¼Œå…±æœ‰ 150 æ¡è®°å½•ï¼Œ4 ä¸ªç‰¹å¾ï¼Œtarget æœ‰ä¸‰ç§ä¸åŒå€¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

```markdown
     sepal_length  sepal_width  petal_length  petal_width    species
0             5.1          3.5           1.4          0.2     setosa
1             4.9          3.0           1.4          0.2     setosa
2             4.7          3.2           1.3          0.2     setosa
3             4.6          3.1           1.5          0.2     setosa
4             5.0          3.6           1.4          0.2     setosa
..            ...          ...           ...          ...        ...
145           6.7          3.0           5.2          2.3  virginica
146           6.3          2.5           5.0          1.9  virginica
147           6.5          3.0           5.2          2.0  virginica
148           6.2          3.4           5.4          2.3  virginica
149           5.9          3.0           5.1          1.8  virginica
```

ä½¿ç”¨ seaborn ç»˜åˆ¶ `sepal_length`, `petal_length` ä¸¤ä¸ªç‰¹å¾é—´çš„å…³ç³»çŸ©é˜µï¼š

```python
from sklearn.datasets import load_iris
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn import tree

sns.set(style="ticks")

df02 = df.iloc[:,[0,2,4]] # é€‰æ‹©ä¸€å¯¹ç‰¹å¾
sns.pairplot(df02)
plt.show()
```

<img src="./img/image-20200223165617790.png" width="40%"/>

è®¾ç½®é¢œè‰²å¤šæ˜¾ï¼š

```
sns.pairplot(df02, hue="species")
plt.show()
```

<img src="./img/image-20200223165649794.png" width="40%"/>

ç»˜åˆ¶æ‰€æœ‰ç‰¹å¾æ•£ç‚¹çŸ©é˜µï¼š

```
sns.pairplot(df, hue="species")
plt.show()
```

<img src="./img/image-20200223165718091.png" width="50%"/>

### å…­ã€ Python å‘ç‚¹å’Œå·¥å…·

#### 185 å«å•ä¸ªå…ƒç´ çš„å…ƒç»„

Pythonä¸­æœ‰äº›å‡½æ•°çš„å‚æ•°ç±»å‹ä¸ºå…ƒç»„ï¼Œå…¶å†…æœ‰1ä¸ªå…ƒç´ ï¼Œè¿™æ ·åˆ›å»ºæ˜¯é”™è¯¯çš„ï¼š

```python
c = (5) # NO!
```

å®ƒå®é™…åˆ›å»ºä¸€ä¸ªæ•´å‹å…ƒç´ 5ï¼Œå¿…é¡»è¦åœ¨å…ƒç´ ååŠ ä¸€ä¸ª`é€—å·`:

```python
c = (5,) # YES!
```

#### 186 é»˜è®¤å‚æ•°è®¾ä¸ºç©º

å«æœ‰é»˜è®¤å‚æ•°çš„å‡½æ•°ï¼Œå¦‚æœç±»å‹ä¸ºå®¹å™¨ï¼Œä¸”è®¾ç½®ä¸ºç©ºï¼š

```python
def f(a,b=[]):  # NO!
    print(b)
    return b

ret = f(1)
ret.append(1)
ret.append(2)
# å½“å†è°ƒç”¨f(1)æ—¶ï¼Œé¢„è®¡æ‰“å°ä¸º []
f(1)
# ä½†æ˜¯å´ä¸º [1,2]
```

è¿™æ˜¯å¯å˜ç±»å‹çš„é»˜è®¤å‚æ•°ä¹‹å‘ï¼Œè¯·åŠ¡å¿…è®¾ç½®æ­¤ç±»é»˜è®¤å‚æ•°ä¸ºNoneï¼š

```python
def f(a,b=None): # YES!
    pass
```

#### 187 å…±äº«å˜é‡æœªç»‘å®šä¹‹å‘

æœ‰æ—¶æƒ³è¦å¤šä¸ªå‡½æ•°å…±äº«ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä½†å´åœ¨æŸä¸ªå‡½æ•°å†…è¯•å›¾ä¿®æ”¹å®ƒä¸ºå±€éƒ¨å˜é‡ï¼š

```python
i = 1
def f():
    i+=1 #NO!
    
def g():
    print(i)
```

åº”è¯¥åœ¨få‡½æ•°å†…æ˜¾ç¤ºå£°æ˜`i`ä¸ºglobalå˜é‡ï¼š

```python
i = 1
def f():
    global i # YES!
    i+=1
```

#### 188 lambdaè‡ªç”±å‚æ•°ä¹‹å‘

æ’åºå’Œåˆ†ç»„çš„keyå‡½æ•°å¸¸ä½¿ç”¨lambdaï¼Œè¡¨è¾¾æ›´åŠ ç®€æ´ï¼Œä½†æ˜¯æœ‰ä¸ªå‘æ–°æ‰‹å®¹æ˜“æ‰è¿›å»ï¼š

```python
a = [lambda x: x+i for i in range(3)] # NO!
for f in a:
    print(f(1))
# ä½ å¯èƒ½æœŸæœ›è¾“å‡ºï¼š1,2,3
```

ä½†æ˜¯å®é™…å´è¾“å‡º: 3,3,3. å®šä¹‰lambdaä½¿ç”¨çš„`i`è¢«ç§°ä¸ºè‡ªç”±å‚æ•°ï¼Œå®ƒåªåœ¨è°ƒç”¨lambdaå‡½æ•°æ—¶ï¼Œå€¼æ‰è¢«çœŸæ­£ç¡®å®šä¸‹æ¥ï¼Œè¿™å°±çŠ¹å¦‚ä¸‹é¢æ‰“å°å‡º2ï¼Œä½ è‚¯å®šç¡®ä¿¡æ— ç–‘å§ã€‚

```python
a = 0
a = 1
a = 2
def f(a):
    print(a)
```

æ­£ç¡®åšæ³•æ˜¯è½¬åŒ–`è‡ªç”±å‚æ•°`ä¸ºlambdaå‡½æ•°çš„`é»˜è®¤å‚æ•°`ï¼š

```python
a = [lambda x,i=i: x+i for i in range(3)] # YES!
```

#### 189 å„ç§å‚æ•°ä½¿ç”¨ä¹‹å‘

Pythonå¼ºå¤§å¤šå˜ï¼ŒåŸå› ä¹‹ä¸€åœ¨äºå‡½æ•°å‚æ•°ç±»å‹çš„å¤šæ ·åŒ–ã€‚æ–¹ä¾¿çš„åŒæ—¶ï¼Œä¹Ÿä¸ºä½¿ç”¨è€…å¸¦æ¥æ›´å¤šçš„çº¦æŸè§„åˆ™ã€‚å¦‚æœä¸äº†è§£è¿™äº›è§„åˆ™ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹ä¸€äº›è¯­æ³•å¼‚å¸¸ï¼š

*(1) SyntaxError: positional argument follows keyword argument*


*(2) TypeError: f() missing 1 required keyword-only argument: 'b'*


*(3) SyntaxError: keyword argument repeated*

*(4) TypeError: f() missing 1 required positional argument: 'b'*

*(5) TypeError: f() got an unexpected keyword argument 'a'*

*(6) TypeError: f() takes 0 positional arguments but 1 was given*


æ€»ç»“ä¸»è¦çš„å‚æ•°ä½¿ç”¨è§„åˆ™

ä½ç½®å‚æ•°

`ä½ç½®å‚æ•°`çš„å®šä¹‰ï¼š`å‡½æ•°è°ƒç”¨`æ—¶æ ¹æ®å‡½æ•°å®šä¹‰çš„å‚æ•°ä½ï¼ˆå½¢å‚ï¼‰ç½®æ¥ä¼ é€’å‚æ•°ï¼Œæ˜¯æœ€å¸¸è§çš„å‚æ•°ç±»å‹ã€‚

```python
def f(a):
  return a

f(1) # ä½ç½®å‚æ•° 
```
ä½ç½®å‚æ•°ä¸èƒ½ç¼ºå°‘ï¼š
```python
def f(a,b):
  pass

f(1) # TypeError: f() missing 1 required positional argument: 'b'
```

**è§„åˆ™1ï¼šä½ç½®å‚æ•°å¿…é¡»ä¸€ä¸€å¯¹åº”ï¼Œç¼ºä¸€ä¸å¯**

å…³é”®å­—å‚æ•°

åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œé€šè¿‡â€˜é”®--å€¼â€™æ–¹å¼ä¸ºå‡½æ•°å½¢å‚ä¼ å€¼ï¼Œä¸ç”¨æŒ‰ç…§ä½ç½®ä¸ºå‡½æ•°å½¢å‚ä¼ å€¼ã€‚

```python
def f(a):
  print(f'a:{a}')
```
è¿™ä¹ˆè°ƒç”¨ï¼Œ`a`å°±æ˜¯å…³é”®å­—å‚æ•°ï¼š
```python
f(a=1)
```
ä½†æ˜¯ä¸‹é¢è°ƒç”¨å°±ä¸OK:
```python
f(a=1,20.) # SyntaxError: positional argument follows keyword argument
```

**è§„åˆ™2ï¼šå…³é”®å­—å‚æ•°å¿…é¡»åœ¨ä½ç½®å‚æ•°å³è¾¹**


ä¸‹é¢è°ƒç”¨ä¹Ÿä¸OK:
```python
f(1,width=20.,width=30.) #SyntaxError: keyword argument repeated

```

**è§„åˆ™3ï¼šå¯¹åŒä¸€ä¸ªå½¢å‚ä¸èƒ½é‡å¤ä¼ å€¼**


é»˜è®¤å‚æ•°

åœ¨å®šä¹‰å‡½æ•°æ—¶ï¼Œå¯ä»¥ä¸ºå½¢å‚æä¾›é»˜è®¤å€¼ã€‚å¯¹äºæœ‰é»˜è®¤å€¼çš„å½¢å‚ï¼Œè°ƒç”¨å‡½æ•°æ—¶å¦‚æœä¸ºè¯¥å‚æ•°ä¼ å€¼ï¼Œåˆ™ä½¿ç”¨ä¼ å…¥çš„å€¼ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤å€¼ã€‚å¦‚ä¸‹`b`æ˜¯é»˜è®¤å‚æ•°ï¼š
```python
def f(a,b=1):
  print(f'a:{a}, b:{b}')

```


**è§„åˆ™4ï¼šæ— è®ºæ˜¯å‡½æ•°çš„å®šä¹‰è¿˜æ˜¯è°ƒç”¨ï¼Œé»˜è®¤å‚æ•°çš„å®šä¹‰åº”è¯¥åœ¨ä½ç½®å½¢å‚å³é¢**

åªåœ¨å®šä¹‰æ—¶èµ‹å€¼ä¸€æ¬¡ï¼›é»˜è®¤å‚æ•°é€šå¸¸åº”è¯¥å®šä¹‰æˆä¸å¯å˜ç±»å‹


å¯å˜ä½ç½®å‚æ•°

å¦‚ä¸‹å®šä¹‰çš„å‚æ•°aä¸ºå¯å˜ä½ç½®å‚æ•°ï¼š
```python
def f(*a):
  print(a)
```
è°ƒç”¨æ–¹æ³•ï¼š
```python
f(1) #æ‰“å°ç»“æœä¸ºå…ƒç»„ï¼š (1,)
f(1,2,3) #æ‰“å°ç»“æœï¼š(1, 2, 3)
```

ä½†æ˜¯ï¼Œä¸èƒ½è¿™ä¹ˆè°ƒç”¨ï¼š
```python
f(a=1) # TypeError: f() got an unexpected keyword argument 'a'
```


å¯å˜å…³é”®å­—å‚æ•°

å¦‚ä¸‹`a`æ˜¯å¯å˜å…³é”®å­—å‚æ•°ï¼š
```python
def f(**a):
  print(a)
```
è°ƒç”¨æ–¹æ³•ï¼š
```python
f(a=1) #æ‰“å°ç»“æœä¸ºå­—å…¸ï¼š{'a': 1}
f(a=1,b=2,width=3) #æ‰“å°ç»“æœï¼š{'a': 1, 'b': 2, 'width': 3}
```

ä½†æ˜¯ï¼Œä¸èƒ½è¿™ä¹ˆè°ƒç”¨ï¼š
```python
f(1) TypeError: f() takes 0 positional arguments but 1 was given
```

æ¥ä¸‹æ¥ï¼Œå•ç‹¬æ¨é€åˆ†æä¸€ä¸ªå°ä¾‹å­ï¼Œç»¼åˆä»¥ä¸Šå„ç§å‚æ•°ç±»å‹çš„å‡½æ•°åŠè°ƒç”¨æ–¹æ³•ï¼Œæ•¬è¯·å…³æ³¨ã€‚

#### 190 åˆ—è¡¨åˆ é™¤ä¹‹å‘

åˆ é™¤ä¸€ä¸ªåˆ—è¡¨ä¸­çš„å…ƒç´ ï¼Œæ­¤å…ƒç´ å¯èƒ½åœ¨åˆ—è¡¨ä¸­é‡å¤å¤šæ¬¡ï¼š

```python
def del_item(lst,e):
    return [lst.remove(i) for i in e if i==e] # NO!
```

è€ƒè™‘åˆ é™¤è¿™ä¸ªåºåˆ—[1,3,3,3,5]ä¸­çš„å…ƒç´ 3ï¼Œç»“æœå‘ç°åªåˆ é™¤å…¶ä¸­ä¸¤ä¸ªï¼š

```python
del_item([1,3,3,3,5],3) # ç»“æœï¼š[1,3,5]
```

æ­£ç¡®åšæ³•ï¼š

```python
def del_item(lst,e):
    d = dict(zip(range(len(lst)),lst)) # YES! æ„é€ å­—å…¸
    return [v for k,v in d.items() if v!=e]

```

#### 191 åˆ—è¡¨å¿«é€Ÿå¤åˆ¶ä¹‹å‘

åœ¨pythonä¸­`*`ä¸åˆ—è¡¨æ“ä½œï¼Œå®ç°å¿«é€Ÿå…ƒç´ å¤åˆ¶ï¼š

```python
a = [1,3,5] * 3 # [1,3,5,1,3,5,1,3,5]
a[0] = 10 # [10, 2, 3, 1, 2, 3, 1, 2, 3]
```

å¦‚æœåˆ—è¡¨å…ƒç´ ä¸ºåˆ—è¡¨æˆ–å­—å…¸ç­‰å¤åˆç±»å‹ï¼š

```python
a = [[1,3,5],[2,4]] * 3 # [[1, 3, 5], [2, 4], [1, 3, 5], [2, 4], [1, 3, 5], [2, 4]]

a[0][0] = 10 #  
```

ç»“æœå¯èƒ½å‡ºä¹ä½ çš„æ„æ–™ï¼Œå…¶ä»–`a[1[0]`ç­‰ä¹Ÿè¢«ä¿®æ”¹ä¸º10

```python
[[10, 3, 5], [2, 4], [10, 3, 5], [2, 4], [10, 3, 5], [2, 4]]
```

è¿™æ˜¯å› ä¸º*å¤åˆ¶çš„å¤åˆå¯¹è±¡éƒ½æ˜¯æµ…å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´id(a[0])ä¸id(a[2])é—¨ç‰Œå·æ˜¯ç›¸ç­‰çš„ã€‚å¦‚æœæƒ³è¦å®ç°æ·±å¤åˆ¶æ•ˆæœï¼Œè¿™ä¹ˆåšï¼š

```python
a = [[] for _ in range(3)]
```

#### 192 å­—ç¬¦ä¸²é©»ç•™
```python
In [1]: a = 'something'
    ...: b = 'some'+'thing'
    ...: id(a)==id(b)
Out[1]: True
```
å¦‚æœä¸Šé¢ä¾‹å­è¿”å›`True`ï¼Œä½†æ˜¯ä¸‹é¢ä¾‹å­ä¸ºä»€ä¹ˆæ˜¯`False`:
```python
In [1]: a = '@zglg.com'

In [2]: b = '@zglg'+'.com'

In [3]: id(a)==id(b)
Out[3]: False
```
è¿™ä¸Cpython ç¼–è¯‘ä¼˜åŒ–ç›¸å…³ï¼Œè¡Œä¸ºç§°ä¸º`å­—ç¬¦ä¸²é©»ç•™`ï¼Œä½†é©»ç•™çš„å­—ç¬¦ä¸²ä¸­åªåŒ…å«å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿ã€‚

#### 193 ç›¸åŒå€¼çš„ä¸å¯å˜å¯¹è±¡
```python
In [5]: d = {}
    ...: d[1] = 'java'
    ...: d[1.0] = 'python'

In [6]: d
Out[6]: {1: 'python'}

### key=1,value=javaçš„é”®å€¼å¯¹ç¥å¥‡æ¶ˆå¤±äº†
In [7]: d[1]
Out[7]: 'python'
In [8]: d[1.0]
Out[8]: 'python'
```
è¿™æ˜¯å› ä¸ºå…·æœ‰ç›¸åŒå€¼çš„ä¸å¯å˜å¯¹è±¡åœ¨Pythonä¸­å§‹ç»ˆå…·æœ‰`ç›¸åŒçš„å“ˆå¸Œå€¼`

ç”±äºå­˜åœ¨`å“ˆå¸Œå†²çª`ï¼Œä¸åŒå€¼çš„å¯¹è±¡ä¹Ÿå¯èƒ½å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚

#### 194 å¯¹è±¡é”€æ¯é¡ºåº
åˆ›å»ºä¸€ä¸ªç±»`SE`:
```python
class SE(object):
  def __init__(self):
    print('init')
  def __del__(self):
    print('del')
```
åˆ›å»ºä¸¤ä¸ªSEå®ä¾‹ï¼Œä½¿ç”¨`is`åˆ¤æ–­ï¼š
```python
In [63]: SE() is SE()
init
init
del
del
Out[63]: False

```
åˆ›å»ºä¸¤ä¸ªSEå®ä¾‹ï¼Œä½¿ç”¨`id`åˆ¤æ–­ï¼š
```python
In [64]: id(SE()) == id(SE())
init
del
init
del
Out[64]: True
```

è°ƒç”¨`id`å‡½æ•°, Python åˆ›å»ºä¸€ä¸ª SE ç±»çš„å®ä¾‹ï¼Œå¹¶ä½¿ç”¨`id`å‡½æ•°è·å¾—å†…å­˜åœ°å€åï¼Œé”€æ¯å†…å­˜ä¸¢å¼ƒè¿™ä¸ªå¯¹è±¡ã€‚

å½“è¿ç»­ä¸¤æ¬¡è¿›è¡Œæ­¤æ“ä½œ, Pythonä¼šå°†ç›¸åŒçš„å†…å­˜åœ°å€åˆ†é…ç»™ç¬¬äºŒä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¸¤ä¸ªå¯¹è±¡çš„idå€¼æ˜¯ç›¸åŒçš„.


ä½†æ˜¯isè¡Œä¸ºå´ä¸ä¹‹ä¸åŒï¼Œé€šè¿‡æ‰“å°é¡ºåºå°±å¯ä»¥çœ‹åˆ°ã€‚

#### 195 å……åˆ†è®¤è¯†for
```python
In [65]: for i in range(5):
    ...:   print(i)
    ...:   i = 10
0
1
2
3
4
```
ä¸ºä»€ä¹ˆä¸æ˜¯æ‰§è¡Œä¸€æ¬¡å°±é€€å‡ºï¼Ÿ

æŒ‰ç…§foråœ¨Pythonä¸­çš„å·¥ä½œæ–¹å¼, i = 10 å¹¶ä¸ä¼šå½±å“å¾ªç¯ã€‚range(5)ç”Ÿæˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ å°±è¢«è§£åŒ…ï¼Œå¹¶èµ‹å€¼ç»™ç›®æ ‡åˆ—è¡¨çš„å˜é‡`i`.

#### 196 è®¤è¯†æ‰§è¡Œæ—¶æœº

```python
array = [1, 3, 5]
g = (x for x in array if array.count(x) > 0)
```
`g`ä¸ºç”Ÿæˆå™¨ï¼Œlist(g)åè¿”å›`[1,3,5]`ï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ è‚¯å®šè‡³å°‘éƒ½å‡ºç°ä¸€æ¬¡ã€‚æ‰€ä»¥è¿™ä¸ªç»“æœè¿™ä¸è¶³ä¸ºå¥‡ã€‚ä½†æ˜¯ï¼Œè¯·çœ‹ä¸‹ä¾‹ï¼š
```python
array = [1, 3, 5]
g = (x for x in array if array.count(x) > 0)
array = [5, 7, 9]
```
è¯·é—®,list(g)ç­‰äºå¤šå°‘ï¼Ÿè¿™ä¸æ˜¯å’Œä¸Šé¢é‚£ä¸ªä¾‹å­ç»“æœä¸€æ ·å—ï¼Œç»“æœä¹Ÿæ˜¯`[1,3,5]`ï¼Œä½†æ˜¯ï¼š
```python
In [74]: list(g)
Out[74]: [5]
```

è¿™æœ‰äº›ä¸å¯æ€è®®~~ åŸå› åœ¨äºï¼š

ç”Ÿæˆå™¨è¡¨è¾¾å¼ä¸­, in å­å¥åœ¨å£°æ˜æ—¶æ‰§è¡Œ, è€Œæ¡ä»¶å­å¥åˆ™æ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚


æ‰€ä»¥ä»£ç ï¼š
```python
array = [1, 3, 5]
g = (x for x in array if array.count(x) > 0)
array = [5, 7, 9]
```

ç­‰ä»·äºï¼š
```python
g = (x for x in [1,3,5] if [5,7,9].count(x) > 0)
```

#### 197 åˆ›å»ºç©ºé›†åˆé”™è¯¯

è¿™æ˜¯Pythonçš„ä¸€ä¸ªé›†åˆï¼š`{1,3,5}`ï¼Œå®ƒé‡Œé¢æ²¡æœ‰é‡å¤å…ƒç´ ï¼Œåœ¨å»é‡ç­‰åœºæ™¯æœ‰é‡è¦åº”ç”¨ã€‚ä¸‹é¢è¿™æ ·åˆ›å»ºç©ºé›†åˆæ˜¯é”™è¯¯çš„ï¼š

```python
empty = {} #NO!
```

cpythonä¼šè§£é‡Šå®ƒä¸ºå­—å…¸

ä½¿ç”¨å†…ç½®å‡½æ•°`set()`åˆ›å»ºç©ºé›†åˆï¼š

```python
empty = set() #YES!
```

#### 198 pyechartsä¼ å…¥Numpyæ•°æ®ç»˜å›¾å¤±è´¥

echartsä½¿ç”¨å¹¿æ³›ï¼Œecharts+pythonç»“åˆåçš„åŒ…ï¼špyechartsï¼ŒåŒæ ·å¯å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯ä¼ å…¥Numpyçš„æ•°æ®ï¼Œåƒä¸‹é¢è¿™æ ·ç»˜å›¾ä¼šå¤±è´¥ï¼š

```python
from pyecharts.charts import Bar
import pyecharts.options as opts
import numpy as np
c = (
    Bar()
    .add_xaxis([1, 2, 3, 4, 5])
    # ä¼ å…¥Numpyæ•°æ®ç»˜å›¾å¤±è´¥ï¼
    .add_yaxis("å•†å®¶A", np.array([0.1, 0.2, 0.3, 0.4, 0.5]))
)

c.render()
```

<img src="./img/image-20200129164119080.png" width="50%"/>

ç”±æ­¤å¯è§pyechartså¯¹Numpyæ•°æ®ç»˜å›¾ä¸æ”¯æŒï¼Œä¼ å…¥åŸç”ŸPythonçš„list:

```python
from pyecharts.charts import Bar
import pyecharts.options as opts
import numpy as np
c = (
    Bar()
    .add_xaxis([1, 2, 3, 4, 5])
    # ä¼ å…¥PythonåŸç”Ÿlist
    .add_yaxis("å•†å®¶A", np.array([0.1, 0.2, 0.3, 0.4, 0.5]).tolist())
)

c.render()
```

<img src="./img/image-20200129164339971.png" width="50%"/>

#### 199 ä¼˜åŒ–ä»£ç å¼‚å¸¸è¾“å‡ºåŒ…

ä¸€è¡Œä»£ç ä¼˜åŒ–è¾“å‡ºçš„å¼‚å¸¸ä¿¡æ¯
```python
pip install pretty-errors
```

å†™ä¸€ä¸ªå‡½æ•°æµ‹è¯•ï¼š

```python
def divided_zero():
    for i in range(10, -1, -1):
        print(10/i)


divided_zero()
```

åœ¨æ²¡æœ‰importè¿™ä¸ª`pretty-errors`å‰ï¼Œè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯æœ‰äº›å†—ä½™ï¼š

```python
Traceback (most recent call last):
  File "c:\Users\HUAWEI\.vscode\extensions\ms-python.python-2019.11.50794\pythonFiles\ptvsd_launcher.py", line 43, in <module>
    main(ptvsdArgs)
  File "c:\Users\HUAWEI\.vscode\extensions\ms-python.python-2019.11.50794\pythonFiles\lib\python\old_ptvsd\ptvsd\__main__.py",
line 432, in main
    run()
  File "c:\Users\HUAWEI\.vscode\extensions\ms-python.python-2019.11.50794\pythonFiles\lib\python\old_ptvsd\ptvsd\__main__.py",
line 316, in run_file
    runpy.run_path(target, run_name='__main__')
  File "D:\anaconda3\lib\runpy.py", line 263, in run_path
    pkg_name=pkg_name, script_name=fname)
  File "D:\anaconda3\lib\runpy.py", line 96, in _run_module_code
    mod_name, mod_spec, pkg_name, script_name)
  File "D:\anaconda3\lib\runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "d:\source\sorting-visualizer-master\sorting\debug_test.py", line 6, in <module>
    divided_zero()
  File "d:\source\sorting-visualizer-master\sorting\debug_test.py", line 3, in divided_zero
    print(10/i)
ZeroDivisionError: division by zero
```

æˆ‘ä»¬ä½¿ç”¨åˆšå®‰è£…çš„`pretty_errors`ï¼Œ`import`ä¸‹:

```python
import pretty_errors

def divided_zero():
    for i in range(10, -1, -1):
        print(10/i)

divided_zero()
```

æ­¤æ—¶çœ‹çœ‹è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼Œéå¸¸ç²¾ç®€åªæœ‰2è¡Œï¼Œå»é‚£äº›å†—ä½™ä¿¡æ¯ï¼š

```python
ZeroDivisionError:
division by zero
```

å®Œæ•´çš„è¾“å‡ºä¿¡æ¯å¦‚ä¸‹å›¾ç‰‡æ‰€ç¤ºï¼š



<img src="./img/image-20200104103849047.png" width="50%"/>

#### 200 å›¾åƒå¤„ç†åŒ…pillow

ä¸¤è¡Œä»£ç å®ç°æ—‹è½¬å’Œç¼©æ”¾å›¾åƒ

é¦–å…ˆå®‰è£…pillow:

```python
pip install pillow
```

æ—‹è½¬å›¾åƒä¸‹é¢å›¾åƒ45åº¦ï¼š

<img src="./img/plotly2.png" width="40%"/>

```python
In [1]: from PIL import Image
In [2]: im = Image.open('./img/plotly2.png')
In [4]: im.rotate(45).show()
```

æ—‹è½¬45åº¦åçš„æ•ˆæœå›¾

<img src="./img/image-20200105085120611.png" width="40%"/>

ç­‰æ¯”ä¾‹ç¼©æ”¾å›¾åƒï¼š

```python
im.thumbnail((128,72),Image.ANTIALIAS)
```

ç¼©æ”¾åçš„æ•ˆæœå›¾ï¼š

![](./img/pillow_suofang.png)



è¿‡æ»¤å›¾åƒåçš„æ•ˆæœå›¾ï¼š

```python
from PIL import ImageFilter
im.filter(ImageFilter.CONTOUR).show()
```

<img src="./img/pillow_filter.png" width="40%"/>

#### 201 ä¸€è¡Œä»£ç æ‰¾åˆ°ç¼–ç 

å…´é«˜é‡‡çƒˆåœ°ï¼Œä»ç½‘é¡µä¸ŠæŠ“å–ä¸€æ®µ `content`

ä½†æ˜¯ï¼Œä¸€ `print ` å°±ä¸é‚£ä¹ˆå…´é«˜é‡‡çƒˆäº†ï¼Œç»“æœçœ‹åˆ°ä¸€ä¸²è¿™ä¸ªï¼š

```markdown
b'\xc8\xcb\xc9\xfa\xbf\xe0\xb6\xcc\xa3\xac\xce\xd2\xd3\xc3Python'
```

è¿™æ˜¯å•¥ï¼Ÿ åˆ x åˆ c çš„ï¼

å†ä¸€çœ‹ï¼Œå“¦ï¼ŒåŸæ¥æ˜¯åå…­è¿›åˆ¶å­—èŠ‚ä¸² (`bytes`)ï¼Œ`\x` è¡¨ç¤ºåå…­è¿›åˆ¶

æ¥ä¸‹æ¥ï¼Œä½ ä¸€å®šæƒ³è½¬åŒ–ä¸ºäººç±»èƒ½çœ‹æ‡‚çš„è¯­è¨€ï¼Œæƒ³åˆ° `decode`ï¼š

```python
In [3]: b'\xc8\xcb\xc9\xfa\xbf\xe0\xb6\xcc\xa3\xac\xce\xd2\xd3\xc3Python'.decode()
UnicodeDecodeError                        Traceback (most recent call last)
<ipython-input-3-7d0ea6148880> in <module>
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
```

é©¬ä¸Šï¼Œä¸€ç›†å†·æ°´æ³¼å¤´ä¸Šï¼ŒæŠ›å¼‚å¸¸äº†ã€‚ã€‚ã€‚ã€‚ã€‚

æ ¹æ®æç¤ºï¼Œ`UnicodeDecodeError`ï¼Œè¿™æ˜¯ unicode è§£ç é”™è¯¯ã€‚

åŸæ¥ï¼Œ`decode` é»˜è®¤çš„ç¼–ç æ–¹æ³•ï¼š`utf-8` 

æ‰€ä»¥æ’é™¤  b'\xc8\xcb\xc9\xfa\xbf\xe0\xb6\xcc\xa3\xac\xce\xd2\xd3\xc3Python' ä½¿ç”¨ `utf-8` çš„ç¼–ç æ–¹å¼

å¯æ˜¯ï¼Œè¿™ä¸æ˜¯å››é€‰ä¸€é€‰æ‹©é¢˜å•Šï¼Œé€ä¸ªæ’é™¤ä¸æ­£ç¡®çš„ï¼

ç¼–ç æ–¹å¼å‡ åç§ï¼Œä¸å¯èƒ½é€ä¸ªæ’é™¤å§ã€‚

é‚£å°±çŒœå§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼

**äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨Python**

**Pythonï¼Œ æ€å¿å¿ƒè®©ä½ å—ç´¯å‘¢~**

å°½é‡ä¸‰è¡Œä»£ç è§£å†³é—®é¢˜

**ç¬¬ä¸€æ­¥ï¼Œå®‰è£… chardet**  å®ƒæ˜¯ char detect çš„ç¼©å†™ã€‚

**ç¬¬äºŒæ­¥ï¼Œpip install chardet**

**ç¬¬ä¸‰æ­¥ï¼Œå‡ºç»“æœ**

```python
In [6]: chardet.detect(b'\xc8\xcb\xc9\xfa\xbf\xe0\xb6\xcc\xa3\xac\xce\xd2\xd3\xc3Python')
Out[6]: {'encoding': 'GB2312', 'confidence': 0.99, 'language': 'Chinese'}
```

ç¼–ç æ–¹æ³•ï¼šgb2312

è§£å¯†å­—èŠ‚ä¸²ï¼š

```python
In [7]: b'\xc8\xcb\xc9\xfa\xbf\xe0\xb6\xcc\xa3\xac\xce\xd2\xd3\xc3Python'.decode('gb2312')
Out[7]: 'äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨Python'
```

ç›®å‰ï¼Œ`chardet` åŒ…æ”¯æŒçš„æ£€æµ‹ç¼–ç å‡ åç§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

<img src="./img/image-20200227225346560.png" width="50%"/>

### ä¸ƒã€ç®—æ³•å…¥é—¨

#### 202 é¢†ç•¥ç®—æ³•é­…åŠ›

æ·±åˆ»ç ”ç©¶æ’åºç®—æ³•æ˜¯å…¥é—¨ç®—æ³•è¾ƒä¸ºå¥½çš„ä¸€ç§æ–¹æ³•ï¼Œç°åœ¨è¿˜è®°å¾—4å¹´å‰æ‰‹åŠ¨å®ç°å¸¸è§8ç§æ’åºç®—æ³•ï¼Œé€šè¿‡éšæœºç”Ÿæˆä¸€äº›æ•°æ®ï¼Œé€ä¸ªæ ¡éªŒä»£ç å®ç°çš„æ’åºè¿‡ç¨‹æ˜¯å¦ä¸é¢„æœŸçš„ä¸€è‡´ï¼Œè¶Šåšè¶Šæœ‰åŠ²ï¼Œè¶Šæœ‰åŠ²è¶Šæƒ³å»ç ”ç©¶ï¼Œå…¬äº¤è½¦ä¸Šï¼Œåƒé¥­çš„è·¯ä¸Šã€‚ã€‚ã€‚é‚£äº›ç”»é¢ï¼Œç°åœ¨ä¾ç„¶è®°å¿†çŠ¹æ–°ã€‚

èƒ½åŠ›æœ‰é™ï¼Œå½“æ—¶å¹¶æ²¡æœ‰ç”Ÿæˆæ’åºè¿‡ç¨‹çš„åŠ¨ç”»ï¼Œæ‰€ä»¥è¿™äº›å¹´æƒ³ç€æŠ½æ—¶é—´ä¸€å®šæŠŠæ’åºçš„è¿‡ç¨‹éƒ½åˆ¶ä½œæˆåŠ¨ç”»ï¼Œç„¶ååˆ†äº«å‡ºæ¥ï¼Œè®©æ›´å¤šçš„å°ä¼™ä¼´çœ‹åˆ°ï¼Œé€šè¿‡æ’åºç®—æ³•çš„åŠ¨æ€æ¼”ç¤ºåŠ¨ç”»ï¼Œæ‰¾åˆ°å­¦ä¹ ç®—æ³•çš„çœŸæ­£ä¹è¶£ï¼Œä»è€Œè¿ˆå‘ä¸€ä¸ªæ–°çš„è®¤çŸ¥é¢†åŸŸã€‚

å½“æ—¶æˆ‘è¿˜æ˜¯ç”¨C++å†™çš„ï¼Œæ—¶è¿‡å¢ƒè¿ï¼ŒPythonè¿…é€Ÿå´›èµ·ï¼Œå¾—ç›ŠäºPythonçš„ç®€æ´ï¼Œæ¥å£æ˜“ç”¨ï¼Œæœ€è¿‘ç»ˆäºæœ‰äººåœ¨githubä¸­å¼€æºäº†ä½¿ç”¨PythonåŠ¨ç”»å±•ç¤ºæ’åºç®—æ³•çš„é¡¹ç›®ï¼ŒçœŸæ˜¯å€æ„Ÿå¹¸è¿ã€‚

åŠ¨ç”»è¿˜æ˜¯ç”¨matplotlibåšå‡ºæ¥çš„ï¼Œè¿™å°±æ›´å®Œç¾äº†ï¼Œä¸€è¾¹å­¦å®Œç¾çš„ç®—æ³•ï¼Œä¸€è¾¹è¿˜èƒ½æå‡Pythonç†Ÿç»ƒåº¦ï¼Œä¸€è¾¹è¿˜èƒ½å­¦åˆ°ä½¿ç”¨matplotlibåˆ¶ä½œåŠ¨ç”»ã€‚

å¿«é€Ÿæ’åºåŠ¨ç”»å±•ç¤º

<img src="./img/642.gif" width="50%"/>

å½’å¹¶æ’åºåŠ¨ç”»å±•ç¤º

<img src="./img/643.gif" width="50%"/>

å †æ’åºåŠ¨ç”»å±•ç¤º

<img src="./img/644.gif" width="50%"/>

è¿™äº›ç®—æ³•åŠ¨ç”»ä½¿ç”¨Matplotlibåˆ¶ä½œï¼Œæ¥ä¸‹æ¥é€ä¸ªè¡¥å……ã€‚

#### 203 æ’åºç®—æ³•çš„åŠ¨ç”»å±•ç¤º

å­¦ä¼šç¬¬ä¸€éƒ¨åˆ†å¦‚ä½•åˆ¶ä½œåŠ¨ç”»åï¼Œå¯å°†æ­¤æŠ€æœ¯åº”ç”¨äºæ’åºç®—æ³•è°ƒæ•´è¿‡ç¨‹çš„åŠ¨æ€å±•ç¤ºä¸Šã€‚

é¦–å…ˆç”Ÿæˆæµ‹è¯•ä½¿ç”¨çš„æ•°æ®ï¼Œå¾…æ’åºçš„æ•°æ®ä¸ªæ•°è‡³å¤š`20ä¸ª`ï¼Œå¾…æ’åºåºåˆ—ä¸º`random_wait_sort`ï¼Œä¸ºæ¯ä¸ªå€¼èµ‹ä¸€ä¸ªé¢œè‰²å€¼ï¼Œè¿™ä¸ªç”±`random_rgb`è´Ÿè´£ï¼š

```python
data_count = 20  # here, max value of data_count is 20

random_wait_sort = [12, 34, 32, 24, 28, 39, 5,
                    22, 11, 25, 33, 32, 1, 25, 3, 8, 7, 1, 34, 7]

random_rgb = [(0.5, 0.811565104942967, 0.11211028937187217),
              (0.5, 0.5201323831224014, 0.6660999602342474),
              (0.5, 0.575976663060455, 0.17788242607567772),
              (0.5, 0.6880174797416493, 0.43581701833249353),
              (0.5, 0.4443131322001743, 0.6993600264279745),
              (0.5, 0.5538835821863523, 0.889276053938713),
              (0.5, 0.4851681185146841, 0.7977608586163772),
              (0.5, 0.3886717808488436, 0.09319137949618972),
              (0.5, 0.8952456581687489, 0.8282376936934484),
              (0.5, 0.16360202854998007, 0.4538892160157194),
              (0.5, 0.23233400128809478, 0.8544141586189615),
              (0.5, 0.5224648797546528, 0.8194014475829123),
              (0.5, 0.49396099968405016, 0.47441724394796825),
              (0.5, 0.12078104526714728, 0.7715022079860492),
              (0.5, 0.19428498518228154, 0.08174917157481443),
              (0.5, 0.6058698403873457, 0.6085936584142663),
              (0.5, 0.7801178568951216, 0.6414767240649862),
              (0.5, 0.4768865661174162, 0.3889866229610085),
              (0.5, 0.4301945092238082, 0.961688141676841),
              (0.5, 0.40496648895289855, 0.24234095882836093)]


```

å†å°è£…ä¸€ä¸ªç®€å•çš„æ•°æ®å¯¹è±¡`Data`ï¼š
```python
class Data:
    def __init__(self, value, rgb):
        self.value = value
        self.color = rgb

    # é€ æ•°æ®
    @classmethod
    def create(cls):
        return [Data(val, rgb) for val, rgb in zip(random_wait_sort[:data_count],
                                                   random_rgb[:data_count])]
```


#### 204 å…ˆæ‹¿å†’æ³¡å®éªŒ

ä¸€æ—¦å‘ç”Ÿè°ƒæ•´ï¼Œæˆ‘ä»¬ç«‹å³ä¿å­˜åˆ°å¸§åˆ—è¡¨`frames`ä¸­ï¼Œæ³¨æ„æ­¤å¤„éœ€è¦`deepcopy`:
```python
# å†’æ³¡æ’åº
def bubble_sort(waiting_sort_data):
    frames = [waiting_sort_data]
    ds = copy.deepcopy(waiting_sort_data)
    for i in range(data_count-1):
        for j in range(data_count-i-1):
            if ds[j].value > ds[j+1].value:
                ds[j], ds[j+1] = ds[j+1], ds[j]
                frames.append(copy.deepcopy(ds))
    frames.append(ds)
    return frames
```

å®éªŒç»“æœå›¾ï¼š

<img src="./img/image-20200104232411426.png" width="50%"/>

å®Œæ•´åŠ¨ç”»æ¼”ç¤ºï¼š

<img src="./img/bubble_sort.gif" width="40%"/>

#### 205 å¿«é€Ÿæ’åº
å…ˆä¸Šä»£ç ï¼Œæ¯”è¾ƒç»å…¸ï¼Œå€¼å¾—å›å‘³ï¼š
```python
def quick_sort(data_set):
    frames = [data_set]
    ds = copy.deepcopy(data_set)

    def qsort(head, tail):
        if tail - head > 1:
            i = head
            j = tail - 1
            pivot = ds[j].value
            while i < j:
                if ds[i].value > pivot or ds[j].value < pivot:
                    ds[i], ds[j] = ds[j], ds[i]
                    frames.append(copy.deepcopy(ds))
                if ds[i].value == pivot:
                    j -= 1
                else:
                    i += 1
            qsort(head, i)
            qsort(i+1, tail)

    qsort(0, data_count)
    frames.append(ds)
    return frames
```
å¿«é€Ÿæ’åºç®—æ³•å¯¹è¾“å…¥ä¸ºéšæœºçš„åºåˆ—ä¼˜åŠ¿å¾€å¾€è¾ƒä¸ºæ˜æ˜¾ï¼ŒåŒæ ·çš„è¾“å…¥æ•°æ®ï¼Œå®ƒåªéœ€è¦`24`å¸§è°ƒæ•´å°±èƒ½å®Œæˆæ’åºã€‚

#### 206 é€‰æ‹©æ’åº
é€‰æ‹©æ’åºå’Œå †æ’åºéƒ½æ˜¯é€‰æ‹©æ€ç»´ï¼Œä½†æ˜¯æ€§èƒ½å´ä¸å¦‚å †æ’åºï¼š
```python
def selection_sort(data_set):
    frames = [data_set]
    ds = copy.deepcopy(data_set)
    for i in range(0, data_count-1):
        for j in range(i+1, data_count):
            if ds[j].value < ds[i].value:
                ds[i], ds[j] = ds[j], ds[i]
                frames.append(copy.deepcopy(ds))

    frames.append(ds)
    return frames
```
åŠ¨ç”»å±•ç¤ºå¦‚ä¸‹ï¼Œæ¯è½®ä¼šä»æœªæ’åºçš„åˆ—è¡¨ä¸­ï¼ŒæŒ‘å‡ºä¸€ä¸ªæœ€å°å€¼ï¼Œæ”¾åˆ°å·²æ’åºåºåˆ—åé¢ã€‚

<img src="./img/select_sort.gif" width="40%"/>

#### 207 å †æ’åº
å †æ’åºå¤§å¤§æ”¹è¿›äº†é€‰æ‹©æ’åºï¼Œé€»è¾‘ä¸Šä½¿ç”¨äºŒå‰æ ‘ï¼Œå…ˆå»ºç«‹ä¸€ä¸ªå¤§æ ¹å †ï¼Œç„¶åæ ¹èŠ‚ç‚¹ä¸æœªæ’åºåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œé‡æ–°å¯¹æœªæ’åºåºåˆ—å»ºå †ã€‚

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```python
def heap_sort(data_set):
    frames = [data_set]
    ds = copy.deepcopy(data_set)

    def heap_adjust(head, tail):
        i = head * 2 + 1  # headçš„å·¦å­©å­
        while i < tail:
            if i + 1 < tail and ds[i].value < ds[i+1].value:  # é€‰æ‹©ä¸€ä¸ªæ›´å¤§çš„å­©å­
                i += 1
            if ds[i].value <= ds[head].value:
                break
            ds[head], ds[i] = ds[i], ds[head]
            frames.append(copy.deepcopy(ds))
            head = i
            i = i * 2 + 1

    # å»ºç«‹ä¸€ä¸ªæœ€å¤§å †ï¼Œä»æœ€åä¸€ä¸ªçˆ¶èŠ‚ç‚¹å¼€å§‹è°ƒæ•´
    for i in range(data_count//2-1, -1, -1):
        heap_adjust(i, data_count)
    for i in range(data_count-1, 0, -1):
        ds[i], ds[0] = ds[0], ds[i]  # æŠŠæœ€å¤§å€¼æ”¾åœ¨ä½ç½®iå¤„
        heap_adjust(0, i)  # ä»0~i-1è¿›è¡Œå †è°ƒæ•´
    frames.append(ds)
    return frames
```
å †æ’åºçš„æ€§èƒ½ä¹Ÿæ¯”è¾ƒä¼˜ç§€ï¼Œå®Œæˆæ’åºéœ€è¦51æ¬¡è°ƒæ•´ã€‚

<img src="./img/image-20200104232824967.png" width="50%"/>

ä¾æ¬¡è°ƒç”¨ä»¥ä¸Šå¸¸è§çš„4ç§æ’åºç®—æ³•ï¼Œåˆ†åˆ«ä¿å­˜æ‰€æœ‰å¸§å’Œhtmlæ–‡ä»¶ã€‚

```python
waiting_sort_data = Data.create()
for sort_method in [bubble_sort, quick_sort, selection_sort, heap_sort]:
    frames = sort_method(waiting_sort_data)
    draw_chart(frames, file_name='%s.html' % (sort_method.__name__,))
```

è·å–ä»¥ä¸Šå®Œæ•´ä»£ç ã€æ‰€æœ‰æ•°æ®æ–‡ä»¶ã€ç»“æœæ–‡ä»¶ï¼š[å®Œæ•´æºç ä¸‹è½½](./data/sort.zip)

#### 208 ä¼˜åŒ–ç®—æ³•

æœºå™¨å­¦ä¹ æ˜¯ä¸€ä¸ªç›®æ ‡å‡½æ•°ä¼˜åŒ–é—®é¢˜ï¼Œç»™å®šç›®æ ‡å‡½æ•°fï¼Œçº¦æŸæ¡ä»¶ä¼šæœ‰ä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç±»ï¼š

1. ä»…å«ç­‰å¼çº¦æŸ
2. ä»…å«ä¸ç­‰å¼çº¦æŸ
3. ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸæ··åˆå‹

å½“ç„¶è¿˜æœ‰ä¸€ç±»æ²¡æœ‰ä»»ä½•çº¦æŸæ¡ä»¶çš„æœ€ä¼˜åŒ–é—®é¢˜

å…³äºæœ€ä¼˜åŒ–é—®é¢˜ï¼Œå¤§éƒ½ä»¤äººæ¯”è¾ƒå¤´ç–¼ï¼Œé¦–å…ˆå¤§å¤šæ•™æè®²è§£é€šç¯‡éƒ½æ˜¯å…¬å¼ï¼Œå„ç§ç¬¦å·è¡¨è¾¾ï¼Œå„ç§æ¢¯åº¦ï¼Œå«äººçœ‹çš„äº‘é‡Œé›¾é‡Œã€‚

æœ‰æ²¡æœ‰ç»“åˆå‡ ä½•å›¾å½¢é˜è¿°ä»¥ä¸Šé—®é¢˜çš„ï¼Ÿå¾ˆåº†å¹¸ï¼Œè¿˜çœŸæœ‰è¿™ä¹ˆå¥½çš„è®²è§£ææ–™ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼Œé€»è¾‘æ¨å¯¼ä¸¥è°¨ï¼Œæ›´å®¹æ˜“å«æˆ‘ä»¬ç†è§£`æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•`ã€`KKTæ¡ä»¶`ä¸ºä»€ä¹ˆå°±èƒ½æ±‚å‡ºæå€¼ã€‚

#### 209 ä»…å«ç­‰å¼çº¦æŸ
å‡å®šç›®æ ‡å‡½æ•°æ˜¯è¿ç»­å¯å¯¼å‡½æ•°ï¼Œé—®é¢˜å®šä¹‰å¦‚ä¸‹ï¼š

![1578812286324](./img/1578812286324.png)

ç„¶åï¼š

<img src="./img/1578812306173.png" width="50%"/>


é€šè¿‡ä»¥ä¸Šæ–¹æ³•æ±‚è§£æ­¤ç±»é—®é¢˜ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå®ƒèƒ½æ±‚å‡ºæå€¼å‘¢ï¼Ÿ

#### 210 æ‰¾æ‰¾æ„Ÿè§‰

å¤§å®¶æ—¶é—´éƒ½æœ‰é™ï¼Œåªåˆ—å‡ºæœ€æ ¸å¿ƒçš„é€»è¾‘ï¼Œæ‰¾æ‰¾sense, å¦‚æœ‰å…´è¶£å¯å›å»ä¸‹è½½PPTä»”ç»†ä½“ä¼šã€‚

æ­¤è§£é‡Šä¸­å¯¹æ­¤ç±»é—®é¢˜çš„å®šä¹‰ï¼š

<img src="./img/1578812336141.png" width="50%"/>

ä¸ºäº†æ›´å¥½çš„é˜è¿°ï¼Œç»™å®šä¸€ä¸ªå…·ä½“ä¾‹å­ï¼Œé”å®šï¼š

<img src="./img/1578812354197.png" width="50%"/>



æ‰€ä»¥ï¼Œf(x)çš„ä¸€ç³»åˆ—å–å€¼åŒ…æ‹¬0,1,100,10000ç­‰ä»»æ„å®æ•°ï¼š



<img src="./img/1578812380549.png" width="50%"/>



ä½†æ˜¯ï¼Œçº¦æŸæ¡ä»¶`h(x)`æ³¨å®šä¼šçº¦æŸ`f(x)`ä¸ä¼šç­‰äº100ï¼Œä¸ä¼šç­‰äº10000...

<img src="./img/1578812405788.png" width="50%"/>



ä¸€ä¸ªå¯è¡Œç‚¹ï¼š

<<img src="./img/1578812432196.png" width="50%"/>



#### 211 æ¢¯åº¦ä¸‹é™

æˆ‘ä»¬æƒ³è¦å¯»æ‰¾ä¸€ä¸ªç§»åŠ¨`x`çš„è§„åˆ™ï¼Œä½¿å¾—ç§»åŠ¨å`f(x+delta_x)`å˜å°ï¼Œå½“ç„¶å¿…é¡»æ»¡è¶³çº¦æŸ`h(x+delta_x)=0`

<img src="./img/1578812461492.png" width="50%"/>

ä½¿å¾—`f(x`)å‡å°æœ€å¿«çš„æ–¹å‘å°±æ˜¯å®ƒçš„æ¢¯åº¦åæ–¹å‘ï¼Œå³

<img src="./img/1578812526928.png" width="10%"/>

<img src="./img/1578812555425.png" width="50%"/>

å› æ­¤ï¼Œè¦æƒ³f(x+delta_x) å˜å°ï¼Œé€šè¿‡å›¾å½¢å¯ä»¥çœ‹å‡ºï¼Œåªè¦ä¿æŒå’Œæ¢¯åº¦åæ–¹å‘å¤¹è§’å°äº90ï¼Œä¹Ÿå°±æ˜¯ä¿æŒå¤§æ¦‚ä¸€ä¸ªæ–¹å‘ï¼Œ`f(x+delta_x)`å°±ä¼šå˜å°ï¼Œè½¬åŒ–ä¸ºå…¬å¼å°±æ˜¯ï¼š

![1578812584788](./img/1578812584788.png)

å¦‚ä¸‹æ‰€ç¤ºçš„ä¸€ä¸ª`delta_x`å°±æ˜¯ä¸€ä¸ªä¼šä½¿å¾—f(x)å‡å°çš„æ–¹å‘ï¼Œä½†æ˜¯è¿™ç§ç§»åŠ¨å°†ä¼šç ´åç­‰å¼çº¦æŸ: `h(x)=0`ï¼Œå…³äºå‡†ç¡®çš„ç§»åŠ¨æ–¹å‘ä¸‹é¢ç¬¬å››å°èŠ‚ä¼šè®²åˆ°

<img src="./img/1578812611316.png" width="50%"/>

#### 212 çº¦æŸé¢çš„æ³•å‘



çº¦æŸé¢çš„å¤–æ³•å‘ï¼š

<img src="./img/1578812646197.png" width="10%"/>



<img src="./img/1578812671357.png" width="40%"/>

çº¦æŸé¢çš„å†…æ³•å‘ï¼š



<img src="./img/1578812701522.png" width="40%"/>

ç»¿åœˆè¡¨ç¤ºæ³•å‘çš„`æ­£äº¤`æ–¹å‘

**xæ²¿ç€ç»¿åœˆå†…çš„æ–¹å‘ç§»åŠ¨ï¼Œå°†ä¼šä½¿å¾—f(x)å‡å°ï¼ŒåŒæ—¶æ»¡è¶³ç­‰å¼çº¦æŸh(x) = 0**

<img src="./img/1578812721685.png" width="40%"/>

#### 213 å¤§èƒ†çŒœæƒ³



 æˆ‘ä»¬ä¸å¦¨å¤§èƒ†å‡è®¾ï¼Œå¦‚æœæ»¡è¶³ä¸‹é¢çš„æ¡ä»¶ï¼š

![1578812749903](./img/1578812749903.png)

æ ¹æ®ç¬¬å››å°èŠ‚è®²è¿°ï¼Œ`delta_x`å¿…é¡»æ­£äº¤äº`h(x)`ï¼Œæ‰€ä»¥ï¼š

![1578812770462](./img/1578812770462.png)

æ‰€ä»¥ï¼š

<img src="./img/1578812792568.png" width="60%"/>

è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°`f(x)`åå¯¼æ•°ç­‰äº0çš„ç‚¹ï¼Œå°±æ˜¯ä¸‹å›¾æ‰€ç¤ºçš„**ä¸¤ä¸ªå…³é”®ç‚¹ï¼ˆå®ƒä»¬ä¹Ÿæ˜¯f(x)ä¸h(x)çš„ä¸´ç•Œç‚¹ï¼‰**ã€‚ä¸”å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå‘é‡å¿…é¡»æ˜¯å¹³è¡Œçš„ï¼š

![1578812814963](./img/1578812814963.png)

<img src="./img/1578812850771.png" width="50%"/>

#### 214 å®Œå…¨è§£ç æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•

è‡³æ­¤ï¼Œå·²ç»å®Œå…¨è§£ç æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ï¼Œæ‹‰æ ¼æœ—æ—¥å·§å¦™çš„æ„é€ å‡ºä¸‹é¢è¿™ä¸ªå¼å­ï¼š

![1578812874316](./img/1578812874316.png)

**è¿˜æœ‰å–å¾—æå€¼çš„çš„ä¸‰ä¸ªæ¡ä»¶ï¼Œéƒ½æ˜¯å¯¹ä»¥ä¸Šäº”ä¸ªå°èŠ‚ä¸­æ¶‰åŠåˆ°çš„æ¡ä»¶çš„ç¼–ç **

<img src="./img/1578812930092.png" width="50%"/>

å…³äºç¬¬ä¸‰ä¸ªæ¡ä»¶ï¼Œç¨åŠ è¯´æ˜ã€‚

å¯¹äºå«æœ‰å¤šä¸ªå˜é‡ï¼Œæ¯”å¦‚æœ¬ä¾‹å­å°±å«æœ‰2ä¸ªå˜é‡`x1`, `x2`ï¼Œå°±æ˜¯ä¸€ä¸ªå¤šå…ƒä¼˜åŒ–é—®é¢˜ï¼Œéœ€è¦æ±‚äºŒé˜¶å¯¼ï¼ŒäºŒé˜¶å¯¼çš„çŸ©é˜µå°±è¢«ç§°ä¸º`æµ·å¡çŸ©é˜µ`ï¼ˆHessian Matrixï¼‰

ä¸æ±‚è§£ä¸€å…ƒé—®é¢˜ä¸€æ ·ï¼Œä»…å‡­ä¸€é˜¶å¯¼æ•°ç­‰äºæ˜¯æ— æ³•åˆ¤æ–­æå€¼çš„ï¼Œéœ€è¦æ±‚äºŒé˜¶å¯¼ï¼Œå¹¶ä¸”äºŒé˜¶å¯¼å¤§äº0æ‰æ˜¯æå°å€¼ï¼Œå°äº0æ˜¯æå¤§å€¼ï¼Œç­‰äº0ä¾ç„¶æ— æ³•åˆ¤æ–­æ˜¯å¦åœ¨æ­¤ç‚¹å»çš„æå€¼ã€‚



> ä»¥ä¸Šå°±æ˜¯æœºå™¨å­¦ä¹ æœ€å¸¸ç”¨çš„ä¼˜åŒ–æŠ€å·§ï¼šæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•çš„å›¾å½¢è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æ‰¾åˆ°ä¸€å®šæ„Ÿè§‰ï¼Œæ¥ä¸‹æ¥å‡ å¤©æˆ‘ä»¬é€šè¿‡ä¾‹å­ï¼Œè¯¦ç»†é˜è¿°æœºå™¨å­¦ä¹ çš„å…·ä½“æ¦‚å¿µï¼Œå¸¸ç”¨ç®—æ³•ï¼Œä½¿ç”¨Pythonå®ç°ä¸»è¦çš„ç®—æ³•ï¼Œä½¿ç”¨Sklearnï¼ŒKaggleæ•°æ®å®æˆ˜è¿™äº›ç®—æ³•ã€‚



#### 215 å‡åŒ€åˆ†å¸ƒ

å¯¼å…¥æœ¬æ¬¡å®éªŒæ‰€ç”¨çš„4ç§å¸¸è§åˆ†å¸ƒï¼Œè¿ç»­åˆ†å¸ƒçš„ä»£è¡¨ï¼š`beta`åˆ†å¸ƒã€`æ­£æ€`åˆ†å¸ƒï¼Œ`å‡åŒ€`åˆ†å¸ƒï¼Œç¦»æ•£åˆ†å¸ƒçš„ä»£è¡¨ï¼š`äºŒé¡¹`åˆ†å¸ƒã€‚

ç»˜å›¾è£…é¥°å™¨å¸¦æœ‰å››ä¸ªå‚æ•°åˆ†åˆ«è¡¨ç¤º`legend`çš„2ç±»è¯´æ˜æ–‡å­—ï¼Œyè½´label, ä¿å­˜çš„pngæ–‡ä»¶åç§°ã€‚

```python
import pretty_errors
import numpy as np
from scipy.stats import beta, norm, uniform, binom
import matplotlib.pyplot as plt
from functools import wraps

# å®šä¹‰å¸¦å››ä¸ªå‚æ•°çš„ç”»å›¾è£…é¥°å™¨

def my_plot(label0=None, label1=None, ylabel='probability density function', fn=None):
    def decorate(f):
        @wraps(f)
        def myplot():
            fig = plt.figure(figsize=(16, 9))
            ax = fig.add_subplot(111)
            x, y, y1 = f()
            ax.plot(x, y, linewidth=2, c='r', label=label0)
            ax.plot(x, y1, linewidth=2, c='b', label=label1)
            ax.legend()
            plt.ylabel(ylabel)
            # plt.show()
            plt.savefig('./img/%s' % (fn,))
            print('%sä¿å­˜æˆåŠŸ' % (fn,))
            plt.close()
        return myplot
    return decorate
```

```python
# å‡åŒ€åˆ†å¸ƒ(uniform)
@my_plot(label0='b-a=1.0', label1='b-a=2.0', fn='uniform.png')
def unif():
    x = np.arange(-0.01, 2.01, 0.01)
    y = uniform.pdf(x, loc=0.0, scale=1.0)
    y1 = uniform.pdf(x, loc=0.0, scale=2.0)
    return x, y, y1
```

<img src="./img/uniform.png" width="50%"/>

#### 216 **äºŒé¡¹åˆ†å¸ƒ**

çº¢è‰²æ›²çº¿è¡¨ç¤ºå‘ç”Ÿä¸€æ¬¡æ¦‚ç‡ä¸º0.3ï¼Œé‡å¤50æ¬¡çš„å¯†åº¦å‡½æ•°ï¼ŒäºŒé¡¹åˆ†å¸ƒæœŸæœ›å€¼ä¸º0.3*50 = 15æ¬¡ã€‚çœ‹åˆ°è¿™50æ¬¡å®éªŒï¼Œå¾ˆå¯èƒ½å‡ºç°çš„æ¬¡æ•°ä¸º10~20.å¯ä¸è“è‰²æ›²çº¿å¯¹æ¯”åˆ†æã€‚

```python
# äºŒé¡¹åˆ†å¸ƒ
@my_plot(label0='n=50,p=0.3', label1='n=50,p=0.7', fn='binom.png', ylabel='probability mass function')
def bino():
    x = np.arange(50)
    n, p, p1 = 50, 0.3, 0.7
    y = binom.pmf(x, n=n, p=p)
    y1 = binom.pmf(x, n=n, p=p1)
    return x, y, y1
```

<img src="./img/binom.png" width="50%"/>

#### 217 é«˜æ–¯åˆ†å¸ƒ

çº¢è‰²æ›²çº¿è¡¨ç¤ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1.0çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè“è‰²æ›²çº¿çš„æ ‡å‡†å·®æ›´å¤§ï¼Œæ‰€ä»¥å®ƒæ›´çŸ®èƒ–ï¼Œæ˜¾ç¤ºå‡ºå–å€¼çš„å¤šæ ·æ€§ï¼Œå’Œä¸ç¨³å®šæ€§ã€‚

```python
# é«˜æ–¯ åˆ†å¸ƒ
@my_plot(label0='u=0.,sigma=1.0', label1='u=0.,sigma=2.0', fn='guass.png')
def guass():
    x = np.arange(-5, 5, 0.1)
    y = norm.pdf(x, loc=0.0, scale=1.0)
    y1 = norm.pdf(x, loc=0., scale=2.0)
    return x, y, y1
```

<img src="./img/guass.png" width="50%"/>

#### 218 betaåˆ†å¸ƒ

betaåˆ†å¸ƒçš„æœŸæœ›å€¼å¦‚ä¸‹ï¼Œå¯ä»ä¸‹é¢çš„ä¸¤æ¡æ›²çº¿ä¸­åŠ ä»¥éªŒè¯ï¼š

![image-20200105205845965](./img/image-20200105205845965.png)

```python
# beta åˆ†å¸ƒ
@my_plot(label0='a=10., b=30.', label1='a=4., b=4.', fn='beta.png')
def bet():
    x = np.arange(-0.01, 1, 0.001)
    y = beta.pdf(x, a=10., b=30.)
    y1 = beta.pdf(x, a=4., b=4.)
    return x, y, y1
```

<img src="./img/beta.png" width="50%"/>

### å…«ã€Python å®æˆ˜


#### 219 ç¯å¢ƒæ­å»º

åŒºåˆ†å‡ ä¸ªå°ç™½å®¹æ˜“æ··æ·†çš„æ¦‚å¿µï¼špycharmï¼Œpythonè§£é‡Šå™¨ï¼Œcondaå®‰è£…ï¼Œpipå®‰è£…ï¼Œæ€»ç»“æ¥è¯´ï¼š

- `pycharm`æ˜¯pythonå¼€å‘çš„é›†æˆå¼€å‘ç¯å¢ƒ(Integrated Development Environmentï¼Œç®€ç§°IDE)ï¼Œå®ƒæœ¬èº«æ— æ³•æ‰§è¡ŒPythonä»£ç 
- `pythonè§£é‡Šå™¨`æ‰æ˜¯çœŸæ­£æ‰§è¡Œä»£ç çš„å·¥å…·ï¼Œpycharmé‡Œå¯è®¾ç½®Pythonè§£é‡Šå™¨ï¼Œä¸€èˆ¬å»pythonå®˜ç½‘ä¸‹è½½python3.7æˆ–python3.8ç‰ˆæœ¬ï¼›å¦‚æœå®‰è£…è¿‡`anaconda`ï¼Œå®ƒé‡Œé¢å¿…ç„¶ä¹ŸåŒ…æ‹¬ä¸€ä¸ªæŸç‰ˆæœ¬çš„Pythonè§£é‡Šå™¨ï¼›pycharmé…ç½®pythonè§£é‡Šå™¨é€‰æ‹©å“ªä¸€ä¸ªéƒ½å¯ä»¥ã€‚
- anacondaæ˜¯pythonå¸¸ç”¨åŒ…çš„åˆé›†ï¼Œå¹¶æä¾›ç»™æˆ‘ä»¬ä½¿ç”¨`conda`å‘½ä»¤éå¸¸æ–¹ä¾¿çš„å®‰è£…å„ç§PythonåŒ…ã€‚
- `condaå®‰è£…`ï¼šæˆ‘ä»¬å®‰è£…è¿‡anacondaè½¯ä»¶åï¼Œå°±èƒ½å¤Ÿä½¿ç”¨condaå‘½ä»¤ä¸‹è½½anacondaæºé‡Œ(æ¯”å¦‚ä¸­ç§‘å¤§é•œåƒæº)çš„åŒ…
- `pipå®‰è£…`ï¼šç±»ä¼¼äºcondaå®‰è£…çš„pythonå®‰è£…åŒ…çš„æ–¹æ³•ï¼Œæ›´åŠ å…¨é¢

**ä¿®æ”¹é•œåƒæº**

åœ¨ä½¿ç”¨å®‰è£…`conda` å®‰è£…æŸäº›åŒ…ä¼šå‡ºç°æ…¢æˆ–å®‰è£…å¤±è´¥é—®é¢˜ï¼Œæœ€æœ‰æ•ˆæ–¹æ³•æ˜¯ä¿®æ”¹é•œåƒæºä¸ºå›½å†…é•œåƒæºã€‚ä¹‹å‰éƒ½é€‰ç”¨æ¸…åé•œåƒæºï¼Œä½†æ˜¯2019å¹´åå·²åœæ­¢æœåŠ¡ã€‚æ¨èé€‰ç”¨ä¸­ç§‘å¤§é•œåƒæºã€‚

å…ˆæŸ¥çœ‹å·²ç»å®‰è£…è¿‡çš„é•œåƒæºï¼Œcmdçª—å£æ‰§è¡Œå‘½ä»¤ï¼š

```python
conda config --show
```

æŸ¥çœ‹é…ç½®é¡¹`channels`ï¼Œå¦‚æœæ˜¾ç¤ºå¸¦æœ‰`tsinghua`ï¼Œåˆ™è¯´æ˜å·²å®‰è£…è¿‡æ¸…åé•œåƒã€‚

```python
channels:
- https://mirrors.tuna.tsinghua.edu.cn/tensorflow/linux/cpu/
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
```

ä¸‹ä¸€æ­¥ï¼Œä½¿ç”¨`conda config --remove channels urlåœ°å€ `åˆ é™¤æ¸…åé•œåƒï¼Œå¦‚ä¸‹å‘½ä»¤åˆ é™¤ç¬¬ä¸€ä¸ªã€‚ç„¶åï¼Œä¾æ¬¡åˆ é™¤æ‰€æœ‰é•œåƒæº

```python
conda config --remove channels https://mirrors.tuna.tsinghua.edu.cn/tensorflow/linux/cpu/
```

æ·»åŠ ç›®å‰å¯ç”¨çš„ä¸­ç§‘å¤§é•œåƒæºï¼š

```
conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/free/
```

å¹¶è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€ï¼š

```python
conda config --set show_channel_urls yes
```

ç¡®è®¤æ˜¯å¦å®‰è£…é•œåƒæºæˆåŠŸï¼Œæ‰§è¡Œ`conda config --show`ï¼Œæ‰¾åˆ°`channels`å€¼ä¸ºå¦‚ä¸‹ï¼š

```
channels:
  - https://mirrors.ustc.edu.cn/anaconda/pkgs/free/
  - defaults
```

Done~

#### 220 pytorchæ…¢åˆ°æ— æ³•å®‰è£…ï¼Œæ€ä¹ˆåŠï¼Ÿ

**1 å®‰è£…æ…¢åˆ°è£…ä¸ä¸Š**

æœ€è¿‘å‡ å¤©ï¼Œåå°å‡ ä¸ªå°ä¼™ä¼´é—®æˆ‘ï¼Œæ— è®ºpipè¿˜æ˜¯condaå®‰è£…`pytorch`éƒ½å¤ªæ…¢äº†ï¼Œéƒ½æ˜¯å®‰è£…å®˜æ–¹æ–‡æ¡£å»åšçš„ï¼Œå°±æ˜¯è¶…æ—¶è£…ä¸ä¸Šï¼Œæ— æ³•å¼€å±•ä¸‹ä¸€æ­¥ï¼Œå¡è„–å­çš„æ„Ÿè§‰å¤ªä¸å¥½å—ã€‚

è¿™äº›å°ä¼™ä¼´æŒ‰ç…§pytorchå®˜æ¡£æç¤ºï¼Œé€‰æ‹©å¥½åï¼Œå®Œæ•´å¤åˆ¶ä¸Šé¢å‘½ä»¤`conda install pytorch torchvision cudatoolkit=10.1 -c pytorch`åˆ°cmdä¸­ï¼Œç³»ç»Ÿæ˜¯windows.

<img  src="./img/image-20200128182456390.png" width="50%"/>

æ¥ä¸‹æ¥æç¤ºï¼Œcondaéœ€è¦å®‰è£…çš„åŒ…ï¼Œä»–ä»¬æ“ä½œé€‰æ‹©`y`ï¼Œç»§ç»­å®‰è£…ï¼Œä½†æ˜¯åœ¨å®‰è£…æ—¶ï¼Œå‘ç°è¿›åº¦æ¡å‡ ä¹ä¸€åŠ¨ä¸åŠ¨ã€‚

åå¤å°è¯•ï¼Œå°±æ˜¯è¿™æ ·ï¼Œæœ‰äº›æ— å¥ˆï¼Œè¿˜æ„Ÿå¹æ€ä¹ˆæ·±åº¦å­¦ä¹ çš„è·¯ä¸€å¼€å§‹å°±TMDçš„è¿™ä¹ˆéš¾ï¼

**2 è¿™æ ·èƒ½æ­£å¸¸å®‰è£…**

æ— è®ºæ˜¯å®‰è£…`cpu`ç‰ˆè¿˜æ˜¯`cuda`ç‰ˆï¼Œç½‘ä¸Šå…³äºè¿™äº›çš„å‚è€ƒèµ„æ–™å¤ªå¤šäº†ï¼Œæ— éå°±æ˜¯cudaç¡¬ä»¶å’Œcudaå¼€å‘åŒ…çš„ç‰ˆæœ¬è¦å¯¹åº”ï¼Œpythonç‰ˆæœ¬è¦å¯¹åº”ç­‰ï¼Œè¿™äº›beeå›è§‰å¾—éƒ½ä¸æ˜¯äº‹ã€‚

å°±åƒå‡ ä½è¯»è€…æœ‹å‹é‡åˆ°çš„é—®é¢˜ï¼Œå…³é”®è¿˜æ˜¯å¦‚ä½•è§£å†³`æ…¢åˆ°æ— æ³•è£…`çš„é—®é¢˜ã€‚

æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯æ·»åŠ é•œåƒæºï¼Œå¸¸è§çš„æ¸…åæˆ–ä¸­ç§‘å¤§ã€‚

å…ˆæŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…ç›¸å…³é•œåƒæºï¼Œwindowsç³»ç»Ÿåœ¨`cmd`çª—å£ä¸­æ‰§è¡Œå‘½ä»¤ï¼š

```python
conda config --show
```

beeå›è¿™é‡Œæ˜¾ç¤ºï¼š
```python
channels:
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
```
è¯´æ˜å·²ç»å®‰è£…å¥½æ¸…åçš„é•œåƒæºã€‚å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œè¯·å‚è€ƒä¸‹é¢å‘½ä»¤å®‰è£…æºï¼š
```python
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
```
ä¾æ¬¡å®‰è£…ä¸Šé¢æ‰€æœ‰çš„æºã€‚

å¹¶è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š

```python
conda config --set show_channel_urls yes
```

**3 æœ€å…³é”®ä¸€æ­¥**

æœ‰çš„è¯»è€…é—®æˆ‘ï¼Œä»–ä»¬å·²ç»éƒ½å®‰è£…å¥½é•œåƒæºï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå®‰è£…è¿˜æ˜¯é¾Ÿé€Ÿï¼Ÿé—®ä»–ä»¬ï¼Œæ˜¯ç”¨å“ªä¸ªå‘½ä»¤ï¼Œä»–ä»¬å›å¤ï¼š`conda install pytorch torchvision cudatoolkit=10.1 -c pytorch`

å¥½å§ï¼Œæ‰§è¡Œä¸Šé¢å‘½ä»¤ï¼Œå› ä¸ºå‘½ä»¤æœ€åæ˜¯`-c pytorch`ï¼Œæ‰€ä»¥é»˜è®¤è¿˜æ˜¯ä»condaæºä¸‹è½½ï¼Œæ–°å®‰è£…çš„æ¸…åç­‰æºæ²¡æœ‰ç”¨ä¸Šã€‚

æ­£ç¡®å‘½ä»¤ï¼š`conda install pytorch torchvision cudatoolkit=10.1`ï¼Œä¹Ÿå°±æ˜¯å»æ‰`-c pytorch`

å¹¶ä¸”åœ¨å®‰è£…æ—¶ï¼Œä¹Ÿèƒ½çœ‹åˆ°ä½¿ç”¨äº†æ¸…åæºã€‚å¹¶ä¸”å®‰è£…é€Ÿåº¦ç›´çº¿æå‡ï¼Œé¡ºåˆ©done

**4 æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ**

ç»“åˆå®˜æ¡£ï¼Œæ‰§è¡Œä¸‹é¢ä»£ç ï¼Œ`torch.cuda.is_available()`è¿”å›`True`ï¼Œè¯´æ˜å®‰è£…cudaæˆåŠŸã€‚

```python
In [1]: import torch

In [2]: torch.cuda
Out[2]: <module 'torch.cuda' from 'D:\\Programs\\anaconda\\lib\\site-packages\\torch\\cuda\\__init__.py'>

In [3]: torch.cuda.is_available()
Out[3]: True

In [4]: from __future__ import print_function

In [5]: x = torch.rand(5,3)

In [6]: print(x)
tensor([[0.0604, 0.1135, 0.2656],
        [0.5353, 0.9246, 0.3004],
        [0.4872, 0.9592, 0.2215],
        [0.2598, 0.5031, 0.6093],
        [0.2986, 0.1599, 0.5862]])
```

è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®ºå®‰è£…`pytorch`æ…¢åˆ°ä¸èƒ½è£…çš„é—®é¢˜åŠæ–¹æ¡ˆï¼Œå¸Œæœ›å¯¹è¯»è€…æœ‹å‹ä»¬æœ‰å¸®åŠ©ã€‚

#### 221 è‡ªåŠ¨ç¾¤å‘é‚®ä»¶

Pythonè‡ªåŠ¨ç¾¤å‘é‚®ä»¶

```python
import smtplib
from email import (header)
from email.mime import (text, application, multipart)
import time

def sender_mail():
    smt_p = smtplib.SMTP()
    smt_p.connect(host='smtp.qq.com', port=25)
    sender, password = '113097485@qq.com', "**************"
    smt_p.login(sender, password)
    receiver_addresses, count_num = [
        'guozhennianhua@163.com', 'xiaoxiazi99@163.com'], 1
    for email_address in receiver_addresses:
        try:
            msg = multipart.MIMEMultipart()
            msg['From'] = "zhenguo"
            msg['To'] = email_address
            msg['subject'] = header.Header('è¿™æ˜¯é‚®ä»¶ä¸»é¢˜é€šçŸ¥', 'utf-8')
            msg.attach(text.MIMEText(
                'è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ï¼Œè¯·å‹¿å›å¤æœ¬é‚®ä»¶~', 'plain', 'utf-8'))
            smt_p.sendmail(sender, email_address, msg.as_string())
            time.sleep(10)
            print('ç¬¬%dæ¬¡å‘é€ç»™%s' % (count_num, email_address))
            count_num = count_num + 1
        except Exception as e:
            print('ç¬¬%dæ¬¡ç»™%så‘é€é‚®ä»¶å¼‚å¸¸' % (count_num, email_address))
            continue
    smt_p.quit()

sender_mail()
```



æ³¨æ„ï¼š
å‘é€é‚®ç®±æ˜¯qqé‚®ç®±ï¼Œæ‰€ä»¥è¦åœ¨qqé‚®ç®±ä¸­è®¾ç½®å¼€å¯SMTPæœåŠ¡ï¼Œè®¾ç½®å®Œæˆæ—¶ä¼šç”Ÿæˆä¸€ä¸ªæˆæƒç ï¼Œå°†è¿™ä¸ªæˆæƒç èµ‹å€¼ç»™æ–‡ä¸­çš„`password`å˜é‡

#### 222 äºŒåˆ†æœç´¢

äºŒåˆ†æœç´¢æ˜¯ç¨‹åºå‘˜å¿…å¤‡çš„ç®—æ³•ï¼Œæ— è®ºä»€ä¹ˆåœºåˆï¼Œéƒ½è¦éå¸¸ç†Ÿç»ƒåœ°å†™å‡ºæ¥ã€‚

å°ä¾‹å­æè¿°ï¼š
åœ¨**æœ‰åºæ•°ç»„**`arr`ä¸­ï¼ŒæŒ‡å®šåŒºé—´`[left,right]`èŒƒå›´å†…ï¼ŒæŸ¥æ‰¾å…ƒç´ `x`
å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›`-1`

äºŒåˆ†æœç´¢`binarySearch`å®ç°çš„ä¸»é€»è¾‘

```python
def binarySearch(arr, left, right, x):
    while left <= right:

        mid = int(left + (right - left) / 2); # æ‰¾åˆ°ä¸­é—´ä½ç½®ã€‚æ±‚ä¸­ç‚¹å†™æˆ(left+right)/2æ›´å®¹æ˜“æº¢å‡ºï¼Œæ‰€ä»¥ä¸å»ºè®®è¿™æ ·å†™

        # æ£€æŸ¥xæ˜¯å¦å‡ºç°åœ¨ä½ç½®mid
        if arr[mid] == x:
            print('found %d åœ¨ç´¢å¼•ä½ç½®%d å¤„' %(x,mid))
            return mid

            # å‡å¦‚xæ›´å¤§ï¼Œåˆ™ä¸å¯èƒ½å‡ºç°åœ¨å·¦åŠéƒ¨åˆ†
        elif arr[mid] < x:
            left = mid + 1 #æœç´¢åŒºé—´å˜ä¸º[mid+1,right]
            print('åŒºé—´ç¼©å°ä¸º[%d,%d]' %(mid+1,right))

        # åŒç†ï¼Œå‡å¦‚xæ›´å°ï¼Œåˆ™ä¸å¯èƒ½å‡ºç°åœ¨å³åŠéƒ¨åˆ†
        elif x<arr[mid]:
            right = mid - 1 #æœç´¢åŒºé—´å˜ä¸º[left,mid-1]
            print('åŒºé—´ç¼©å°ä¸º[%d,%d]' %(left,mid-1))

    # å‡å¦‚æœç´¢åˆ°è¿™é‡Œï¼Œè¡¨æ˜xæœªå‡ºç°åœ¨[left,right]ä¸­
    return -1
```

åœ¨`Ipython`äº¤äº’ç•Œé¢ä¸­ï¼Œè°ƒç”¨`binarySearch`çš„å°Demo:

```python
In [8]: binarySearch([4,5,6,7,10,20,100],0,6,5)
åŒºé—´ç¼©å°ä¸º[0,2]
found 5 at 1
Out[8]: 1

In [9]: binarySearch([4,5,6,7,10,20,100],0,6,4)
åŒºé—´ç¼©å°ä¸º[0,2]
åŒºé—´ç¼©å°ä¸º[0,0]
found 4 at 0
Out[9]: 0

In [10]: binarySearch([4,5,6,7,10,20,100],0,6,20)
åŒºé—´ç¼©å°ä¸º[4,6]
found 20 at 5
Out[10]: 5

In [11]: binarySearch([4,5,6,7,10,20,100],0,6,100)
åŒºé—´ç¼©å°ä¸º[4,6]
åŒºé—´ç¼©å°ä¸º[6,6]
found 100 at 6
Out[11]: 6
```

#### 223 çˆ¬å–å¤©æ°”æ•°æ®å¹¶è§£ææ¸©åº¦å€¼

çˆ¬å–å¤©æ°”æ•°æ®å¹¶è§£ææ¸©åº¦å€¼

ç´ ææ¥è‡ªæœ‹å‹è¢ç»ï¼Œæ„Ÿè°¢ï¼

çˆ¬å–çš„html ç»“æ„

<img src="./img/1.png" width="50%"/>

```python
import requests
from lxml import etree
import pandas as pd
import re

url = 'http://www.weather.com.cn/weather1d/101010100.shtml#input'
with requests.get(url) as res:
    content = res.content
    html = etree.HTML(content)
```



é€šè¿‡lxmlæ¨¡å—æå–å€¼

lxmlæ¯”beautifulsoupè§£æåœ¨æŸäº›åœºåˆæ›´é«˜æ•ˆ

```python
location = html.xpath('//*[@id="around"]//a[@target="_blank"]/span/text()')
temperature = html.xpath('//*[@id="around"]/div/ul/li/a/i/text()')
```

ç»“æœï¼š

```python
['é¦™æ²³', 'æ¶¿å·', 'å”å±±', 'æ²§å·', 'å¤©æ´¥', 'å»ŠåŠ', 'å¤ªåŸ', 'çŸ³å®¶åº„', 'æ¶¿é¹¿', 'å¼ å®¶å£', 'ä¿å®š', 'ä¸‰æ²³', 'åŒ—äº¬å­”åº™', 'åŒ—äº¬å›½å­ç›‘', 'ä¸­å›½åœ°è´¨åšç‰©é¦†', 'æœˆå›å…¬
å›­', 'æ˜åŸå¢™é—å€å…¬å›­', 'åŒ—äº¬å¸‚è§„åˆ’å±•è§ˆé¦†', 'ä»€åˆ¹æµ·', 'å—é”£é¼“å··', 'å¤©å›å…¬å›­', 'åŒ—æµ·å…¬å›­', 'æ™¯å±±å…¬å›­', 'åŒ—äº¬æµ·æ´‹é¦†']

['11/-5Â°C', '14/-5Â°C', '12/-6Â°C', '12/-5Â°C', '11/-1Â°C', '11/-5Â°C', '8/-7Â°C', '13/-2Â°C', '8/-6Â°C', '5/-9Â°C', '14/-6Â°C', '11/-4Â°C', '13/-3Â°C'
, '13/-3Â°C', '12/-3Â°C', '12/-3Â°C', '13/-3Â°C', '12/-2Â°C', '12/-3Â°C', '13/-3Â°C', '12/-2Â°C', '12/-2Â°C', '12/-2Â°C', '12/-3Â°C']
```


æ„é€ DataFrameå¯¹è±¡

```python
df = pd.DataFrame({'location':location, 'temperature':temperature})
print('æ¸©åº¦åˆ—')
print(df['temperature'])
```

æ­£åˆ™è§£ææ¸©åº¦å€¼

```python
df['high'] = df['temperature'].apply(lambda x: int(re.match('(-?[0-9]*?)/-?[0-9]*?Â°C', x).group(1) ) )
df['low'] = df['temperature'].apply(lambda x: int(re.match('-?[0-9]*?/(-?[0-9]*?)Â°C', x).group(1) ) )
print(df)
```

è¯¦ç»†è¯´æ˜å­å­—ç¬¦åˆ›æ•è·

é™¤äº†ç®€å•åœ°åˆ¤æ–­æ˜¯å¦åŒ¹é…ä¹‹å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜æœ‰æå–å­ä¸²çš„å¼ºå¤§åŠŸèƒ½ã€‚ç”¨`()`è¡¨ç¤ºçš„å°±æ˜¯è¦æå–çš„åˆ†ç»„ï¼ˆgroupï¼‰ã€‚æ¯”å¦‚ï¼š`^(\d{3})-(\d{3,8})$`åˆ†åˆ«å®šä¹‰äº†ä¸¤ä¸ªç»„ï¼Œå¯ä»¥ç›´æ¥ä»åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­æå–å‡ºåŒºå·å’Œæœ¬åœ°å·ç 

```python
m = re.match(r'^(\d{3})-(\d{3,8})$', '010-12345')
print(m.group(0))
print(m.group(1))
print(m.group(2))

# 010-12345
# 010
# 12345
```

å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸­å®šä¹‰äº†ç»„ï¼Œå°±å¯ä»¥åœ¨`Match`å¯¹è±¡ä¸Šç”¨`group()`æ–¹æ³•æå–å‡ºå­ä¸²æ¥ã€‚

æ³¨æ„åˆ°`group(0)`æ°¸è¿œæ˜¯åŸå§‹å­—ç¬¦ä¸²ï¼Œ`group(1)`ã€`group(2)`â€¦â€¦è¡¨ç¤ºç¬¬1ã€2ã€â€¦â€¦ä¸ªå­ä¸²ã€‚


æœ€ç»ˆç»“æœ

```kepython
Name: temperature, dtype: object
    location temperature  high  low
0         é¦™æ²³     11/-5Â°C    11   -5
1         æ¶¿å·     14/-5Â°C    14   -5
2         å”å±±     12/-6Â°C    12   -6
3         æ²§å·     12/-5Â°C    12   -5
4         å¤©æ´¥     11/-1Â°C    11   -1
5         å»ŠåŠ     11/-5Â°C    11   -5
6         å¤ªåŸ      8/-7Â°C     8   -7
7        çŸ³å®¶åº„     13/-2Â°C    13   -2
8         æ¶¿é¹¿      8/-6Â°C     8   -6
9        å¼ å®¶å£      5/-9Â°C     5   -9
10        ä¿å®š     14/-6Â°C    14   -6
11        ä¸‰æ²³     11/-4Â°C    11   -4
12      åŒ—äº¬å­”åº™     13/-3Â°C    13   -3
13     åŒ—äº¬å›½å­ç›‘     13/-3Â°C    13   -3
14   ä¸­å›½åœ°è´¨åšç‰©é¦†     12/-3Â°C    12   -3
15      æœˆå›å…¬å›­     12/-3Â°C    12   -3
16   æ˜åŸå¢™é—å€å…¬å›­     13/-3Â°C    13   -3
17  åŒ—äº¬å¸‚è§„åˆ’å±•è§ˆé¦†     12/-2Â°C    12   -2
18       ä»€åˆ¹æµ·     12/-3Â°C    12   -3
19      å—é”£é¼“å··     13/-3Â°C    13   -3
20      å¤©å›å…¬å›­     12/-2Â°C    12   -2
21      åŒ—æµ·å…¬å›­     12/-2Â°C    12   -2
22      æ™¯å±±å…¬å›­     12/-2Â°C    12   -2
23     åŒ—äº¬æµ·æ´‹é¦†     12/-3Â°C    12   -3
```

### åã€æ•°æ®åˆ†æ

æœ¬é¡¹ç›®åŸºäºKaggleç”µå½±å½±è¯„æ•°æ®é›†ï¼Œé€šè¿‡è¿™ä¸ªç³»åˆ—ï¼Œä½ å°†å­¦åˆ°å¦‚ä½•è¿›è¡Œæ•°æ®æ¢ç´¢æ€§åˆ†æ(EDA)ï¼Œå­¦ä¼šä½¿ç”¨æ•°æ®åˆ†æåˆ©å™¨`pandas`ï¼Œä¼šç”¨ç»˜å›¾åŒ…`pyecharts`ï¼Œä»¥åŠEDAæ—¶å¯èƒ½é‡åˆ°çš„å„ç§å®é™…é—®é¢˜åŠä¸€äº›å¤„ç†æŠ€å·§ã€‚



æœ¬é¡¹ç›®éœ€è¦å¯¼å…¥çš„åŒ…ï¼š

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from pyecharts.charts import Bar,Grid,Line
import pyecharts.options as opts
from pyecharts.globals import ThemeType
```

#### 1 åˆ›å»ºDataFrame
pandasä¸­ä¸€ä¸ªdataFrameå®ä¾‹ï¼š
```python
Out[89]:
        a  val
0  apple1  1.0
1  apple2  2.0
2  apple3  3.0
3  apple4  4.0
4  apple5  5.0
```

æˆ‘ä»¬çš„**ç›®æ ‡**æ˜¯å˜ä¸ºå¦‚ä¸‹ç»“æ„ï¼š
```python
a  apple1  apple2  apple3  apple4  apple5
0     1.0     2.0     3.0     4.0     5.0
```

ä¹çœ‹å¯ä½¿ç”¨`pivot`ï¼Œä½†å¾ˆéš¾ä¸€æ­¥åˆ°ä½ã€‚

æ‰€ä»¥å¦è¾Ÿè¹Šå¾„ï¼Œæä¾›ä¸€ç§ç®€å•ä¸”å¥½ç†è§£çš„æ–¹æ³•ï¼š

```python
In [113]: pd.DataFrame(index=[0],columns=df.a,data=dict(zip(df.a,df.val)))
Out[113]:
a  apple1  apple2  apple3  apple4  apple5
0     1.0     2.0     3.0     4.0     5.0
```
ä»¥ä¸Šæ–¹æ³•æ˜¯é‡æ–°åˆ›å»ºä¸€ä¸ªDataFrame,ç›´æ¥æŠŠ`df.a`æ‰€æœ‰å¯èƒ½å–å€¼ä½œä¸ºæ–°dataframeçš„åˆ—ï¼Œindexè°ƒæ•´ä¸º`[0]`ï¼Œæ³¨æ„ç±»å‹å¿…é¡»æ˜¯æ•°ç»„ç±»å‹(array-like æˆ–è€… Index)ï¼Œä¸¤ä¸ªè½´ç¡®å®šåï¼Œ`data`å¡«å……æ•°æ®åŸŸã€‚

```python
In [116]: dict(zip(df.a,df.val))
Out[116]: {'apple1': 1.0, 'apple2': 2.0, 'apple3': 3.0, 'apple4': 4.0, 'apple5': 5.0}
```



#### 2 å¯¼å…¥æ•°æ®
æ•°æ®æ¥è‡ªkaggleï¼Œå…±åŒ…æ‹¬ä¸‰ä¸ªæ–‡ä»¶ï¼š

1. movies.dat
2. ratings.dat
3. users.dat

`movies.dat`åŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼š['Movie ID', 'Movie Title', 'Genre']

ä½¿ç”¨pandaså¯¼å…¥æ­¤æ–‡ä»¶ï¼š

```python
import pandas as pd

movies = pd.read_csv('./data/movietweetings/movies.dat', delimiter='::', engine='python', header=None, names = ['Movie ID', 'Movie Title', 'Genre'])
```

å¯¼å…¥åï¼Œæ˜¾ç¤ºå‰5è¡Œï¼š

```python
   Movie ID                                        Movie Title  \
0         8      Edison Kinetoscopic Record of a Sneeze (1894)   
1        10                La sortie des usines LumiçŒ«re (1895)   
2        12                      The Arrival of a Train (1896)   
3        25  The Oxford and Cambridge University Boat Race ...   
4        91                         Le manoir du diable (1896)   
5       131                           Une nuit terrible (1896)   
6       417                      Le voyage dans la lune (1902)   
7       439                     The Great Train Robbery (1903)   
8       443        Hiawatha, the Messiah of the Ojibway (1903)   
9       628                    The Adventures of Dollie (1908)  
                                          Genre  
0                             Documentary|Short  
1                             Documentary|Short  
2                             Documentary|Short  
3                                           NaN  
4                                  Short|Horror  
5                           Short|Comedy|Horror  
6  Short|Action|Adventure|Comedy|Fantasy|Sci-Fi  
7                    Short|Action|Crime|Western  
8                                           NaN  
9                                  Action|Short  
```



æ¬¡å¯¼å…¥å…¶ä»–ä¸¤ä¸ªæ•°æ®æ–‡ä»¶

`users.dat`:

```python
users = pd.read_csv('./data/movietweetings/users.dat', delimiter='::', engine='python', header=None, names = ['User ID', 'Twitter ID'])
print(users.head())
```

ç»“æœï¼š

```python
   User ID  Twitter ID
0        1   397291295
1        2    40501255
2        3   417333257
3        4   138805259
4        5  2452094989
5        6   391774225
6        7    47317010
7        8    84541461
8        9  2445803544
9       10   995885060
```



`rating.data`:

```python
ratings = pd.read_csv('./data/movietweetings/ratings.dat', delimiter='::', engine='python', header=None, names = ['User ID', 'Movie ID', 'Rating', 'Rating Timestamp'])
print(ratings.head())
```

ç»“æœï¼š

```python
   User ID  Movie ID  Rating  Rating Timestamp
0        1    111161      10        1373234211
1        1    117060       7        1373415231
2        1    120755       6        1373424360
3        1    317919       6        1373495763
4        1    454876      10        1373621125
5        1    790724       8        1374641320
6        1    882977       8        1372898763
7        1   1229238       9        1373506523
8        1   1288558       5        1373154354
9        1   1300854       8        1377165712
```

 **read_csv ä½¿ç”¨è¯´æ˜**

è¯´æ˜ï¼Œæœ¬æ¬¡å¯¼å…¥`dat`æ–‡ä»¶ä½¿ç”¨`pandas.read_csv`å‡½æ•°ã€‚

ç¬¬ä¸€ä¸ªä½ç½®å‚æ•°`./data/movietweetings/ratings.dat` è¡¨ç¤ºæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„

ç¬¬äºŒä¸ªå…³é”®å­—å‚æ•°ï¼š`delimiter='::'`ï¼Œè¡¨ç¤ºæ–‡ä»¶åˆ†éš”ç¬¦ä½¿ç”¨`::`

åé¢å‡ ä¸ªå…³é”®å­—å‚æ•°åˆ†åˆ«ä»£è¡¨ä½¿ç”¨çš„å¼•æ“ï¼Œæ–‡ä»¶æ²¡æœ‰è¡¨å¤´ï¼Œæ‰€ä»¥`header`ä¸º`None;`

å¯¼å…¥ådataframeçš„åˆ—åä½¿ç”¨`names`å…³é”®å­—è®¾ç½®ï¼Œè¿™ä¸ªå‚æ•°å¤§å®¶å¯ä»¥è®°ä½ï¼Œæ¯”è¾ƒæœ‰ç”¨ã€‚



Kaggleç”µå½±æ•°æ®é›†ç¬¬ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®å¤„ç†åˆ©å™¨ `pandas`ï¼Œ å‡½æ•°`read_csv` å¯¼å…¥ç»™å®šçš„ä¸‰ä¸ªæ•°æ®æ–‡ä»¶ã€‚

```python
import pandas as pd

movies = pd.read_csv('./data/movietweetings/movies.dat', delimiter='::', engine='python', header=None, names = ['Movie ID', 'Movie Title', 'Genre'])
users = pd.read_csv('./data/movietweetings/users.dat', delimiter='::', engine='python', header=None, names = ['User ID', 'Twitter ID'])
ratings = pd.read_csv('./data/movietweetings/ratings.dat', delimiter='::', engine='python', header=None, names = ['User ID', 'Movie ID', 'Rating', 'Rating Timestamp'])
```

ç”¨åˆ°çš„`read_csv`ï¼ŒæŸäº›é‡è¦çš„å‚æ•°ï¼Œå¦‚ä½•ä½¿ç”¨åœ¨ä¸Šä¸€èŠ‚ä¹Ÿæœ‰æ‰€æåˆ°ã€‚ä¸‹é¢å¼€å§‹æ•°æ®æ¢ç´¢åˆ†æ(EDA)

> æ‰¾å‡ºå¾—åˆ†å‰10å–œå‰§(comedy)



#### 3 å¤„ç†ç»„åˆå€¼

è¡¨`movies`å­—æ®µ`Genre`è¡¨ç¤ºç”µå½±çš„ç±»å‹ï¼Œå¯èƒ½æœ‰å¤šä¸ªå€¼ï¼Œåˆ†éš”ç¬¦ä¸º`|`ï¼Œå–å€¼ä¹Ÿå¯èƒ½ä¸º`None`.

é’ˆå¯¹è¿™ç±»å­—æ®µå–å€¼ï¼Œå¯ä½¿ç”¨Pandasä¸­Seriesæä¾›çš„`str`åšä¸€æ­¥è½¬åŒ–ï¼Œ**æ³¨æ„å®ƒæ˜¯å‘é‡çº§çš„**ï¼Œä¸‹ä¸€æ­¥ï¼Œå¦‚PythonåŸç”Ÿçš„`str`ç±»ä¼¼ï¼Œä½¿ç”¨`contains`åˆ¤æ–­æ˜¯å¦å«æœ‰`comedy`å­—ç¬¦ä¸²ï¼š

```python
mask = movies.Genre.str.contains('comedy',case=False,na=False)
```

æ³¨æ„ä½¿ç”¨çš„ä¸¤ä¸ªå‚æ•°ï¼š`case`, `na`

caseä¸º Falseï¼Œè¡¨ç¤ºå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼›
na Genreåˆ—æŸä¸ªå•å…ƒæ ¼ä¸º`NaN`æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å……å¡«å€¼ï¼Œæ­¤å¤„å¡«å……ä¸º`False`

è¿”å›çš„`mask`æ˜¯ä¸€ç»´çš„`Series`ï¼Œç»“æ„ä¸ movies.Genreç›¸åŒï¼Œå–å€¼ä¸ºTrue æˆ– False.

è§‚å¯Ÿç»“æœï¼š

```python
0    False
1    False
2    False
3    False
4    False
5     True
6     True
7    False
8    False
9    False
Name: Genre, dtype: bool

```


 #### 4 è®¿é—®æŸåˆ—

å¾—åˆ°æ©ç maskåï¼Œpandaséå¸¸æ–¹ä¾¿åœ°èƒ½æå–å‡ºç›®æ ‡è®°å½•ï¼š

```python
comedy = movies[mask]
comdey_ids = comedy['Movie ID']

```

ä»¥ä¸Šï¼Œåœ¨pandasä¸­è¢«æœ€é¢‘ç‡ä½¿ç”¨ï¼Œä¸å†è§£é‡Šã€‚çœ‹ç»“æœ`comedy_ids.head()`ï¼š

```python
5      131
6      417
15    2354
18    3863
19    4099
20    4100
21    4101
22    4210
23    4395
25    4518
Name: Movie ID, dtype: int64

```



1-4ä»‹ç»`æ•°æ®è¯»å…¥`ï¼Œ`å¤„ç†ç»„åˆå€¼`ï¼Œ`ç´¢å¼•æ•°æ®`ç­‰, pandasä¸­ä½¿ç”¨è¾ƒå¤šçš„å‡½æ•°ï¼ŒåŸºäºKaggleçœŸå®ç”µå½±å½±è¯„æ•°æ®é›†ï¼Œæœ€åå¾—åˆ°æ‰€æœ‰`å–œå‰§ ID`ï¼š

```python
5      131
6      417
15    2354
18    3863
19    4099
20    4100
21    4101
22    4210
23    4395
25    4518
Name: Movie ID, dtype: int64

```

ä¸‹é¢ç»§ç»­æ•°æ®æ¢ç´¢ä¹‹æ—…~

#### 5 è¿æ¥ä¸¤ä¸ªè¡¨

æ‹¿åˆ°æ‰€æœ‰å–œå‰§çš„IDåï¼Œè¦æƒ³æ‰¾å‡ºå…¶ä¸­å¹³å‡å¾—åˆ†æœ€é«˜çš„å‰10å–œå‰§ï¼Œéœ€è¦å…³è”å¦ä¸€å¼ è¡¨ï¼š`ratings`:

å†å›é¡¾ä¸‹ratingsè¡¨ç»“æ„ï¼š

```python
   User ID  Movie ID  Rating  Rating Timestamp
0        1    111161      10        1373234211
1        1    117060       7        1373415231
2        1    120755       6        1373424360
3        1    317919       6        1373495763
4        1    454876      10        1373621125
5        1    790724       8        1374641320
6        1    882977       8        1372898763
7        1   1229238       9        1373506523
8        1   1288558       5        1373154354
9        1   1300854       8        1377165712

```


pandas ä¸­ä½¿ç”¨`join`å…³è”ä¸¤å¼ è¡¨ï¼Œè¿æ¥å­—æ®µæ˜¯`Movie ID`ï¼Œå¦‚æœé¡ºå…¶è‡ªç„¶è¿™ä¹ˆä½¿ç”¨`join`ï¼š

```python
combine = ratings.join(comedy, on='Movie ID', rsuffix='2')

```

å·¦å³æ»‘åŠ¨ï¼ŒæŸ¥çœ‹å®Œæ•´ä»£ç 

å¤§å®¶å¯éªŒè¯è¿™ç§å†™æ³•ï¼Œä»”ç»†ä¸€çœ‹ï¼Œä¼šå‘ç°ç»“æœéå¸¸è¯¡å¼‚ã€‚

ç©¶å…¶åŸå› ï¼Œè¿™æ˜¯pandas joinå‡½æ•°ä½¿ç”¨çš„ä¸€ä¸ªç®—æ˜¯å‘ç‚¹ï¼Œå®ƒåœ¨å®˜æ¡£ä¸­ä»‹ç»ï¼Œè¿æ¥å³è¡¨æ—¶ï¼Œæ­¤å¤„å³è¡¨æ˜¯`comedy`ï¼Œå®ƒçš„`index`è¦æ±‚æ˜¯è¿æ¥å­—æ®µï¼Œä¹Ÿå°±æ˜¯ `Movie ID`. 

å·¦è¡¨çš„indexä¸è¦æ±‚ï¼Œä½†æ˜¯è¦åœ¨å‚æ•° `on`ä¸­ç»™å®šã€‚

**ä»¥ä¸Šæ˜¯è¦æ³¨æ„çš„ä¸€ç‚¹**

ä¿®æ”¹ä¸ºï¼š

```python
combine = ratings.join(comedy.set_index('Movie ID'), on='Movie ID')
print(combine.head(10))

```

ä»¥ä¸Šæ˜¯OKçš„å†™æ³•

è§‚å¯Ÿç»“æœï¼š

```python
   User ID  Movie ID  Rating  Rating Timestamp Movie Title Genre
0        1    111161      10        1373234211         NaN   NaN
1        1    117060       7        1373415231         NaN   NaN
2        1    120755       6        1373424360         NaN   NaN
3        1    317919       6        1373495763         NaN   NaN
4        1    454876      10        1373621125         NaN   NaN
5        1    790724       8        1374641320         NaN   NaN
6        1    882977       8        1372898763         NaN   NaN
7        1   1229238       9        1373506523         NaN   NaN
8        1   1288558       5        1373154354         NaN   NaN
9        1   1300854       8        1377165712         NaN   NaN

```

Genreåˆ—ä¸º`NaN`è¡¨æ˜ï¼Œè¿™ä¸æ˜¯å–œå‰§ã€‚éœ€è¦ç­›é€‰å‡ºæ­¤åˆ—ä¸ä¸º`NaN` çš„è®°å½•ã€‚

#### 6 æŒ‰åˆ—ç­›é€‰

pandasæœ€æ–¹ä¾¿çš„åœ°æ–¹ï¼Œå°±æ˜¯å‘é‡åŒ–è¿ç®—ï¼Œå°½å¯èƒ½å‡å°‘äº†forå¾ªç¯çš„åµŒå¥—ã€‚

æŒ‰åˆ—ç­›é€‰è¿™ç§å¸¸è§éœ€æ±‚ï¼Œè‡ªç„¶å¯ä»¥è½»æ¾åº”å¯¹ã€‚

ä¸ºäº†ç…§é¡¾åˆæ¬¡æ¥è§¦ pandas çš„æœ‹å‹ï¼Œåˆ†ä¸¤æ­¥å»å†™ï¼š

```python
mask = pd.notnull(combine['Genre'])

```

ç»“æœæ˜¯ä¸€åˆ—åªå«`True æˆ– False`çš„å€¼

```python
result = combine[mask]
print(result.head())

```

ç»“æœä¸­ï¼ŒGenreå­—æ®µä¸­è‡³å°‘å«æœ‰ä¸€ä¸ªComedyå­—ç¬¦ä¸²ï¼Œè¡¨æ˜éªŒè¯äº†æˆ‘ä»¬ä»¥ä¸Šæ“ä½œæ˜¯OKçš„ã€‚

```python
    User ID  Movie ID  Rating  Rating Timestamp             Movie Title  \
12        1   1588173       9        1372821281      Warm Bodies (2013)   
13        1   1711425       3        1372604878        21 & Over (2013)   
14        1   2024432       8        1372703553   Identity Thief (2013)   
17        1   2101441       1        1372633473  Spring Breakers (2012)   
28        2   1431045       7        1457733508         Deadpool (2016)   

                             Genre  
12           Comedy|Horror|Romance  
13                          Comedy  
14    Adventure|Comedy|Crime|Drama  
17              Comedy|Crime|Drama  
28  Action|Adventure|Comedy|Sci-Fi  


```



æˆªæ­¢ç›®å‰å·²ç»æ±‚å‡ºæ‰€æœ‰å–œå‰§ç”µå½±`result`ï¼Œå‰5è¡Œå¦‚ä¸‹ï¼ŒGenreä¸­éƒ½å«æœ‰`Comedy`å­—ç¬¦ä¸²ï¼š
```python
    User ID  Movie ID  Rating  Rating Timestamp             Movie Title  \
12        1   1588173       9        1372821281      Warm Bodies (2013)   
13        1   1711425       3        1372604878        21 & Over (2013)   
14        1   2024432       8        1372703553   Identity Thief (2013)   
17        1   2101441       1        1372633473  Spring Breakers (2012)   
28        2   1431045       7        1457733508         Deadpool (2016)   

                             Genre  
12           Comedy|Horror|Romance  
13                          Comedy  
14    Adventure|Comedy|Crime|Drama  
17              Comedy|Crime|Drama  
28  Action|Adventure|Comedy|Sci-Fi  
```



#### 7 æŒ‰ç…§Movie ID åˆ†ç»„

resultä¸­ä¼šæœ‰å¾ˆå¤šè§‚ä¼—å¯¹åŒä¸€éƒ¨ç”µå½±çš„æ‰“åˆ†ï¼Œæ‰€ä»¥è¦æ±‚å¾—åˆ†å‰10çš„å–œå‰§ï¼Œå…ˆæŒ‰ç…§`Movie ID`åˆ†ç»„ï¼Œç„¶åæ±‚å‡ºå¹³å‡å€¼ï¼š
```python
score_as_movie = result.groupby('Movie ID').mean()
```

å‰5è¡Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š
```python
               User ID  Rating  Rating Timestamp
Movie ID                                        
131       34861.000000     7.0      1.540639e+09
417       34121.409091     8.5      1.458680e+09
2354       6264.000000     8.0      1.456343e+09
3863      43803.000000    10.0      1.430439e+09
4099      25084.500000     7.0      1.450323e+09
```

#### 8 æŒ‰ç…§ç”µå½±å¾—åˆ†æ’åº

```python
score_as_movie.sort_values(by='Rating', ascending = False,inplace=True)
score_as_movie
```
å‰5è¡Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š
```python
	User ID	Rating	Rating Timestamp
Movie ID			
7134690	30110.0	10.0	1.524974e+09
416889	1319.0	10.0	1.543320e+09
57840	23589.0	10.0	1.396802e+09
5693562	50266.0	10.0	1.511024e+09
5074	43803.0	10.0	1.428352e+09
```
éƒ½æ˜¯æ»¡åˆ†ï¼Ÿè¿™æœ‰ç‚¹å¥‡æ€ªï¼Œä¼šä¸ä¼šè¿™äº›ç”µå½±éƒ½åªæœ‰å‡ ä¸ªäººè¯„åˆ†ï¼Œç”šè‡³åªæœ‰1ä¸ªï¼Ÿè¯„åˆ†æ ·æœ¬ä¸ªæ•°å¤ªå°‘ï¼Œæ˜¾ç„¶æœ€ç»ˆçš„å¹³å‡åˆ†æ•°ä¸å…·æœ‰å¤ªå¼ºçš„è¯´æœåŠ›ã€‚

æ‰€ä»¥ï¼Œä¸‹é¢è¦è¿›è¡Œæ¯éƒ¨ç”µå½±çš„è¯„åˆ†äººæ•°ç»Ÿè®¡

#### 9 åˆ†ç»„åä½¿ç”¨èšåˆå‡½æ•°

æ ¹æ®`Movie ID`åˆ†ç»„åï¼Œä½¿ç”¨`count`å‡½æ•°ç»Ÿè®¡`æ¯ç»„ä¸ªæ•°`ï¼Œåªä¿ç•™countåˆ—ï¼Œæœ€åå¾—åˆ°`watchs2`:

```python
watchs = result.groupby('Movie ID').agg(['count'])
watchs2 = watchs['Rating']['count']
```
æ‰“å°å‰20è¡Œï¼š
```python
print(watchs2.head(20))
```
ç»“æœï¼š
```python
Movie ID
131      1
417     22
2354     1
3863     1
4099     2
4100     1
4101     1
4210     1
4395     1
4518     1
4546     2
4936     2
5074     1
5571     1
6177     1
6414     3
6684     1
6689     1
7145     1
7162     2
Name: count, dtype: int64
```
æœç„¶ï¼Œç«Ÿç„¶æœ‰è¿™ä¹ˆå¤šç”µå½±çš„è¯„è®ºæ•°åªæœ‰1æ¬¡ï¼æ ·æœ¬ä¸ªæ•°å¤ªå°‘ï¼Œè¯„è®ºçš„å¹³å‡å€¼ä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆè¯´æœåŠ›ã€‚

æŸ¥çœ‹`watchs2`ä¸€äº›é‡è¦ç»Ÿè®¡é‡ï¼š
```python
watchs2.describe()
```
ç»“æœï¼š
```python
count    10740.000000
mean        20.192086
std         86.251411
min          1.000000
25%          1.000000
50%          2.000000
75%          7.000000
max       1843.000000
Name: count, dtype: float64
```
å…±æœ‰10740éƒ¨**å–œå‰§**ç”µå½±è¢«è¯„åˆ†ï¼Œå¹³å‡æ‰“åˆ†æ¬¡æ•°20æ¬¡ï¼Œæ ‡å‡†å·®86ï¼Œ75%çš„ç”µå½±æ ·æœ¬æ‰“åˆ†æ¬¡æ•°å°äº7æ¬¡ï¼Œæœ€å°1æ¬¡ï¼Œæœ€å¤š1843æ¬¡ã€‚

#### 10 é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾

ç»˜åˆ¶è¯„è®ºæ•°çš„é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ï¼Œä¾¿äºæ›´ç›´è§‚çš„è§‚å¯Ÿç”µå½±è¢«è¯„è®ºçš„åˆ†å¸ƒæƒ…å†µã€‚ä¸Šé¢åˆ†æåˆ°ï¼Œ75%çš„ç”µå½±æ‰“åˆ†æ¬¡æ•°å°äº7æ¬¡ï¼Œæ‰€ä»¥ç»˜åˆ¶æ‰“åˆ†æ¬¡æ•°å°äº20æ¬¡çš„ç›´æ–¹å›¾ï¼š

```python
fig = plt.figure(figsize=(12,8))
histn = plt.hist(watchs2[watchs2 <=19],19,histtype='step')
plt.scatter([i+1 for i in range(len(histn[0]))],histn[0])
```

![](./img/20200131094927.jpg)

`histn`å…ƒç¥–è¡¨ç¤ºä¸ªæ•°å’Œå¯¹åº”çš„è¢«åˆ†å‰²çš„åŒºé—´ï¼ŒæŸ¥çœ‹`histn[0]`:
```python
array([4383., 1507.,  787.,  541.,  356.,  279.,  209.,  163.,  158.,
        118.,  114.,   90.,  104.,   81.,   80.,   73.,   62.,   65.,
         52.])
```
```python
sum(histn[0]) # 9222
```
çœ‹åˆ°ç”µå½±è¯„è®ºæ¬¡æ•°1åˆ°19æ¬¡çš„å–œå‰§ç”µå½±9222éƒ¨ï¼Œå…±æœ‰10740éƒ¨å–œå‰§ç”µå½±ï¼Œå¤§çº¦`86%`çš„å–œå‰§ç”µå½±è¯„è®ºæ¬¡æ•°`å°äº20æ¬¡`ï¼Œæœ‰`1518`éƒ¨ç”µå½±è¯„è®ºæ•°ä¸å°äº20æ¬¡ã€‚

æˆ‘ä»¬è‚¯å®šå¸Œæœ›æŒ‘é€‰å‡ºè¢«è¯„è®ºæ¬¡æ•°å°½å¯èƒ½å¤šçš„ç”µå½±ï¼Œå› ä¸ºéš¾å…ä¼šæœ‰æ°´å†›å’Œæ»¥ç«½å……æ•°ç­‰`å¼‚å¸¸è¯„è®º`è¡Œä¸ºã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å‡†ç¡®çš„é‡åŒ–æœ€å°æŠ½æ ·é‡å‘¢ï¼Ÿ



#### 11 æœ€å°æŠ½æ ·é‡

æ ¹æ®ç»Ÿè®¡å­¦çš„çŸ¥è¯†ï¼Œæœ€å°æŠ½æ ·é‡å’ŒZå€¼ã€æ ·æœ¬æ–¹å·®å’Œæ ·æœ¬è¯¯å·®ç›¸å…³ï¼Œä¸‹é¢ç»™å‡ºå…·ä½“çš„æ±‚è§£æœ€å°æ ·æœ¬é‡çš„è®¡ç®—æ–¹æ³•ã€‚

é‡‡ç”¨å¦‚ä¸‹è®¡ç®—å…¬å¼ï¼š

$$ n = \frac{Z^2\sigma^2}{E^2} $$


æ­¤å¤„ï¼Œ$Z$ å€¼å–ä¸º95%çš„ç½®ä¿¡åº¦å¯¹åº”çš„Zå€¼ä¹Ÿå°±æ˜¯1.96ï¼Œæ ·æœ¬è¯¯å·®å–ä¸ºå‡å€¼çš„2.5%.

æ ¹æ®ä»¥ä¸Šå…¬å¼ï¼Œç¼–å†™ä¸‹é¢ä»£ç ï¼š

```python
n3 = result.groupby('Movie ID').agg(['count','mean','std'])
n3r = n3[n3['Rating']['count']>=20]['Rating']
```
åªè®¡ç®—å½±è¯„è¶…è¿‡20æ¬¡ï¼Œä¸”æ»¡è¶³æœ€å°æ ·æœ¬é‡çš„ç”µå½±ã€‚è®¡ç®—å¾—åˆ°çš„`n3r`å‰5è¡Œï¼š
```python
	count	mean	std
Movie ID			
417	22	8.500000	1.263027
12349	68	8.485294	1.227698
15324	20	8.350000	1.039990
15864	51	8.431373	1.374844
17925	44	8.636364	1.259216
```
è¿›ä¸€æ­¥æ±‚å‡ºæœ€å°æ ·æœ¬é‡ï¼š
```python
nmin = (1.96**2*n3r['std']**2) / ( (n3r['mean']*0.025)**2 )
```
`nmin`å‰5è¡Œï¼š
```python
Movie ID
417         135.712480
12349       128.671290
15324        95.349276
15864       163.434005
17925       130.668350
```

ç­›é€‰å‡ºæ»¡è¶³æœ€å°æŠ½æ ·é‡çš„å–œå‰§ç”µå½±ï¼š

```python
n3s = n3r[ n3r['count'] >= nmin ]
```
ç»“æœæ˜¾ç¤ºå¦‚ä¸‹ï¼Œå› æ­¤å…±æœ‰`173`éƒ¨ç”µå½±æ»¡è¶³æœ€å°æ ·æœ¬æŠ½æ ·é‡ã€‚

```python

count	mean	std
Movie ID			
53604	129	8.635659	1.230714
57012	207	8.449275	1.537899
70735	224	8.839286	1.190799
75686	209	8.095694	1.358885
88763	296	8.945946	1.026984
...	...	...	...
6320628	860	7.966279	1.469924
6412452	276	7.510870	1.389529
6662050	22	10.000000	0.000000
6966692	907	8.673649	1.286455
7131622	1102	7.851180	1.751500
173 rows Ã— 3 columns
```

#### 12 å»é‡å’Œè¿è¡¨

æŒ‰ç…§å¹³å‡å¾—åˆ†ä»å¤§åˆ°å°æ’åºï¼š
```python
n3s_sort = n3s.sort_values(by='mean',ascending=False)
```
ç»“æœï¼š
```python
	count	mean	std
Movie ID			
6662050	22	10.000000	0.000000
4921860	48	10.000000	0.000000
5262972	28	10.000000	0.000000
5512872	353	9.985836	0.266123
3863552	199	9.010050	1.163372
...	...	...	...
1291150	647	6.327666	1.785968
2557490	546	6.307692	1.858434
1478839	120	6.200000	0.728761
2177771	485	6.150515	1.523922
1951261	1091	6.083410	1.736127
173 rows Ã— 3 columns
```
ä»…é `Movie ID`è¿˜æ˜¯ä¸çŸ¥é“å“ªäº›ç”µå½±ï¼Œè¿æ¥`movies`è¡¨ï¼š
```python
ms = movies.drop_duplicates(subset=['Movie ID'])
ms = ms.set_index('Movie ID')
n3s_final = n3s_drops.join(ms,on='Movie ID')
```

#### 13 ç»“æœåˆ†æ

å–œå‰§æ¦œå•å‰50åï¼š
```python
Movie Title
Five Minutes (2017)
MSG 2 the Messenger (2015)
Avengers: Age of Ultron Parody (2015)
Be Somebody (2016)
Bajrangi Bhaijaan (2015)
Back to the Future (1985)
La vita éš?bella (1997)
The Intouchables (2011)
The Sting (1973)
Coco (2017)
Toy Story 3 (2010)
3 Idiots (2009)
Green Book (2018)
Dead Poets Society (1989)
The Apartment (1960)
P.K. (2014)
The Truman Show (1998)
Amé‘¼å¨ie (2001)
Inside Out (2015)
Toy Story 4 (2019)
Toy Story (1995)
Finding Nemo (2003)
Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)
Home Alone (1990)
Zootopia (2016)
Up (2009)
Monsters, Inc. (2001)
La La Land (2016)
Relatos salvajes (2014)
En man som heter Ove (2015)
Snatch (2000)
Lock, Stock and Two Smoking Barrels (1998)
How to Train Your Dragon 2 (2014)
As Good as It Gets (1997)
Guardians of the Galaxy (2014)
The Grand Budapest Hotel (2014)
Fantastic Mr. Fox (2009)
Silver Linings Playbook (2012)
Sing Street (2016)
Deadpool (2016)
Annie Hall (1977)
Pride (2014)
In Bruges (2008)
Big Hero 6 (2014)
Groundhog Day (1993)
The Breakfast Club (1985)
Little Miss Sunshine (2006)
Deadpool 2 (2018)
The Terminal (2004)
```

å‰10åè¯„è®ºæ•°å›¾ï¼š

![](./img/2020013109495711.jpg)

ä»£ç ï¼š
```python
x = n3s_final['Movie Title'][:10].tolist()[::-1]
y = n3s_final['count'][:10].tolist()[::-1]
bar = (
    Bar()
    .add_xaxis(x)
    .add_yaxis('è¯„è®ºæ•°',y,category_gap='50%')
    .reversal_axis()
    .set_global_opts(title_opts=opts.TitleOpts(title="å–œå‰§ç”µå½±è¢«è¯„è®ºæ¬¡æ•°"),
                    toolbox_opts=opts.ToolboxOpts(),)
)
grid = (
    Grid(init_opts=opts.InitOpts(theme=ThemeType.LIGHT))
    .add(bar, grid_opts=opts.GridOpts(pos_left="30%"))
)
grid.render_notebook()
```

å‰10åå¾—åˆ†å›¾ï¼š

![](./img/2020013109500812.jpg)

ä»£ç ï¼š
```python
x = n3s_final['Movie Title'][:10].tolist()[::-1]
y = n3s_final['mean'][:10].round(3).tolist()[::-1]
bar = (
    Bar()
    .add_xaxis(x)
    .add_yaxis('å¹³å‡å¾—åˆ†',y,category_gap='50%')
    .reversal_axis()
    .set_global_opts(title_opts=opts.TitleOpts(title="å–œå‰§ç”µå½±å¹³å‡å¾—åˆ†"),
                    xaxis_opts=opts.AxisOpts(min_=8.0,name='å¹³å‡å¾—åˆ†'),
                    toolbox_opts=opts.ToolboxOpts(),)
)
grid = (
    Grid(init_opts=opts.InitOpts(theme=ThemeType.MACARONS))
    .add(bar, grid_opts=opts.GridOpts(pos_left="30%"))
)
grid.render_notebook()
```



#### 14 ç”Ÿæˆå“‘å˜é‡

åˆ†ç±»å˜é‡çš„æ•°å€¼åŒ–ï¼Œæ˜¯æŒ‡å°†æšä¸¾ç±»å˜é‡è½¬åŒ–ä¸ºindicatorå˜é‡æˆ–ç§°dummyå˜é‡ã€‚

é‚£ä¹ˆä»€ä¹ˆæ˜¯`indicatorå˜é‡`ï¼Œçœ‹çœ‹å¦‚ä¸‹ä¾‹å­ï¼ŒAå˜é‡è§£æä¸ºï¼š`[1,0,0]`, Bè§£æä¸ºï¼š`[0,1,0]`, Cè§£æä¸ºï¼š`[0,0,1]`
```python
In [8]: s = pd.Series(list('ABCA'))
In [9]: pd.get_dummies(s)
Out[9]:
   A  B  C
0  1  0  0
1  0  1  0
2  0  0  1
3  1  0  0
```

å¦‚æœè¾“å…¥çš„å­—ç¬¦æœ‰4ä¸ªå”¯ä¸€å€¼ï¼Œçœ‹åˆ°å­—ç¬¦aè¢«è§£æä¸º[1,0,0,0]ï¼Œå‘é‡é•¿åº¦ä¸º4.

```python
In [5]: s = pd.Series(list('abaccd'))
In [6]: pd.get_dummies(s)
Out[6]:
   a  b  c  d
0  1  0  0  0
1  0  1  0  0
2  1  0  0  0
3  0  0  1  0
4  0  0  1  0
5  0  0  0  1
```

ä¹Ÿå°±æ˜¯è¯´dummyå‘é‡çš„é•¿åº¦ç­‰äºè¾“å…¥å­—ç¬¦ä¸²ä¸­ï¼Œå”¯ä¸€å­—ç¬¦çš„ä¸ªæ•°ã€‚

#### 15 è®¨åŒçš„SettingWithCopyWarningï¼ï¼ï¼

Pandas å¤„ç†æ•°æ®ï¼Œå¤ªå¥½ç”¨äº†ï¼Œè°ç”¨è°çŸ¥é“ï¼

ä½¿ç”¨è¿‡ Pandas çš„ï¼Œå‡ ä¹éƒ½ä¼šé‡åˆ°ä¸€ä¸ªè­¦å‘Šï¼š

*SettingWithCopyWarning*

éå¸¸çƒ¦äººï¼

å°¤å…¶æ˜¯åˆšæ¥è§¦ Pandas çš„ï¼Œå®Œå…¨ä¸ç†è§£ä¸ºä»€ä¹ˆå¼¹å‡ºè¿™ä¹ˆä¸€ä¸²ï¼š

```python
d:\source\test\settingwithcopy.py:9: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy 
```

å½’æ ¹ç»“åº•ï¼Œæ˜¯å› ä¸ºä»£ç ä¸­å‡ºç°`é“¾å¼æ“ä½œ`...

æœ‰äººå°±é—®äº†ï¼Œä»€ä¹ˆæ˜¯`é“¾å¼æ“ä½œ`?

è¿™æ ·çš„ï¼š

```python
tmp = df[df.a<4]
tmp['c'] = 200
```

å…ˆè®°ä½è¿™ä¸ªæœ€å…¸å‹çš„æƒ…å†µï¼Œå³å¯ï¼

æœ‰çš„äººå°±é—®äº†ï¼šå‡ºç°è¿™ä¸ª Warning, éœ€è¦ç†ä¼šå®ƒå—ï¼Ÿ 

å¦‚æœç»“æœä¸å¯¹ï¼Œå½“ç„¶è¦ç†ä¼šï¼›å¦‚æœç»“æœå¯¹ï¼Œä¸care.

ä¸¾ä¸ªä¾‹å­~~

```python
import pandas as  pd

df = pd.DataFrame({'a':[1,3,5],'b':[4,2,7]},index=['a','b','c'])
df.loc[df.a<4,'c'] = 100
print(df)
print('it\'s ok')

tmp = df[df.a<4]
tmp['c'] = 200
print('-----tmp------')
print(tmp)
print('-----df-------')
print(df)
```

è¾“å‡ºç»“æœï¼š
```python
   a  b      c
a  1  4  100.0
b  3  2  100.0
c  5  7    NaN
it's ok
d:\source\test\settingwithcopy.py:9: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy     
  tmp['c'] = 200
-----tmp------
   a  b    c
a  1  4  200
b  3  2  200
-----df-------
   a  b      c
a  1  4  100.0
b  3  2  100.0
c  5  7    NaN
```

it's ok è¡Œåé¢çš„å‘ç”Ÿé“¾å¼èµ‹å€¼ï¼Œå¯¼è‡´ç»“æœé”™è¯¯ã€‚å› ä¸º tmp å˜äº†ï¼Œdf æ²¡èµ‹ä¸Šå€¼å•Šï¼Œæ‰€ä»¥å¿…é¡»ç†ä¼šã€‚

it's ok è¡Œå‰çš„æ˜¯æ­£è§£ã€‚

ä»¥ä¸Šï¼Œé“¾å¼æ“ä½œå°½é‡é¿å…ï¼Œå¦‚ä½•é¿å…ï¼Ÿå¤šä½¿ç”¨ `.loc[row_indexer,col_indexer]`ï¼Œæç¤ºå‘Šè¯‰æˆ‘ä»¬çš„~

#### 16 NumPy æ•°æ®å½’ä¸€åŒ–ã€åˆ†å¸ƒå¯è§†åŒ–

ä»…ä½¿ç”¨ `NumPy`ï¼Œä¸‹è½½æ•°æ®ï¼Œå½’ä¸€åŒ–ï¼Œä½¿ç”¨ `seaborn` å±•ç¤ºæ•°æ®åˆ†å¸ƒã€‚

**ä¸‹è½½æ•°æ®**

```python
import numpy as np

url = 'https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data'
wid = np.genfromtxt(url, delimiter=',', dtype='float', usecols=[1])
```
ä»…æå– `iris` æ•°æ®é›†çš„ç¬¬äºŒåˆ— `usecols = [1]`

**å±•ç¤ºæ•°æ®**

```python
array([3.5, 3. , 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3. ,
       3. , 4. , 4.4, 3.9, 3.5, 3.8, 3.8, 3.4, 3.7, 3.6, 3.3, 3.4, 3. ,
       3.4, 3.5, 3.4, 3.2, 3.1, 3.4, 4.1, 4.2, 3.1, 3.2, 3.5, 3.1, 3. ,
       3.4, 3.5, 2.3, 3.2, 3.5, 3.8, 3. , 3.8, 3.2, 3.7, 3.3, 3.2, 3.2,
       3.1, 2.3, 2.8, 2.8, 3.3, 2.4, 2.9, 2.7, 2. , 3. , 2.2, 2.9, 2.9,
       3.1, 3. , 2.7, 2.2, 2.5, 3.2, 2.8, 2.5, 2.8, 2.9, 3. , 2.8, 3. ,
       2.9, 2.6, 2.4, 2.4, 2.7, 2.7, 3. , 3.4, 3.1, 2.3, 3. , 2.5, 2.6,
       3. , 2.6, 2.3, 2.7, 3. , 2.9, 2.9, 2.5, 2.8, 3.3, 2.7, 3. , 2.9,
       3. , 3. , 2.5, 2.9, 2.5, 3.6, 3.2, 2.7, 3. , 2.5, 2.8, 3.2, 3. ,
       3.8, 2.6, 2.2, 3.2, 2.8, 2.8, 2.7, 3.3, 3.2, 2.8, 3. , 2.8, 3. ,
       2.8, 3.8, 2.8, 2.8, 2.6, 3. , 3.4, 3.1, 3. , 3.1, 3.1, 3.1, 2.7,
       3.2, 3.3, 3. , 2.5, 3. , 3.4, 3. ])
      
```

è¿™æ˜¯å•å˜é‡(univariate)é•¿åº¦ä¸º 150 çš„ä¸€ç»´ NumPy æ•°ç»„ã€‚

**å½’ä¸€åŒ–**

æ±‚å‡ºæœ€å¤§å€¼ã€æœ€å°å€¼
```python
smax = np.max(wid)
smin = np.min(wid)

In [51]: smax,smin
Out[51]: (4.4, 2.0)
````
å½’ä¸€åŒ–å…¬å¼ï¼š
```python
s = (wid - smin) / (smax - smin)
```
åªæ‰“å°å°æ•°ç‚¹åä¸‰ä½è®¾ç½®ï¼š
```python
np.set_printoptions(precision=3)  
```

å½’ä¸€åŒ–ç»“æœï¼š
```markdown
array([0.625, 0.417, 0.5  , 0.458, 0.667, 0.792, 0.583, 0.583, 0.375,
       0.458, 0.708, 0.583, 0.417, 0.417, 0.833, 1.   , 0.792, 0.625,
       0.75 , 0.75 , 0.583, 0.708, 0.667, 0.542, 0.583, 0.417, 0.583,
       0.625, 0.583, 0.5  , 0.458, 0.583, 0.875, 0.917, 0.458, 0.5  ,
       0.625, 0.458, 0.417, 0.583, 0.625, 0.125, 0.5  , 0.625, 0.75 ,
       0.417, 0.75 , 0.5  , 0.708, 0.542, 0.5  , 0.5  , 0.458, 0.125,
       0.333, 0.333, 0.542, 0.167, 0.375, 0.292, 0.   , 0.417, 0.083,
       0.375, 0.375, 0.458, 0.417, 0.292, 0.083, 0.208, 0.5  , 0.333,
       0.208, 0.333, 0.375, 0.417, 0.333, 0.417, 0.375, 0.25 , 0.167,
       0.167, 0.292, 0.292, 0.417, 0.583, 0.458, 0.125, 0.417, 0.208,
       0.25 , 0.417, 0.25 , 0.125, 0.292, 0.417, 0.375, 0.375, 0.208,
       0.333, 0.542, 0.292, 0.417, 0.375, 0.417, 0.417, 0.208, 0.375,
       0.208, 0.667, 0.5  , 0.292, 0.417, 0.208, 0.333, 0.5  , 0.417,
       0.75 , 0.25 , 0.083, 0.5  , 0.333, 0.333, 0.292, 0.542, 0.5  ,
       0.333, 0.417, 0.333, 0.417, 0.333, 0.75 , 0.333, 0.333, 0.25 ,
       0.417, 0.583, 0.458, 0.417, 0.458, 0.458, 0.458, 0.292, 0.5  ,
       0.542, 0.417, 0.208, 0.417, 0.583, 0.417])
```

**åˆ†å¸ƒå¯è§†åŒ–**

```python
import seaborn as sns
sns.distplot(s,kde=False,rug=True)
```
é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ï¼š


![](https://imgkr.cn-bj.ufileos.com/49bf5190-429c-4172-a53c-e3f6b66d4e64.png)


```python
sns.distplot(s,hist=True,kde=True,rug=True)
```
å¸¦é«˜æ–¯å¯†åº¦æ ¸å‡½æ•°çš„ç›´æ–¹å›¾ï¼š

![](https://imgkr.cn-bj.ufileos.com/4e4a72a5-8f59-4893-b435-e4b57e22a18e.png)



**åˆ†å¸ƒ fit å›¾**

æ‹¿ `gamma` åˆ†å¸ƒå» fit ï¼š
```python
from scipy import stats
sns.distplot(s, kde=False, fit = stats.gamma)
```



![](https://imgkr.cn-bj.ufileos.com/89446755-7420-4f96-97fe-c4e45d0d3dec.png)


æ‹¿åŒ `gamma` å» fitï¼š
```python
from scipy import stats
sns.distplot(s, kde=False, fit = stats.dgamma)
```

![](https://imgkr.cn-bj.ufileos.com/f2c2a660-5433-4b4f-ad7b-d01da4121319.png)

#### 17 Pandas ä½¿ç”¨æŠ€å·§

å¯¹äºåŠ¨è¾„å°±å‡ åæˆ–å‡ ç™¾ä¸ª G çš„æ•°æ®ï¼Œåœ¨è¯»å–çš„è¿™ä¹ˆå¤§æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•éšæœºé€‰å–ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Œç„¶åè¯»å…¥å†…å­˜ï¼Œå¿«é€Ÿäº†è§£æ•°æ®å’Œå¼€å±• EDA ï¼Ÿ

ä½¿ç”¨ Pandas çš„ skiprows å’Œ æ¦‚ç‡çŸ¥è¯†ï¼Œå°±èƒ½åšåˆ°ã€‚

ä¸‹é¢è§£é‡Šå…·ä½“æ€ä¹ˆåšã€‚

å¦‚ä¸‹æ‰€ç¤ºï¼Œè¯»å–æŸ 100 G å¤§å°çš„ big_data.csv æ•°æ®

1) ä½¿ç”¨ skiprows å‚æ•°ï¼Œ

2) x > 0 ç¡®ä¿é¦–è¡Œè¯»å…¥ï¼Œ 

3) np.random.rand() > 0.01 è¡¨ç¤º 99% çš„æ•°æ®éƒ½ä¼šè¢«éšæœºè¿‡æ»¤æ‰

è¨€å¤–ä¹‹æ„ï¼Œåªæœ‰å…¨éƒ¨æ•°æ®çš„ 1% æ‰æœ‰æœºä¼šé€‰å…¥å†…å­˜ä¸­ã€‚

```python
import pandas as pd
import numpy as np

df = pd.read_csv("big_data.csv", 
skiprows = 
lambda x: x>0 and np.random.rand() > 0.01)

print("The shape of the df is {}. 
It has been reduced 100 times!".format(df.shape))
```

ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œè¯»å–çš„æ•°æ®é‡è¿…é€Ÿç¼©å‡åˆ°åŸæ¥çš„ 1% ï¼Œå¯¹äºè¿…é€Ÿå±•å¼€æ•°æ®åˆ†ææœ‰ä¸€å®šçš„å¸®åŠ©ã€‚

### åä¸€ã€ä¸€æ­¥ä¸€æ­¥æŒæ¡Flask webå¼€å‘

#### 1 Flaskç‰ˆ hello world

Flaskæ˜¯Pythonè½»é‡çº§webæ¡†æ¶ï¼Œå®¹æ˜“ä¸Šæ‰‹ï¼Œè¢«å¹¿å¤§Pythonå¼€å‘è€…æ‰€å–œçˆ±ã€‚

ä»Šå¤©æˆ‘ä»¬å…ˆä»hello worldå¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æŒæ¡Flask webå¼€å‘ã€‚ä¾‹å­å›æ˜¯Flaskæ¡†æ¶çš„å°ç™½ï¼Œæ¥ä¸‹æ¥ä¸è¯»è€…æœ‹å‹ä»¬ï¼Œä¸€èµ·å­¦ä¹ è¿™ä¸ªå¯¹æˆ‘è€Œè¨€çš„æ–°æ¡†æ¶ï¼Œå¤§å®¶å¤šå¤šæŒ‡å¯¼ã€‚

é¦–å…ˆ`pip install Flask`,å®‰è£…Flaskï¼Œç„¶åimport Flaskï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ª `app`
```python
from flask import Flask

App = Flask(__name__)
```

å†™ä¸€ä¸ªindexé¡µçš„å…¥å£å‡½æ•°ï¼Œè¿”å›hello world.

é€šè¿‡è£…é¥°å™¨ï¼šApp.route('/')åˆ›å»ºindexé¡µçš„è·¯ç”±æˆ–åœ°å€ï¼Œä¸€ä¸ª`/`è¡¨ç¤ºindexé¡µï¼Œä¹Ÿå°±æ˜¯ä¸»é¡µã€‚

```python
@App.route('/')
def index():
    return "hello world"
```

è°ƒç”¨ `index`å‡½æ•°:
```python
if __name__ == "__main__":
    App.run(debug=True)
```

ç„¶åå¯åŠ¨ï¼Œä¼šåœ¨consoleä¸‹çœ‹åˆ°å¦‚ä¸‹å¯åŠ¨ä¿¡æ¯ï¼Œè¡¨æ˜`æœåŠ¡å¯åŠ¨æˆåŠŸ`ã€‚
```python
* Debug mode: on
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 663-788-611
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
```

 æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œç›¸å½“äºå¯åŠ¨å®¢æˆ·ç«¯ï¼Œå¹¶åœ¨Urlæ ä¸­è¾“å…¥ï¼š`http://127.0.0.1:5000/`ï¼Œçœ‹åˆ°é¡µé¢ä¸Šç­”åº”å‡º`hello world`ï¼Œè¯æ˜æœåŠ¡è®¿é—®æˆåŠŸã€‚

 åŒæ—¶åœ¨æœåŠ¡ç«¯åå°çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼Œè¡¨ç¤ºå¤„ç†ä¸€æ¬¡æ¥è‡ªå®¢æˆ·ç«¯çš„`get`è¯·æ±‚ã€‚
 ```python
 27.0.0.1 - - [03/Feb/2020 21:26:50] "GET / HTTP/1.1" 200 -
 ```

 ä»¥ä¸Šå°±æ˜¯flaskçš„hello world ç‰ˆ

#### 2 Flaskä¹‹æ•°æ®å…¥åº“æ“ä½œ

æ•°æ®æŒä¹…åŒ–å°±æ˜¯å°†æ•°æ®å†™å…¥åˆ°æ•°æ®åº“å­˜å‚¨çš„è¿‡ç¨‹ã€‚

æœ¬ä¾‹å­ä½¿ç”¨`sqlite3`æ•°æ®åº“ã€‚

1)å¯¼å…¥`sqlite3`ï¼Œæœªå®‰è£…å‰ä½¿ç”¨å‘½ä»¤`pip install sqlite3`

åˆ›å»ºä¸€ä¸ª`py`æ–‡ä»¶ï¼š`sqlite3_started.py`ï¼Œå¹¶å†™ä¸‹ç¬¬ä¸€è¡Œä»£ç ï¼š
```python
import sqlite3
```
2)æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å®ä¾‹`db`, å‘½å`test.db`

3)åˆ›å»ºä¸æ•°æ®åº“å®ä¾‹`test.db`çš„è¿æ¥:
```python
conn = sqlite3.connect("test.db")
```

4)æ‹¿åˆ°è¿æ¥`conn`çš„cursor
```python
c = conn.cursor()
```

5)åˆ›å»ºç¬¬ä¸€å¼ è¡¨`books`

å…±æœ‰å››ä¸ªå­—æ®µï¼š`id`,`sort`,`name`,`price`ï¼Œç±»å‹åˆ†åˆ«ä¸ºï¼š`int`,`int`,`text`,`real`. å…¶ä¸­`id`ä¸º`primary key`. ä¸»é”®çš„å–å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„(`unique`)ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚


```python
c.execute('''CREATE TABLE books
      (id int primary key,
       sort int,
       name text,
       price real)''')
```
ç¬¬ä¸€æ¬¡æ‰§è¡Œä¸Šé¢è¯­å¥ï¼Œè¡¨`books`åˆ›å»ºå®Œæˆã€‚å½“å†æ¬¡æ‰§è¡Œæ—¶ï¼Œå°±ä¼šæŠ¥`é‡å¤å»ºè¡¨`çš„é”™è¯¯ã€‚éœ€è¦ä¼˜åŒ–è„šæœ¬ï¼Œæ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨`IF NOT EXISTS books`ï¼Œä¸å­˜åœ¨å†åˆ›å»ºï¼š
```python
c.execute('''CREATE TABLE IF NOT EXISTS books
      (id int primary key,
       sort int,
       name text,
       price real)''')
```

6)æ’å…¥ä¸€è¡Œè®°å½•

å…±ä¸º4ä¸ªå­—æ®µèµ‹å€¼

```python
c.execute('''INSERT INTO books VALUES
       (1, 
       1, 
       'computer science',
       39.0)''')
```

7)ä¸€æ¬¡æ’å…¥å¤šè¡Œè®°å½•

å…ˆåˆ›å»ºä¸€ä¸ªlist:`books`ï¼Œä½¿ç”¨`executemany`ä¸€æ¬¡æ’å…¥å¤šè¡Œã€‚
```python
books = [(2, 2, 'Cook book', 68),
         (3, 2, 'Python intro', 89),
         (4, 3, 'machine learning', 59),
         ]


c.executemany('INSERT INTO books VALUES (?, ?, ?, ?)', books)
```

8)æäº¤

æäº¤åæ‰ä¼šçœŸæ­£ç”Ÿæ•ˆï¼Œå†™å…¥åˆ°æ•°æ®åº“

```python
conn.commit()
```

9)å…³é—­æœŸåˆå»ºç«‹çš„è¿æ¥conn

åŠ¡å¿…è®°ä½æ‰‹åŠ¨å…³é—­ï¼Œå¦åˆ™ä¼šå‡ºç°å†…å­˜æ³„æ¼
```python
conn.close()
print('Done')
```

10)æŸ¥çœ‹ç»“æœ
ä¾‹å­å›ä½¿ç”¨`vs code`ï¼Œåœ¨æ‰©å±•åº“ä¸­é€‰æ‹©ï¼š`SQLite`å®‰è£…ã€‚

![image-20200208211721377](./img/image-20200208211721377.png)

æ–°å»ºä¸€ä¸ª`sq`æ–‡ä»¶ï¼š`a.sql`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```sql
SELECT * from books 
```
å³é”®`run query`ï¼Œå¾—åˆ°è¡¨`books`æ’å…¥çš„4è¡Œè®°å½•å¯è§†åŒ–å›¾ï¼š

![image-20200208211806853](./img/image-20200208211806853.png)

ä»¥ä¸Šåæ­¥å°±æ˜¯sqlite3å†™å…¥æ•°æ®åº“çš„ä¸»è¦æ­¥éª¤ï¼Œä½œä¸ºFlaskç³»åˆ—çš„ç¬¬äºŒç¯‡ï¼Œä¸ºåé¢çš„å‰ç«¯è®²è§£æ‰“ä¸‹åŸºç¡€ã€‚

#### 3 Flaskå„å±‚è°ƒç”¨å…³ç³»

è¿™ç¯‡ä»‹ç»Flaskå’ŒB/Sæ¨¡å¼ï¼Œå³æµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼Œæ˜¯æ¥ä¸‹æ¥å¿«é€Ÿç†è§£Flaskä»£ç çš„å…³é”®ç†è®ºç¯‡ï¼š**ç†è§£Viewsã€modelså’Œæ¸²æŸ“æ¨¡æ¿å±‚çš„è°ƒç”¨å…³ç³»**ã€‚

1) å‘å‡ºè¯·æ±‚

å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥æŸä¸ªåœ°å€ï¼ŒæŒ‰å›è½¦åï¼Œå®Œæˆç¬¬ä¸€æ­¥ã€‚

2) è§†å›¾å±‚ viewsæ¥æ”¶1)æ­¥å‘å‡ºçš„è¯·æ±‚ï¼ŒFlaskä¸­ä½¿ç”¨è§£é‡Šå™¨çš„æ–¹å¼å¤„ç†è¿™ä¸ªæ±‚æƒ…ï¼Œå®ä¾‹ä»£ç å¦‚ä¸‹ï¼Œå®ƒé€šå¸¸æ¶‰åŠåˆ°è°ƒç”¨modelså±‚å’Œæ¨¡æ¿æ–‡ä»¶å±‚

```python
@main_blue.route('/', methods=['GET', 'POST'])
def index():
    form = TestForm()
    print('test')
```

3) modelså±‚ä¼šè´Ÿè´£åˆ›å»ºæ•°æ®æ¨¡å‹ï¼Œæ‰§è¡ŒCRUDæ“ä½œ

4) æ¨¡æ¿æ–‡ä»¶å±‚å¤„ç†htmlæ¨¡æ¿

5) ç»„åˆåè¿”å›html

6) modelså±‚å’Œhtmlæ¨¡æ¿ç»„åˆåè¿”å›ç»™viewså±‚

7ï¼‰æœ€åviewså±‚å“åº”å¹¶æ¸²æŸ“åˆ°æµè§ˆå™¨é¡µé¢ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°è¯·æ±‚çš„é¡µé¢ã€‚

å®Œæ•´è¿‡ç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20200211152007983](./img/image-20200211152007983.png)

è¯»è€…æœ‹å‹ä»¬ï¼Œå¦‚æœä½ å’Œä¾‹å­å›ä¸€æ ·éƒ½æ˜¯åˆå­¦Flaskç¼–ç¨‹ï¼Œéœ€è¦å¥½å¥½ç†è§£ä¸Šé¢çš„è¿‡ç¨‹ã€‚ç†è§£è¿™äº›å¯¹äºæ¥ä¸‹æ¥çš„ç¼–ç¨‹ä¼šæœ‰ä¸€å®šçš„ç†è®ºæŒ‡å¯¼ï¼Œæ–¹å‘æ€§æŒ‡å¯¼ä»·å€¼ã€‚



#### 4 Flaskä¹‹è¡¨å•æ“ä½œ

**1 å¼€ç¯‡**

å…ˆè¯´ä¸€äº›å…³äºFlaskçš„åŸºæœ¬çŸ¥è¯†ï¼Œç°åœ¨ä¸ç†Ÿæ‚‰å®ƒä»¬ï¼Œå¹¶ä¸ä¼šå½±å“å¯¹æœ¬ç¯‡çš„ç†è§£å’ŒæŒæ¡ã€‚

Flaskæ˜¯ä¸€ä¸ªåŸºäºPythonå¼€å‘ï¼Œä¾èµ–`jinja2`æ¨¡æ¿å’Œ`Werkzeug` WSGIæœåŠ¡çš„ä¸€ä¸ªå¾®å‹æ¡†æ¶ã€‚

`Werkzeug`ç”¨æ¥å¤„ç†SocketæœåŠ¡ï¼Œå…¶åœ¨Flaskä¸­è¢«ç”¨äºæ¥å—å’Œå¤„ç†httpè¯·æ±‚ï¼›`Jinja2`è¢«ç”¨æ¥å¯¹æ¨¡æ¿è¿›è¡Œå¤„ç†ï¼Œå°†`æ¨¡æ¿`å’Œ`æ•°æ®`è¿›è¡Œæ¸²æŸ“ï¼Œè¿”å›ç»™ç”¨æˆ·çš„æµè§ˆå™¨ã€‚

è¿™åˆ°è¿™äº›ï¼Œå¯¹äºç†è§£åé¢è°ƒè¯•å‡ºç°çš„ä¸¤ä¸ªé—®é¢˜ä¼šæœ‰å¸®åŠ©ï¼Œä¸è¿‡ä¸ç†Ÿæ‚‰ä»ç„¶æ²¡æœ‰å…³ç³»ã€‚

**2 åŸºæœ¬è¡¨å•**

é¦–å…ˆå¯¼å…¥æ‰€éœ€æ¨¡å—ï¼š

```python
from wtforms import StringField,PasswordField, BooleanField, SubmitField
from flask_wtf import FlaskForm
```

`wtforms`å’Œ`flask_wtf`æ˜¯flaskåˆ›å»ºwebè¡¨å•ç±»å¸¸ç”¨çš„åŒ…ã€‚

å…·ä½“åˆ›å»ºè¡¨å•ç±»çš„æ–¹æ³•å¦‚ä¸‹ï¼Œç™»å…¥è¡¨å•`LoginForm`ç»§æ‰¿è‡ª`FlaskForm`.

åˆ†åˆ«åˆ›å»º`StringFiled`å®ä¾‹ç”¨æˆ·åè¾“å…¥æ¡†`user_name`ï¼Œå¯†ç æ¡†`password`ï¼Œå‹¾é€‰æ¡†`remember_me`å’Œæäº¤æŒ‰é’®`submit`.

```python
class LoginForm(FlaskForm):
    user_name = StringField()
    password = PasswordField()
    remember_me = BooleanField(label='è®°ä½æˆ‘')
    submit = SubmitField('Submit')
```

è‡³æ­¤è¡¨å•ç±»å¯¹è±¡åˆ›å»ºå®Œæ¯•

**3 htmlæ¨¡æ¿**

ä½¿ç”¨`Bootstrap`. å®ƒæ˜¯ç”±Twitteræ¨å‡ºçš„ä¸€ä¸ªç”¨äºå‰ç«¯å¼€å‘çš„å¼€æºå·¥å…·åŒ…ï¼Œç»™äºˆHTMLã€CSSã€JavaScriotï¼Œæä¾›ç®€æ´ã€ç›´è§‚ã€å¼ºæ‚çš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œæ˜¯ç›®å‰æœ€å—ç¯å¢ƒçš„å‰ç«¯æ¡†æ¶ã€‚

`flak_bootstrap`æä¾›ä½¿ç”¨çš„æ¥å£ã€‚æ–¹æ³•å¦‚ä¸‹ï¼Œé¦–å…ˆ`pip install bootstrap`ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå®ä¾‹`bootstrap`.

```python
from flask_bootstrap import Bootstrap
bootstrap = Bootstrap()
```

ç„¶ååˆ›å»º`index.html`æ–‡ä»¶ï¼Œç¬¬ä¸€è¡Œå¯¼å…¥åˆ›å»ºçš„Bootstrapå®ä¾‹`bootstrap`ï¼š

```python
{% import  "bootstrap/wtf.html" as wtf %}
```

å†åˆ›å»ºç¬¬2èŠ‚ä¸­åˆ›å»ºçš„`LoginForm`å®ä¾‹`form`ï¼Œè°ƒç”¨æ¸²æŸ“æ¨¡æ¿æ–¹æ³•ï¼Œå‚æ•°`form`èµ‹å€¼ä¸ºå®ä¾‹`form`:

```python
from flask import render_template
form = LoginForm()
render_template('index.html', form=form)
```

å†åœ¨index.htmlè¾“å…¥ä»¥ä¸‹ä»£ç ï¼Œ`{{ wtf.quick_form(form) }}`å°†å®ä¾‹`form`æ¸²æŸ“åˆ°htmlé¡µé¢ä¸­ã€‚

```python
<div class="container">
    <h3>ç³»ç»Ÿç™»å…¥</h3>
    <div class="col-md-4">
        {{ wtf.quick_form(form) }}
    </div>
</div>
```

**4 indexé¡µé¢è·¯ç”±**

`flask_wtf`åˆ›å»ºçš„formï¼Œå°è£…æ–¹æ³•`validate_on_submit`ï¼Œå…·æœ‰è¡¨å•éªŒè¯åŠŸèƒ½ã€‚

```python
@app.route('/', methods=['GET', 'POST'])
def index():
    form = LoginForm()
    if form.validate_on_submit():
        print(form.data['user_name'])
        return redirect(url_for('print_success'))

    return render_template('index.html', form=form)
```

éªŒè¯é€šè¿‡è·³è½¬åˆ°`print_success`æ–¹æ³•ç»ˆç«¯ç‚¹ï¼š

```python
@app.route('/success')
def print_success():
    return"è¡¨å•éªŒè¯é€šè¿‡"
```

**5 å®Œæ•´ä»£ç **

å…±æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼šä¸€ä¸ªpyï¼Œä¸€ä¸ªhtml:

```python
from flask import Flask
from flask import render_template, redirect, url_for
from wtforms import StringField,PasswordField, BooleanField, SubmitField
from flask_wtf import FlaskForm
from flask_bootstrap import Bootstrap

bootstrap = Bootstrap()

app = Flask(__name__)
app.config['SECRET_KEY']  = "hard_to_guess_secret_key$$#@"

bootstrap.init_app(app)

@app.route('/', methods=['GET', 'POST'])
def index():
    form = LoginForm()
    if form.validate_on_submit():
        print(form.data['user_name'])
        return redirect(url_for('print_success'))

    return render_template('index.html', form=form)

@app.route('/success')
def print_success():
    return"è¡¨å•éªŒè¯é€šè¿‡"


class LoginForm(FlaskForm):
    user_name = StringField()
    password = PasswordField()
    remember_me = BooleanField(label='è®°ä½æˆ‘')
    submit = SubmitField('Submit')

if __name__ == "__main__":
    app.run(debug=True)
```

htmlä»£ç ï¼š

```python
{% import"bootstrap/wtf.html"as wtf %}
<div class="container">
    <h3>ç³»ç»Ÿç™»å…¥</h3>
    <div class="col-md-4">
        {{ wtf.quick_form(form) }}
    </div>
</div>
```

å¯åŠ¨åï¼Œæ§åˆ¶å°æ˜¾ç¤ºå¦‚ä¸‹ï¼š

![img](https://mmbiz.qpic.cn/sz_mmbiz_png/tdJziaFLKKeSInrqeugLib297tOVNLAyn3a02iake1UdG4liaCOLI5rTibcEGB7jhaMop0sickBQo146VNRibibiauFp6cA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

ç„¶åç½‘é¡µä¸­è¾“å…¥127.0.0.1:5000,ç½‘é¡µæ˜¾ç¤ºï¼š

![image-20200211151446812](./img/image-20200211151446812.png)

**6 ä¸¤ä¸ªé”™è¯¯**

ä¾‹å­å›ä¹Ÿæ˜¯Flaskæ–°æ‰‹ï¼Œåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ä¸‹é¢ä¸¤ä¸ªé”™è¯¯ã€‚

**1) CSRFéœ€è¦é…ç½®å¯†ç **

![image-20200211151505598](./img/image-20200211151505598.png)

é‡åˆ°è¿™ä¸ªé”™è¯¯ï¼Œè§£å†³çš„æ–¹æ³•å°±æ˜¯é…ç½®ä¸€ä¸ªå¯†ç ã€‚å…·ä½“å¯¹åº”åˆ°ç¬¬5èŠ‚å®Œæ•´ä»£ç éƒ¨åˆ†ä¸­çš„æ­¤è¡Œï¼š

```
app.config['SECRET_KEY']  = "hard_to_guess_secret_key$$#@"
```

**2) index.htmlæœªæ‰¾åˆ°å¼‚å¸¸**

![image-20200211151533241](./img/image-20200211151533241.png)



å‡ºç°è¿™ä¸ªé”™è¯¯çš„åŸå› ä¸æ˜¯å› ä¸ºindex.htmlçš„ç‰©ç†è·¯å¾„æœ‰é—®é¢˜ï¼Œè€Œæ˜¯æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶å‘½åä¸ºï¼š`templates`ï¼Œç„¶åæŠŠindex.htmlç§»åŠ¨åˆ°æ­¤æ–‡ä»¶å¤¹ä¸‹ã€‚

#### 5 Flaskä¹‹Pyechartsç»˜å›¾

Flaskç³»åˆ—å·²æ¨é€4ç¯‡ï¼Œä»Šå¤©ç»“åˆFlaskå’ŒPyechartsï¼Œåšå‡ºä¸€äº›å¥½ç©çš„ä¸œè¥¿ã€‚

é¦–å…ˆï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£å¯¼å…¥æ‰€éœ€åŒ…ï¼š

```python
from flask import Flask
from jinja2 import Markup, Environment, FileSystemLoader
from pyecharts.globals import CurrentConfig
```

é…ç½®ç¯å¢ƒï¼Œä¸‹é¢è¿™è¡Œä»£ç ï¼Œå‘Šè¯‰`jinja2`æˆ‘çš„htmlæ¨¡æ¿ä½äºå“ªä¸ªæ–‡ä»¶ç›®å½•ï¼š

```
# å…³äº CurrentConfigï¼Œå¯å‚è€ƒ [åŸºæœ¬ä½¿ç”¨-å…¨å±€å˜é‡]
CurrentConfig.GLOBAL_ENV = Environment(loader=FileSystemLoader("./templates"))
```

å¦‚æœæ­¤å¤„é…ç½®çš„æœ‰é—®é¢˜ï¼Œä¼šå¼¹å‡ºä¸‹é¢çš„å¼‚å¸¸ï¼š

```
jinja2.exceptions.TemplateNotFound: index.html
```

ä¸‹é¢ä¸¤è¡Œä»£ç æ˜¯Flaskçš„å¸¸è§„æ“ä½œï¼š

```python
app = Flask(__name__, static_folder="templates")
app.config['SECRET_KEY']  = "hard_to_guess_secret_key$$#@"
```

ä¸‹é¢è¯¥pyechartsç™»å°ï¼Œè¿˜æ˜¯ä¸€é¡¿å¯¼åŒ…ï¼š
```python
from pyecharts.charts import Bar
from pyecharts.faker import Faker
import pyecharts.options as opts
from pyecharts.commons.utils import JsCode
from pyecharts.globals import ThemeType
```

åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„æŸ±çŠ¶å›¾ï¼š
```python
def bar():
    c = (
        Bar(init_opts=opts.InitOpts(
            animation_opts=opts.AnimationOpts(
                animation_delay=500, animation_easing="cubicOut"
            ),
            theme=ThemeType.MACARONS))
        .add_xaxis(["è‰è“", "èŠ’æœ", "è‘¡è„", "é›ªæ¢¨", "è¥¿ç“œ", "æŸ æª¬", "è½¦å˜å­"])
        .add_yaxis("é”€å”®é‡", Faker.values(), category_gap="50%", is_selected=True)
        .set_global_opts(title_opts=opts.TitleOpts(title="Bar-åŸºæœ¬å‚æ•°ä½¿ç”¨"), toolbox_opts=opts.ToolboxOpts(), datazoom_opts=opts.DataZoomOpts(),)

    )

    return c
```

ä¸‹é¢æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ã€‚pyechartsæŸ±çŠ¶å›¾å’Œflaskçš„ç½‘é¡µç»„è£…é˜¶æ®µã€‚

```python
@app.route("/")
def index():
    c = bar()
    return c.render_embed(template_name='index.html')
```
ç»„è£…çš„ä»£ç ç›¸å½“ç®€å•ï¼Œæ™®é€šçš„pyechartsæ¸²æŸ“ä½¿ç”¨`c.render(filename.html)`, è€ŒåµŒå…¥åˆ°æŒ‡å®šç½‘é¡µ`index.html`ä¸­ï¼Œä½¿ç”¨API:`render_embed`.

å…·ä½“index.htmlä¸Šå¦‚ä½•å¸ƒå±€æ˜¾ç¤ºï¼Œå°±è¦å†™ç‚¹htmlä»£ç ï¼š
```html
{% import 'macro' as macro %}

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ chart.page_title }}</title>
    {{ macro.render_chart_dependencies(chart) }}
</head>
<body>
    {{ macro.render_chart_content(chart) }}
</body>
</html>
```
ä¸ºäº†è®©htmlä»£ç å°½å¯èƒ½çš„å¤ç”¨ï¼ŒPyechartså¼€å‘å›¢é˜Ÿå¤ªæœ‰å¿ƒï¼Œä¸“é—¨æŠ½è±¡å‡ºä¸€ä¸ªå®æ–‡ä»¶`macro`. è¿™éƒ¨åˆ†ä»£ç å¤§å®¶å°±ä¸ç”¨ä¿®æ”¹äº†ï¼Œç›´æ¥copyå³å¯ã€‚

ä¸ºäº†ä¿è¯æœ¬ç¯‡ä»£ç å¯å¤ç°ï¼Œpasterè¿™ä¸ªæ–‡ä»¶åˆ°è¿™é‡Œï¼š
```html
{%- macro render_chart_content(c) -%}
    <div id="{{ c.chart_id }}" class="chart-container" style="width:{{ c.width }}; height:{{ c.height }};"></div>
    <script>
        var chart_{{ c.chart_id }} = echarts.init(
            document.getElementById('{{ c.chart_id }}'), '{{ c.theme }}', {renderer: '{{ c.renderer }}'});
        {% for js in c.js_functions.items %}
            {{ js }}
        {% endfor %}
        var option_{{ c.chart_id }} = {{ c.json_contents }};
        chart_{{ c.chart_id }}.setOption(option_{{ c.chart_id }});
        {% if c._is_geo_chart %}
            var bmap = chart_{{ c.chart_id }}.getModel().getComponent('bmap').getBMap();
            {% if c.bmap_js_functions %}
                {% for fn in c.bmap_js_functions.items %}
                    {{ fn }}
                {% endfor %}
            {% endif %}
        {% endif %}
    </script>
{%- endmacro %}

{%- macro render_notebook_charts(charts, libraries) -%}
    <script>
        require([{{ libraries | join(', ') }}], function(echarts) {
        {% for c in charts %}
            {% if c._component_type not in ("table", "image") %}
                var chart_{{ c.chart_id }} = echarts.init(
                    document.getElementById('{{ c.chart_id }}'), '{{ c.theme }}', {renderer: '{{ c.renderer }}'});
                {% for js in c.js_functions.items %}
                    {{ js }}
                {% endfor %}
                var option_{{ c.chart_id }} = {{ c.json_contents }};
                chart_{{ c.chart_id }}.setOption(option_{{ c.chart_id }});
                {% if c._is_geo_chart %}
                    var bmap = chart_{{ c.chart_id }}.getModel().getComponent('bmap').getBMap();
                    bmap.addControl(new BMap.MapTypeControl());
                {% endif %}
            {% endif %}
        {% endfor %}
        });
    </script>
{%- endmacro %}

{%- macro render_chart_dependencies(c) -%}
    {% for dep in c.dependencies %}
        <script type="text/javascript" src="{{ dep }}"></script>
    {% endfor %}
{%- endmacro %}

{%- macro render_chart_css(c) -%}
    {% for dep in c.css_libs %}
        <link rel="stylesheet"  href="{{ dep }}">
    {% endfor %}
{%- endmacro %}

{%- macro display_tablinks(chart) -%}
    <div class="tab">
        {% for c in chart %}
            <button class="tablinks" onclick="showChart(event, '{{ c.chart_id }}')">{{ c.tab_name }}</button>
        {% endfor %}
    </div>
{%- endmacro %}

{%- macro switch_tabs() -%}
    <script>
        (function() {
            containers = document.getElementsByClassName("chart-container");
            if(containers.length > 0) {
                containers[0].style.display = "block";
            }
        })()

        function showChart(evt, chartID) {
            let containers = document.getElementsByClassName("chart-container");
            for (let i = 0; i < containers.length; i++) {
                containers[i].style.display = "none";
            }

            let tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = "tablinks";
            }

            document.getElementById(chartID).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>
{%- endmacro %}

{%- macro generate_tab_css() %}
    <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            transition: 0.3s;
        }

        .tab button:hover {
            background-color: #ddd;
        }

        .tab button.active {
            background-color: #ccc;
        }

        .chart-container {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }
    </style>
{%- endmacro %}

{%- macro gen_components_content(chart) %}
    {% if chart._component_type == "table" %}
        <style>
            .fl-table {
                margin: 20px;
                border-radius: 5px;
                font-size: 12px;
                border: none;
                border-collapse: collapse;
                max-width: 100%;
                white-space: nowrap;
                word-break: keep-all;
            }

            .fl-table th {
                text-align: left;
                font-size: 20px;
            }

            .fl-table tr {
                display: table-row;
                vertical-align: inherit;
                border-color: inherit;
            }

            .fl-table tr:hover td {
                background: #00d1b2;
                color: #F8F8F8;
            }

            .fl-table td, .fl-table th {
                border-style: none;
                border-top: 1px solid #dbdbdb;
                border-left: 1px solid #dbdbdb;
                border-bottom: 3px solid #dbdbdb;
                border-right: 1px solid #dbdbdb;
                padding: .5em .55em;
                font-size: 15px;
            }

            .fl-table td {
                border-style: none;
                font-size: 15px;
                vertical-align: center;
                border-bottom: 1px solid #dbdbdb;
                border-left: 1px solid #dbdbdb;
                border-right: 1px solid #dbdbdb;
                height: 30px;
            }

            .fl-table tr:nth-child(even) {
                background: #F8F8F8;
            }
        </style>
        <div id="{{ chart.chart_id }}" class="chart-container" style="">
            <p class="title" {{ chart.title_opts.title_style }}> {{ chart.title_opts.title }}</p>
            <p class="subtitle" {{ chart.title_opts.subtitle_style }}> {{ chart.title_opts.subtitle }}</p>
            {{ chart.html_content }}
        </div>
    {% elif chart._component_type == "image" %}
        <div id="{{ chart.chart_id }}" class="chart-container" style="">
            <p class="title" {{ chart.title_opts.title_style }}> {{ chart.title_opts.title }}</p>
            <p class="subtitle" {{ chart.title_opts.subtitle_style }}> {{ chart.title_opts.subtitle }}</p>
            <img {{ chart.html_content }}/>
        </div>
    {% endif %}
{%- endmacro %}

```

è®°å¾—æœ€åæŠŠè¿™ä¸ªæ–‡ä»¶åç§°ä¸º`macro`å’Œ`index.html`æ–‡ä»¶éƒ½ç»Ÿä¸€æ”¾åˆ°`templates`æ–‡ä»¶å¤¹ä¸‹ã€‚

è¿™æ ·å°±å¯ä»¥è°ƒè¯•äº†ï¼š
```python
if __name__ == "__main__":
    app.run(debug=True)
```



![image-20200213230341390](./img/image-20200213230341390.png)

**é™„åŠ **

å†å†™ä¸€ä¸ªå±•ç¤ºé¡µé¢ï¼Œè·¯ç”±ä¸º`/bar2`:
```python
@app.route("/bar2")
def bar2():
    c = bar_border_radius()
    return c.render_embed(template_name='index.html')
```

å‡½æ•°bar_border_radiuså®šä¹‰å¦‚ä¸‹ï¼š
```python
def bar_border_radius():
    c = (
        Bar(init_opts=opts.InitOpts(
            animation_opts=opts.AnimationOpts(
                animation_delay=500, animation_easing="cubicOut"
            ),
            theme=ThemeType.MACARONS))
        .add_xaxis(["è‰è“", "èŠ’æœ", "è‘¡è„", "é›ªæ¢¨", "è¥¿ç“œ", "æŸ æª¬", "è½¦å˜å­"])
        .add_yaxis("é”€å”®é‡", Faker.values(), category_gap="50%", is_selected=True)
        .set_series_opts(itemstyle_opts={
            "normal": {
                "color": JsCode("""new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                    offset: 0,
                    color: 'rgba(0, 244, 255, 1)'
                }, {
                    offset: 1,
                    color: 'rgba(0, 77, 167, 1)'
                }], false)"""),
                "barBorderRadius": [6, 6, 6, 6],
                "shadowColor": 'rgb(0, 160, 221)',
            }}, markpoint_opts=opts.MarkPointOpts(
                data=[
                    opts.MarkPointItem(type_="max", name="æœ€å¤§å€¼"),
                    opts.MarkPointItem(type_="min", name="æœ€å°å€¼"),
                ]
        ), markline_opts=opts.MarkLineOpts(
                data=[
                    opts.MarkLineItem(type_="min", name="æœ€å°å€¼"),
                    opts.MarkLineItem(type_="max", name="æœ€å¤§å€¼")
                ]
        ))
        .set_global_opts(title_opts=opts.TitleOpts(title="Bar-å‚æ•°ä½¿ç”¨ä¾‹å­"), toolbox_opts=opts.ToolboxOpts(), yaxis_opts=opts.AxisOpts(position="right", name="Yè½´"), datazoom_opts=opts.DataZoomOpts(),)

    )

    return c
```

è¿™æ ·åˆå‡ºç°ä¸€ä¸ªé¡µé¢ï¼Œæ¼”ç¤ºå¦‚ä¸‹ï¼š

![image-20200213230359468](./img/image-20200213230359468.png)
